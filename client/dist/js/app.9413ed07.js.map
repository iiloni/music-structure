{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/visualizations/TimbreGraph.vue?8ad8","webpack:///./src/App.vue?0f16","webpack:///./src/components/visualizations/ClickableBackground.vue?ecd0","webpack:///./src/components/visualizations/Chords.vue?2fe9","webpack:///./src/components/visualizations/Events.vue?aed0","webpack:///./src/views/Callback.vue?e81a","webpack:///./src/components/visualizations/Section.vue?1612","webpack:///./src/app/workers/workers.js","webpack:///./src/components/visualizations/Matrixes.vue?bf3e","webpack:///./src/components/visualizations/ScapePlot.vue?2678","webpack:///./src/assets/timbres/7.png","webpack:///./src/assets/timbres/2.png","webpack:///./src/components/visualizations/Beats.vue?b352","webpack:///./src/dev/log.js","webpack:///./src/assets/timbres/3.png","webpack:///./src/App.vue?2755","webpack:///src/App.vue","webpack:///./src/App.vue?3359","webpack:///./src/App.vue?2667","webpack:///./src/views/Track.vue?e7d6","webpack:///./src/components/TrackSelector.vue?20f0","webpack:///./src/components/Album.vue?baa6","webpack:///src/components/Album.vue","webpack:///./src/components/Album.vue?ef28","webpack:///./src/components/Album.vue?aeb0","webpack:///./src/app/authentication.js","webpack:///./src/app/similarity.js","webpack:///./src/store/index.js","webpack:///./src/app/audioUtil.js","webpack:///./src/app/SpotifySegment.js","webpack:///./src/app/chordDetection.js","webpack:///./src/app/filter.js","webpack:///./src/app/noveltyDetection.js","webpack:///./src/app/familyFitness.js","webpack:///./src/app/pathExtraction.js","webpack:///./src/app/mds.js","webpack:///./src/app/SSM.js","webpack:///./src/app/Section.js","webpack:///./src/app/structure.js","webpack:///./src/app/Features.js","webpack:///./src/app/vis.js","webpack:///./src/app/Track.js","webpack:///./src/app/testing.js","webpack:///./src/app/synthesizer.js","webpack:///./src/app/app.js","webpack:///src/components/TrackSelector.vue","webpack:///./src/components/TrackSelector.vue?635c","webpack:///./src/components/TrackSelector.vue","webpack:///./src/components/Visualization.vue?5c69","webpack:///./src/components/visualizations/Matrixes.vue?b852","webpack:///./src/app/webgl/WebGL.js","webpack:///./src/app/webgl/WebGLMatrixPool.js","webpack:///./src/components/visualizations/Seeker.vue?4348","webpack:///./src/app/player.js","webpack:///./src/components/visualizations/Markers.vue?f8db","webpack:///src/components/visualizations/Markers.vue","webpack:///./src/components/visualizations/Markers.vue?2e04","webpack:///./src/components/visualizations/Markers.vue?d7a7","webpack:///src/components/visualizations/Seeker.vue","webpack:///./src/components/visualizations/Seeker.vue?9884","webpack:///./src/components/visualizations/Seeker.vue?9c43","webpack:///src/components/visualizations/Matrixes.vue","webpack:///./src/components/visualizations/Matrixes.vue?4c87","webpack:///./src/components/visualizations/Matrixes.vue?2903","webpack:///./src/components/visualizations/GroundTruth.vue?b6d5","webpack:///./src/app/visualization/ZoomCanvas.js","webpack:///src/components/visualizations/GroundTruth.vue","webpack:///./src/components/visualizations/GroundTruth.vue?7453","webpack:///./src/components/visualizations/GroundTruth.vue?994e","webpack:///./src/components/visualizations/Graphs.vue?3d8c","webpack:///./src/components/visualizations/Graph.vue?6d9a","webpack:///src/components/visualizations/Graph.vue","webpack:///./src/components/visualizations/Graph.vue?98b5","webpack:///./src/components/visualizations/Graph.vue?4b18","webpack:///src/components/visualizations/Graphs.vue","webpack:///./src/components/visualizations/Graphs.vue?d6ed","webpack:///./src/components/visualizations/Graphs.vue?7f85","webpack:///./src/components/visualizations/ScapePlot.vue?c549","webpack:///src/components/visualizations/ScapePlot.vue","webpack:///./src/components/visualizations/ScapePlot.vue?a2e1","webpack:///./src/components/visualizations/ScapePlot.vue?8fe8","webpack:///./src/components/visualizations/Beats.vue?1586","webpack:///src/components/visualizations/Beats.vue","webpack:///./src/components/visualizations/Beats.vue?2dd7","webpack:///./src/components/visualizations/Beats.vue?f89c","webpack:///./src/components/visualizations/PitchTimbre.vue?4faa","webpack:///./src/app/webgl/WebGLPitchTimbre.js","webpack:///src/components/visualizations/PitchTimbre.vue","webpack:///./src/components/visualizations/PitchTimbre.vue?0b12","webpack:///./src/components/visualizations/PitchTimbre.vue?9ff1","webpack:///./src/components/visualizations/Structure.vue?af8c","webpack:///./src/components/visualizations/MDS.vue?cecb","webpack:///src/components/visualizations/MDS.vue","webpack:///./src/components/visualizations/MDS.vue?8285","webpack:///./src/components/visualizations/MDS.vue","webpack:///src/components/visualizations/Structure.vue","webpack:///./src/components/visualizations/Structure.vue?5f84","webpack:///./src/components/visualizations/Structure.vue?4412","webpack:///./src/components/visualizations/HolisticStructure.vue?abd9","webpack:///./src/components/visualizations/Section.vue?b627","webpack:///src/components/visualizations/Section.vue","webpack:///./src/components/visualizations/Section.vue?f63d","webpack:///./src/components/visualizations/Section.vue?70d2","webpack:///./src/components/visualizations/SeparatorBackground.vue?d4bd","webpack:///src/components/visualizations/SeparatorBackground.vue","webpack:///./src/components/visualizations/SeparatorBackground.vue?b322","webpack:///./src/components/visualizations/SeparatorBackground.vue","webpack:///./src/components/visualizations/Tooltip.vue?1925","webpack:///src/components/visualizations/Tooltip.vue","webpack:///./src/components/visualizations/Tooltip.vue?7fee","webpack:///./src/components/visualizations/Tooltip.vue?c9dc","webpack:///src/components/visualizations/HolisticStructure.vue","webpack:///./src/components/visualizations/HolisticStructure.vue?2898","webpack:///./src/components/visualizations/HolisticStructure.vue?6777","webpack:///./src/components/visualizations/TimbreStructure.vue?0354","webpack:///./src/components/visualizations/StructureBackground.vue?355e","webpack:///src/components/visualizations/StructureBackground.vue","webpack:///./src/components/visualizations/StructureBackground.vue?4ebf","webpack:///./src/components/visualizations/StructureBackground.vue","webpack:///src/components/visualizations/TimbreStructure.vue","webpack:///./src/components/visualizations/TimbreStructure.vue?6e43","webpack:///./src/components/visualizations/TimbreStructure.vue?0327","webpack:///./src/components/visualizations/TimbreSegmentedGraph.vue?2acd","webpack:///./src/components/visualizations/GraphSection.vue?e5fd","webpack:///src/components/visualizations/GraphSection.vue","webpack:///./src/components/visualizations/GraphSection.vue?67c7","webpack:///./src/components/visualizations/GraphSection.vue?7fbd","webpack:///./src/components/visualizations/Events.vue?6395","webpack:///src/components/visualizations/Events.vue","webpack:///./src/components/visualizations/Events.vue?9cca","webpack:///./src/components/visualizations/Events.vue?ac42","webpack:///./src/components/visualizations/ClickableBackground.vue?5f2b","webpack:///src/components/visualizations/ClickableBackground.vue","webpack:///./src/components/visualizations/ClickableBackground.vue?4193","webpack:///./src/components/visualizations/ClickableBackground.vue?0092","webpack:///src/components/visualizations/TimbreSegmentedGraph.vue","webpack:///./src/components/visualizations/TimbreSegmentedGraph.vue?82e6","webpack:///./src/components/visualizations/TimbreSegmentedGraph.vue?aafa","webpack:///./src/components/visualizations/Tonality.vue?a5d9","webpack:///src/components/visualizations/Tonality.vue","webpack:///./src/components/visualizations/Tonality.vue?8f1e","webpack:///./src/components/visualizations/Tonality.vue?16ef","webpack:///./src/components/visualizations/Chords.vue?0b57","webpack:///src/components/visualizations/Chords.vue","webpack:///./src/components/visualizations/Chords.vue?9131","webpack:///./src/components/visualizations/Chords.vue?8953","webpack:///./src/components/visualizations/Tempo.vue?98a6","webpack:///src/components/visualizations/Tempo.vue","webpack:///./src/components/visualizations/Tempo.vue?01a2","webpack:///./src/components/visualizations/Tempo.vue?9932","webpack:///./src/components/visualizations/TimbreGraph.vue?e5c1","webpack:///src/components/visualizations/TimbreGraph.vue","webpack:///./src/components/visualizations/TimbreGraph.vue?d392","webpack:///./src/components/visualizations/TimbreGraph.vue?f63e","webpack:///src/components/Visualization.vue","webpack:///./src/components/Visualization.vue?6d7e","webpack:///./src/components/Visualization.vue?0ab9","webpack:///./src/components/Player.vue?7166","webpack:///src/components/Player.vue","webpack:///./src/components/Player.vue?5c64","webpack:///./src/components/Player.vue?d892","webpack:///src/views/Track.vue","webpack:///./src/views/Track.vue?5660","webpack:///./src/views/Track.vue?9607","webpack:///./src/views/Callback.vue?d72e","webpack:///src/views/Callback.vue","webpack:///./src/views/Callback.vue?2a5f","webpack:///./src/views/Callback.vue?7303","webpack:///./src/views/Login.vue?026b","webpack:///src/views/Login.vue","webpack:///./src/views/Login.vue?3a4e","webpack:///./src/views/Login.vue?0b6d","webpack:///./src/views/Landing.vue?c3cd","webpack:///src/views/Landing.vue","webpack:///./src/views/Landing.vue?f974","webpack:///./src/views/Landing.vue?860b","webpack:///./src/router/index.js","webpack:///./src/plugins/vuetify.js","webpack:///./src/main.js","webpack:///./src/app/dataStructures/Matrix.js","webpack:///./src/assets/timbres/11.png","webpack:///./src/assets/timbres sync ^\\.\\/.*\\.png$","webpack:///./src/assets/timbres/10.png","webpack:///./src/assets/timbres/8.png","webpack:///./src/app/workers/chordWorker.js","webpack:///./src/components/visualizations/PitchTimbre.vue?3e2d","webpack:///./src/assets/timbres/1.png","webpack:///./src/components/visualizations/HolisticStructure.vue?2245","webpack:///./src/assets/timbres/0.png","webpack:///./src/app/workers/harmonicStructureWorker.js","webpack:///./src/components/Album.vue?fd95","webpack:///./src/components/Visualization.vue?6ce7","webpack:///./src/components/visualizations/GraphSection.vue?2aa0","webpack:///./src/assets/timbres/6.png","webpack:///./src/components/visualizations/Markers.vue?aed0","webpack:///./src/components/visualizations/TimbreStructure.vue?f0ef","webpack:///./src/app/dataStructures/HalfMatrix.js","webpack:///./src/components/visualizations/Tempo.vue?7263","webpack:///./src/components/visualizations/Tooltip.vue?2622","webpack:///./src/app/workers/tsneWorker.js","webpack:///./src/app/dataStructures/NumberType.js","webpack:///./src/views/Track.vue?ea32","webpack:///./src/assets/timbres/5.png","webpack:///./src/app/workers/timbreGraphWorker.js","webpack:///./src/app/workers/harmonicStructureWorker.js?1d1a","webpack:///./src/views/Landing.vue?048c","webpack:///./src/components/visualizations/TimbreSegmentedGraph.vue?99c0","webpack:///./src/app/workers/ssmWorker.js","webpack:///./src/components/visualizations/Graphs.vue?2834","webpack:///./src/views/Login.vue?b712","webpack:///./src/components/visualizations/Graph.vue?ed18","webpack:///./src/app/workers/clusterWorker.js","webpack:///./src/assets/timbres/9.png","webpack:///./src/components/visualizations/Seeker.vue?b221","webpack:///./src/app/workers/timbreStructureWorker.js","webpack:///./src/app/workers/timbreStructureWorker.js?4017","webpack:///./src/app/workers/timbreGraphWorker.js?067c","webpack:///./src/app/workers/chordWorker.js?ac5f","webpack:///./src/components/Player.vue?710a","webpack:///./src/assets/timbres/4.png","webpack:///./src/components/visualizations/Structure.vue?0c58","webpack:///./src/components/visualizations/Tonality.vue?49c2","webpack:///./src/components/visualizations/GroundTruth.vue?be19"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","this","oldJsonpFunction","slice","init","a","timbreGraphWorker","Worker","timbreStructureWorker","harmonicStructureWorker","chordWorker","isCalculating","timbreGraphWorkerBusy","updateTimbreGraphVis","timbreFeatures","timbreSliders","sampleDuration","Promise","resolve","terminate","postMessage","timestamp","Date","onmessage","event","sendBackTime","log","timbreStructureWorkerBusy","computeTimbreStructure","harmonicStructureWorkerBusy","computeHarmonicStructure","options","state","window","eventBus","$emit","ssm","tsneWorker","chordWorkerBusy","computeChords","pitchFeatures","fastSampledPitch","fastSampledPitchDuration","startSSM","trackId","avgLoudness","segmentStartDuration","beatsStartDuration","enhanceBlurLength","threshold","thresholdPercentage","allPitches","tempoRatios","SPminSize","SPstepSize","createScapePlot","synthesized","synthesizedSSMPitch","synthesizedSSMTimbre","sampleAmount","id","messageType","message","scapePlot","HalfMatrix","scapePlotAnchorColor","Float32Array","matrixes","forEach","matrix","buffer","type","Matrix","graphs","graph","clusterWorker","tsneWorkerBusy","tsne","features","clusterWorkerBusy","cluster","debug","info","warn","error","argPlaceholder","navigator","userAgent","indexOf","levels","DEBUG","color","bg","INFO","WARN","ERROR","FATAL","currentLevel","levelStack","updateLogs","console","_vm","_h","$createElement","_c","_self","attrs","staticRenderFns","component","VApp","staticClass","_v","testing","synthesizing","_e","on","$event","preventDefault","search","$store","commit","model","callback","$$v","searchQuery","expression","getVolumeIcon","clickVolume","volume","share","trackList","ref","style","mainContentWidth","showPrototype","staticStyle","readMore","nativeOn","onScroll","selected","_l","track","index","scopedSlots","_u","fn","active","toggle","trackData","albumSize","clickedArtist","class","directives","rawName","clicked","imgSize","album","images","imgIndex","url","_s","artists","VBtn","VCard","VCardActions","VCardText","VImg","Ripple","token","refreshToken","api","axios","baseURL","withCredentials","tokenTimestamp","expiresIn","requestFirstToken","code","post","grant_type","then","res","access_token","sessionStorage","setItem","expires_in","refresh_token","setTimeout","requestRefreshToken","catch","err","getItem","router","isAuthorized","undefined","e","tokenExpired","timeLeftMilliseconds","setInterval","Math","floor","maxEuclidianPitchDistance","sqrt","maxEuclidianTimbreDistance","pow","cosine","b","adotv","amag","bmag","cosineTransposed","transposedI","euclidianDistance","squaredDistance","euclidianDistanceTransposed","squaredDistanceTransposed","euclidianTimbre","euclidianPitchTransposed","dist","diff","Vue","use","Vuex","Store","browser","user","selectedIndex","loadingTrack","playerReady","playing","seeker","seekerUpdateSpeed","isZoomed","zoomScale","playerActive","inputFocus","mutations","setSeeker","time_ms","setUser","setPlayerState","playerState","addToTrackList","addToTrackListIndex","addToTrackListFront","unshift","clearTrackList","setSelectedIndex","setPlaying","incrementSeeker","increment","setZoomed","zoomed","toggleZoomed","setPlayerActive","setInputFocus","focus","actions","getters","selectedTrack","isInputFocused","d3","require","circleOfFifths","keyNames","scaleLinear","domain","interpolate","interpolateHcl","range","rgb","PI","TWO_PI","tonality","pitches","x","y","energy","vangle","vradius","cos","sin","angle","atan2","radius","loudnessPerceived","db","tryRemovePercussion","equalizeBass","SpotifySegment","segment","start","duration","loudness_start","loudness_max","loudness_max_time","loudness_end","processPitch","processPitchEqualizeBass","processedPitch","processedPitchSmooth","Error","pitch","audioUtil","tonalityAngle","tonalityRadius","tonalityEnergy","minDuration","decay","shortness","noise","max","percussiony","min","reduce","sum","val","prevSegment","nextSegment","maxPitch","secondMaxPitch","equalizeAmount","scale","biggest","totalBiggest","processedTimbre","timbre","timbres","timbresScaled","duration_ms","concat","coord","tsneCoord","nextSegmentLoudness","loudnessFeatures","getLoudnessFeatures","end","maxTime","avgFirst","avgSecond","avg","chords","major","weight","template","minor","sus2","sus4","dim","aug","maj7","seven","min7","min6","min7b5","minmaj7","sus27","sus47","dim6","maj7sharp5","pureMajorMinor","majorminor","popchords","getConfidence","chord","bassNote","getBassNote","similarity","maxIndex","getHighestConfidenceChord","chordSet","maxChord","maxConfidence","confidence","getMajorMinorNess","majorness","minorness","getPopChord","generate1DgaussianKernel","size","sigma","kernel","meanIndex","exp","gaussianBlur2DOptimized","matrixSize","getSize","fullKernelSize","kernel1D","blurredMatrix","from","fill","kx","getValueMirrored","blurredMatrixSecondPass","ky","gaussianBlurFeatures","blurredFeatures","featureAmount","newVector","f","kernelSum","k","medianFilterFeatures","resolution","buckets","filteredFeatures","totalValues","valNormalized","middle","median","gaussianBlur1D","array","edgeStrategy","blurredArray","absoluteEuclideanColumnDerivative","ssmSize","width","novelty","differenceSum","currentValue","getValueNormalizedMirrored","nextValue","difference","featureDerivative","derivative","Array","findPeaks","peaks","sample","height","maxima","minima","maxi","leftMinima","rightMinima","smallestMinima","assert","maxPeakHeightDiff","computeFitness","pathFamily","pathScores","score","pathAmount","pathFamilyLength","normalizedScore","coverage","computeInducedCoverage","normalizedCoverage","fitness","prunedPathFamily","pathEndY","pathStartY","abs","createScoreMatrixBuffer","Number","NEGATIVE_INFINITY","knightMoveRatio","knightMoveTweak","computeAccumulatedScoreMatrix","D","getSampleAmount","penalty","penalize","getValueNormalized","down","right","diag","computeOptimalPathFamily","path","predecessors","Uint16Array","predecessorLength","getScoresForPathFamily","scoreMatrix","endX","endY","endValue","startX","startY","startValue","pathScore","visualizationMatrix","scoreMatrixBuffer","P","PScores","familyFitness","maxVal","minVal","POSITIVE_INFINITY","sizeD","numberType","NumberType","UINT8","getValue","setValue","x2","pseudoInverse","inverse","solve","linearDependencies","QrDecomposition","LuDecomposition","CholeskyDecomposition","EigenvalueDecomposition","getMDSFeature","distanceMatrix","feature","lr","maxSteps","minLossDifference","momentum","logEvery","classicalMDS","getNestedArray","map","getMDSCoordinates","strategy","coords","learnRates","best","bestLoss","rate","getMdsCoordinatesWithGradientDescentMatrix","lossPerStep","coordinates","isNaN","getMdsCoordinatesWithGaussNewton","normalize2DCoordinates","distances","numCoordinates","rows","getInitialMdsCoordinates","accumulation","step","loss","getMdsLoss","lossPrev","coordIndex","gradient","getGradientForCoordinate","add","mul","update","updatedCoordinates","sub","getRowVector","setRow","dimensions","columns","getResidualsWithJacobian","residuals","jacobian","mmul","dimension","updateIndex","paramValue","updateDelta","updatedValue","set","seed","randomUniform","rand","random","seedrandom","div","normalizer","coordIndex1","coordIndex2","coord1","coord2","target","predicted","norm","zeros","squaredDifferenceSum","residual","residualWrtPredicted","predictedWrtSquaredDifferenceSum","squaredDifferenceSumWrtCoord1","residualWrtCoord1","rowIndex","columIndex","jacobianEntry","entryUpdated","columnVector","otherCoordIndex","otherCoord","targets","lossWrtPredicted","squaredDifferenceSumWrtCoord","lossWrtCoord","M","numeric","mean","A","rowMeans","colMeans","transpose","totalMean","ret","svd","eigenValues","S","U","row","getAngleAndRadius","mdsCoordinate","centerX","centerY","maxRadius","calculateSSM","similarityFunction","fillFeaturesNormalized","sim","Section","args","startSample","endSample","groupID","mdsFeature","colorAngle","colorRadius","otherSection","_","covers","splits","disjoint","amountOfSectionsAfterSubtract","clipsEnd","clipsStart","left","clone","thisClone","subtract","createSegmentsFromNovelty","noveltyDetection","filter","peak","structureSegments","MDSColorGivenDistanceMatrix","segments","coloringStrategy","coloredSegments","MdsCoordinates","mds","MdsFeature","newSegment","sort","largestGap","largestGapAngle","gap","MDSColorTimbreSegmentsWithFeatures","amount","FLOAT32","segmentVectors","vector","processTimbreSegments","mdsColoredSegments","timbreNormalizationAmount","Features","analysisData","loudness","dynamics","tonalEnergy","tonalRadius","tonalAngle","ceil","samples","sampleBlur","fillBeatsStartDuration","beats","calculateMaxMin","timbreBiggest","timbreTotalBiggest","processSegments","processDirectLoudness","sampleFeatures","processSamples","downSampledTimbre","downSampleTimbre","downsampleAmount","fastSampleDuration","sampled","segmentationSmoothingLength","round","continuousSmoothingLength","ssmTimbre","SSM","blurredTimbreLarge","segmentationSmoothedFeatures","segmentationDerivative","smoothedSegmentationDerivative","structure","segmentedFeatures","featureSegment","smoothedFeatureSegment","frankenFeatures","smoothedTimbre","medianFeatures","timbreMax","getOriginalTimbres","timbreMin","beat","raw","processed","nextSegmentStartLoudness","getAverageLoudness","processTimbre","processPitchSmooth","clusterSelection","tsneSelection","directLoudnessAmount","directLoudnessSampleDuration","directLoudness","segmentIndex","time","isTimeInSegment","getExactLoudness","startTime","chordDetection","smoothedAvgLoudness","averageLoudness","maxLoudness","dynamicsBase","dynamic","sampledFeature","averageFeature","sampleStart","sampleEnd","getEnd","sampleStartDuration","lastSampleStart","initSampleFeatures","blurDuration","blurOutsideSampleDuration","segmentEnd","sampleRangeStartIndex","sampleRangeEndIndex","rangeSize","firstSample","sampleBlurEnd","firstSampleOverlap","addFeaturesScaled","sampleBlurStart","lastSampleOverlap","divideFeatures","downSampleAmount","downSampleRatio","startIndex","endIndex","startSampleWeight","endSampleWeight","summedTimbre","featureName","featureSize","sampleIndex","scalar","divisor","PHI","colorWheel","zeroOneColor","interpolator","zeroOneColorWarm","pitchColor","sinebowColorNormalized","divergingColor","goldenRatioCategoricalColor","offset","opacity","g","categoryColor","categoryColorWithOpacity","sinebowColorNormalizedRadius","colorHSL","circleOfFifthsColor","circleOfFifthsColorBrightness","brightness","renderWaveform","ctx","fillStyle","detailed","beginPath","moveTo","startVolume","maxVolume","lineTo","closePath","fillRect","drawAnchorPoints","canvasWidth","ancholor","anchorAmount","halfWidth","scaleFromTopLeft","anchorX","anchorY","anchorAngle","hex","drawScapePlot","clearRect","minSize","Track","stepSize","forEachCell","anchorColorLerp","rectX","rectY","cellX","cellY","aAngle","bAngle","aDist","Infinity","bDist","closenessToB","angleLerp","angleA","angleB","distClock","distAntiClock","maxTimbreDownSamples","useSampled","harmonicStructureCourse","harmonicStructure","tsneCoords","groundTruth","getName","separators","section","processing","workers","chordsVector","tonalityFeatureSmall","tonalityFeatureLarge","keyFeature","$on","harmonicStructureListener","eventListenerSet","$off","timbreStructure","events","segmentedTimbreGraph","updatingTimbreGraphVis","timbreFeatureGraph","getID","getSegmentStartDuration","diffBack","graphFeatures","structures","structureSections","optimalStructure","courseStructure","fineStructure","strictpath","getMatrixByName","pathExtraction","minK","maxK","tries","clusters","prevCluster","clusterSections","tsneListener","minDist","closestSegment","alreadyPlacedMarkerIndex","markers","findIndex","marker","vis","markersCreated","formatHex","label","String","fromCharCode","toUpperCase","hasVisualization","analysis","process","artist","uri","transpositionInvariantSSM","bars","tatums","setAnalysis","json","createWithAnalysis","namespaces","coarse","function","fine","getAllTestSets","keys","sets","getTracks","setKey","tracks","query","getQuery","file_metadata","title","replace","folder","prefix","Isophonics_1","Isophonics_01","Isophonics_2","Isophonics_02","Isophonics_03","Isophonics_04","Isophonics_05","Isophonics_06","Isophonics_07","Isophonics_08","Isophonics_09","Isophonics_10","Isophonics_11","Isophonics_12","Isophonics_13","Isophonics_14","Isophonics_15","Isophonics_16","Isophonics_17","Isophonics_18","Isophonics_CD1","Isophonics_CD2","templateSegment","templateElement","SynthesizedTrack","synthesizerString","sections","pitchSSM","synthesizeSSMPitch","timbreSSM","synthesizeSSMTimbre","blurTime","getBuffer","preset","split","sectionLength","ySection","yIndex","yOffset","xSection","xIndex","xOffset","setValueNormalizedMirrored","spotify","SpotifyWebApi","allTracks","Map","initialize","setAccessToken","auth","getMe","store","localTrackId","localStorage","firstTrack","getPlaylistTracks","items","getMyTopTracks","limit","topTracks","loadTracksFromSpotify","selectTrackAtIndex","newTrack","deselect","getAnalysis","hasAnalysis","reload","getAudioAnalysisForTrack","keepCurrentTrack","has","results","loadArtistTopTracks","artistID","getArtistTopTracks","loadTestSet","testSetKey","testSetTracks","spotifyTracks","spotifySearches","spotifyTrack","all","synthesize","props","components","Album","computed","selectedFromStore","watch","mounted","methods","selectedChanged","selectedFromStoreChanged","newIndex","VSlideGroup","VSlideItem","tsneReady","tsneSize","tsneCoordX","tsneCoordY","clusterColor","isPlayingSample","tsneDynamics","playingSample","clusterSection","samplePosNormalized","seekerNormalized","selectedTab","selectedStructure","secondsToXPosition","getCategoryColor","showPaths","pathIndex","generateLine","showPathStart","fillSections","webGLCanvas","canvas","useColor","join","gl","getContext","alert","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","vertexShader","createShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderSource","vertexShaderTextColor","fragmentShaderTextColor","vertexShaderTextGreyscale","fragmentShaderTextGreyscale","compileShader","getShaderParameter","COMPILE_STATUS","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","validateProgram","VALIDATE_STATUS","translateLoc","getUniformLocation","scaleLoc","getProgramInfoLog","getProgramInfoLof","getShaderInfoLog","viewport","bufferData","bufferSize","verts","rectangleVertexBufferObject","createBuffer","bindBuffer","ARRAY_BUFFER","STATIC_DRAW","colorBufferObject","colors","vertAttribLocation","getAttribLocation","vertexAttribPointer","FLOAT","FALSE","BYTES_PER_ELEMENT","enableVertexAttribArray","colorAttribLocation","translateX","translateY","scaleX","scaleY","useProgram","uniform2f","drawArrays","TRIANGLES","WebGLMatrixPool","matrixBufferPool","createDataArray","setBufferData","xCenterPositionNormalized","halfDuration","getAnalysisDuration","st","pos","ssmVertices","isMatrix","v","top","bottom","WebGL","clickedSVG","rightClick","isVertical","useZoom","showMarkerLabel","seekerColor","drawMarkers","markerOpacity","autoConnect","deviceId","player","playedTrackBefore","trackURI","loadTrack","pause","seekMS","getURI","play","uris","position_ms","locallyResumed","resume","locallyPaused","seek","seekS","time_seconds","lastSeekerIntervalPoll","setVolume","stateChangedCallback","newState","current_track","position","performance","now","getMyCurrentPlaybackState","is_playing","startSeekerInterval","elapsed","waitForSpotifyWebPlaybackSDKToLoad","Spotify","Player","getOAuthToken","cb","addListener","track_window","device_id","deviceIdArray","transferMyPlayback","connect","transferPlayback","releasePlayback","getMyDevices","devices","device","is_active","onSpotifyWebPlaybackSDKReady","newSeeker","oldSeeker","newPlaying","oldPlaying","normalizeTime","markerLabelHeight","_k","keyCode","button","clickedMarker","doubleClickMarker","isShowingEdit","blur","$set","VColorPicker","VTextField","VRow","VSelect","VSpacer","VSwitch","VTab","VTabs","ZoomCanvas","trackDuration","applyRenderMode","drawFunction","clearInterval","drawLoop","clearAndDraw","getSeekerNormalized","startNormalized","getOffsetXNormalized","borderSize","borderColor","text","font","fillText","hasFeatures","expanded","parseFloat","toFixed","VExpandTransition","VIcon","featureHeight","WebGLPitchTimbre","featureSelection","pitchTimbreBufferPool","inverseBufferPoolLength","bufferPoolLength","featureObject","createSegmentFeatureDataArray","marginPercentage","startDuration","segmentAmount","vectorSize","inverseVectorSize","centeredRange","featureVertices","separateByGroup","clickStructureUnfold","verticalPosition","showLoudness","clickStructureshowLoudness","clickStructureChangeVertical","vertLayout","layouts","clickStructureChangeColor","colorLayout","refInFor","heightOfStructure","unhover","clickBackground","sectionVerticalPosition","blockHeight","sectionColor","hoverSection","unhoverSection","clickSection","generatePointsForShapedSection","showTooltip","domProps","toolTipText","VTooltip","catColoring","showHelp","sectionHeight","paddingTop","spaceBetweenCourseFine","groupAmount","hasStructure","showMDS","glowOpacity","seekerIsInSection","glowRectSize","shapedSectionPath","hover","click","separator","backgroundColor","separatorColor","_t","VCol","VSkeletonLoader","eventSize","eventHeight","clickEvent","gradientStep","currentColor","colorGradient","currentY","gradientColoring","seekerInEvent","collapsed","clickCanvas","co5Size","keyNumber","keyName","currentAngleSlow","tonalityPointerPath","tonalitySlow","currentAngle","chordGapOffset","clickedChord","isMajor","colorBrightness","chordNameHeight","offsetHeight","avgPos","showPath","showPathGradient","timbreFeatureGraphPath","sampleWidth","sliderValue","disabled","mousedown","timbreSlider","solod","solo","muted","mute","resetSliders","setPreset","presets","test","VSlider","playPause","clickedWaveform","VHover","VProgressCircular","VProgressLinear","VAppBar","VContainer","VToolbarTitle","VToolbar","spotifyAuthorize","VCardSubtitle","VCardTitle","VLayout","VueRouter","routes","Login","beforeEnter","to","next","params","Callback","base","Vuetify","theme","dark","themes","light","primary","secondary","accent","success","warning","config","productionTip","vuetify","render","h","App","$mount","isOpera","opr","addons","opera","isFirefox","InstallTrigger","isSafari","HTMLElement","toString","safari","pushNotification","isIE","document","documentMode","isEdge","StyleMedia","isChrome","chrome","webstore","runtime","getNumberTypeByName","fillByIndex","values","heigth","number","fromHalfMatrix","halfMatrix","timeLagMatrix","lag","halfMatrixLeft","halfMatrixRight","webpackContext","req","webpackContextResolve","cellsBefore","featureIndex","nestedArray","meanSquared","sd","deltaMean","deltaDeviation","getMeanAndStandardDeviation","fromMatrix","freeze","Uint8Array","UINT16","UINT32","Uint32Array","INT8","Int8Array","INT16","Int16Array","INT32","Int32Array","FLOAT64","Float64Array","objectOrString"],"mappings":"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","file":"js/app.9413ed07.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = this[\"webpackJsonp\"] = this[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreGraph.vue?vue&type=style&index=0&id=18dc8330&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreGraph.vue?vue&type=style&index=0&id=18dc8330&scoped=true&lang=css&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClickableBackground.vue?vue&type=style&index=0&id=0b957349&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClickableBackground.vue?vue&type=style&index=0&id=0b957349&scoped=true&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chords.vue?vue&type=style&index=0&id=cacf534a&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chords.vue?vue&type=style&index=0&id=cacf534a&scoped=true&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Events.vue?vue&type=style&index=0&id=e197b9bc&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Events.vue?vue&type=style&index=0&id=e197b9bc&scoped=true&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callback.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callback.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Section.vue?vue&type=style&index=0&id=6ffe24a8&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Section.vue?vue&type=style&index=0&id=6ffe24a8&scoped=true&lang=css&\"","import Matrix from \"../dataStructures/Matrix\";\nimport HalfMatrix from \"../dataStructures/HalfMatrix\";\nimport * as log from \"../../dev/log\";\n\nexport async function init() {\n    //ssm = new Worker(\"./ssmWorker.js\", { type: \"module\" });\n    timbreGraphWorker = new Worker(\"./timbreGraphWorker.js\", { type: \"module\" });\n    timbreStructureWorker = new Worker(\"./timbreStructureWorker.js\", { type: \"module\" });\n    harmonicStructureWorker = new Worker(\"./harmonicStructureWorker.js\", { type: \"module\" });\n    chordWorker = new Worker(\"./chordWorker.js\", { type: \"module\" });\n\n    //tsneWorker = new Worker(\"./tsneWorker.js\", { type: \"module\" });\n    // clusterWorker = new Worker(\"./clusterWorker.js\", { type: \"module\" });\n}\n\nlet isCalculating = false;\n\nlet timbreGraphWorker;\nlet timbreGraphWorkerBusy = false;\nexport async function updateTimbreGraphVis(timbreFeatures, timbreSliders, sampleDuration) {\n    return new Promise((resolve) => {\n        if (timbreGraphWorkerBusy) {\n            timbreGraphWorker.terminate();\n            timbreGraphWorker = new Worker(\"./timbreGraphWorker.js\", { type: \"module\" });\n        }\n        timbreGraphWorker.postMessage({\n            timbreFeatures,\n            timbreSliders,\n            sampleDuration,\n            timestamp: new Date(),\n        });\n        timbreGraphWorkerBusy = true;\n\n        timbreGraphWorker.onmessage = (event) => {\n            timbreGraphWorkerBusy = false;\n            const sendBackTime = new Date() - event.data.timestamp;\n            log.debug(\"Got back from timbreGraphworker\", sendBackTime);\n            resolve(event.data.result);\n        };\n    });\n}\n\nlet timbreStructureWorker;\nlet timbreStructureWorkerBusy = false;\nexport async function computeTimbreStructure(timbreFeatures, sampleDuration) {\n    return new Promise((resolve) => {\n        if (timbreStructureWorkerBusy) {\n            timbreStructureWorker.terminate();\n            timbreStructureWorker = new Worker(\"./timbreStructureWorker.js\", { type: \"module\" });\n        }\n        timbreStructureWorker.postMessage({\n            timbreFeatures,\n            sampleDuration,\n        });\n        timbreStructureWorkerBusy = true;\n\n        timbreStructureWorker.onmessage = (event) => {\n            timbreStructureWorkerBusy = false;\n            log.debug(\"Got back from timbreStructureWorker\", event.data);\n            resolve(event.data);\n        };\n    });\n}\n\nlet harmonicStructureWorker;\nlet harmonicStructureWorkerBusy = false;\nexport async function computeHarmonicStructure(options) {\n    return new Promise((resolve) => {\n        if (harmonicStructureWorkerBusy) {\n            harmonicStructureWorker.terminate();\n            harmonicStructureWorker = new Worker(\"./harmonicStructureWorker.js\", { type: \"module\" });\n        }\n        harmonicStructureWorker.postMessage(options);\n        harmonicStructureWorkerBusy = true;\n\n        harmonicStructureWorker.onmessage = (event) => {\n            if (event.data.state === \"done\") {\n                harmonicStructureWorkerBusy = false;\n\n                resolve(event.data);\n            }\n            if (event.data.state === \"processing\") {\n                window.eventBus.$emit(\"harmonicStructure\", event.data);\n            }\n            //resolve(event.data);\n        };\n    });\n}\n\nlet chordWorker;\nlet chordWorkerBusy = false;\nexport async function computeChords(pitchFeatures, fastSampledPitch, sampleDuration, fastSampledPitchDuration) {\n    return new Promise((resolve) => {\n        if (chordWorkerBusy) {\n            chordWorker.terminate();\n            chordWorker = new Worker(\"./chordWorker.js\", { type: \"module\" });\n        }\n        chordWorker.postMessage({\n            pitchFeatures,\n            fastSampledPitch,\n            sampleDuration,\n            fastSampledPitchDuration,\n        });\n        chordWorkerBusy = true;\n\n        chordWorker.onmessage = (event) => {\n            chordWorkerBusy = false;\n            log.debug(\"Got back from chordWorker\", event.data);\n            resolve(event.data);\n        };\n    });\n}\n\nlet ssm;\n/**\n *\n * @param {*} trackId\n * @param {*} pitchFeatures\n * @param {*} timbreFeatures\n * @param {*} segmentStartDuration\n * @param {*} options {blurTime 4, threshold: 0.5, allPitches: false }\n */\nexport async function startSSM(\n    trackId,\n    pitchFeatures,\n    timbreFeatures,\n    avgLoudness,\n    sampleDuration,\n    segmentStartDuration,\n    beatsStartDuration,\n    options = {}\n) {\n    return new Promise((resolve) => {\n        const enhanceBlurLength = options.enhanceBlurLength || 4;\n        const threshold = options.threshold || 0.5;\n        const thresholdPercentage = options.thresholdPercentage || 0.05;\n        const allPitches = options.allPitches || false;\n        const tempoRatios = options.tempoRatios || [1];\n        const SPminSize = options.SPminSize || 4;\n        const SPstepSize = options.SPstepSize || 1;\n        const createScapePlot = options.createScapePlot || false;\n        const synthesized = options.synthesized || false;\n        const synthesizedSSMPitch = options.synthesizedSSMPitch || null;\n        const synthesizedSSMTimbre = options.synthesizedSSMTimbre || null;\n        const sampleAmount = options.sampleAmount || segmentStartDuration.length;\n        if (isCalculating) {\n            ssm.terminate();\n            ssm = new Worker(\"./ssmWorker.js\", { type: \"module\" });\n        }\n\n        ssm.postMessage({\n            pitchFeatures,\n            timbreFeatures,\n            avgLoudness,\n            sampleDuration,\n            sampleAmount,\n            segmentStartDuration,\n            beatsStartDuration,\n            id: trackId,\n            timestamp: new Date(),\n            allPitches,\n            enhanceBlurLength,\n            tempoRatios,\n            threshold,\n            thresholdPercentage,\n            SPminSize,\n            SPstepSize,\n            createScapePlot,\n            synthesized,\n            synthesizedSSMPitch,\n            synthesizedSSMTimbre,\n        });\n        isCalculating = true;\n\n        ssm.onmessage = (event) => {\n            if (event.data.messageType === \"update\") {\n                window.eventBus.$emit(\"update\", event.data.message);\n            }\n            if (event.data.messageType === \"final\") {\n                isCalculating = false;\n                const result = event.data.message;\n                if (result.id === trackId) {\n                    if (createScapePlot) {\n                        result.scapePlot = new HalfMatrix(result.scapePlot);\n                        result.scapePlotAnchorColor = new Float32Array(result.scapePlotAnchorColor);\n                    }\n\n                    result.matrixes.forEach((matrix) => {\n                        if (matrix.buffer.type === \"Matrix\") {\n                            matrix.matrix = new Matrix(matrix.buffer);\n                        } else if (matrix.buffer.type === \"HalfMatrix\") {\n                            matrix.matrix = new HalfMatrix(matrix.buffer);\n                        }\n                        delete matrix.buffer;\n                    });\n\n                    result.graphs.forEach((graph) => {\n                        graph.data = new Float32Array(graph.buffer);\n                        delete graph.buffer;\n                    });\n\n                    resolve(result);\n                }\n            }\n        };\n    });\n}\n\nlet tsneWorker;\nlet tsneWorkerBusy = false;\nexport async function tsne(features) {\n    log.debug(features);\n    return new Promise((resolve) => {\n        if (tsneWorkerBusy) {\n            tsneWorker.terminate();\n            tsneWorker = new Worker(\"./tsneWorker.js\", { type: \"module\" });\n        }\n        tsneWorker.postMessage(features);\n        tsneWorkerBusy = true;\n\n        tsneWorker.onmessage = (event) => {\n            if (event.data.state === \"done\") {\n                tsneWorkerBusy = false;\n                window.eventBus.$emit(\"tsneReady\", event.data.result);\n                resolve(event.data.result);\n            }\n            if (event.data.state === \"processing\") {\n                window.eventBus.$emit(\"tsneReady\", event.data.result);\n            }\n        };\n    });\n}\n\nlet clusterWorker;\nlet clusterWorkerBusy = false;\nexport async function cluster(features) {\n    return new Promise((resolve) => {\n        if (clusterWorkerBusy) {\n            clusterWorker.terminate();\n            clusterWorker = new Worker(\"./clusterWorker.js\", { type: \"module\" });\n        }\n        clusterWorker.postMessage(features);\n        clusterWorkerBusy = true;\n\n        clusterWorker.onmessage = (event) => {\n            clusterWorkerBusy = false;\n            log.debug(\"Got back from clusterWorker\", event.data);\n            resolve(event.data);\n        };\n    });\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Matrixes.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Matrixes.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ScapePlot.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ScapePlot.vue?vue&type=style&index=0&lang=css&\"","module.exports = __webpack_public_path__ + \"img/7.8d926c63.png\";","module.exports = __webpack_public_path__ + \"img/2.195360cd.png\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Beats.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Beats.vue?vue&type=style&index=0&lang=css&\"","const argPlaceholder = navigator.userAgent.indexOf(\"Chrome\") != -1 ? \"%O\" : \"%O\";\nexport const levels = {\n    DEBUG: { name: \"Debug\", id: 0, color: \"#40A0EE\", bg: \"#204099\" },\n    INFO: { name: \"Info\", id: 1, color: \"#2DE974\", bg: \"#187639\" },\n    WARN: { name: \"Warn\", id: 2, color: \"darkorange\", bg: \"darkorange\" },\n    ERROR: { name: \"Error\", id: 3, color: \"red\", bg: \"brown\" },\n    FATAL: { name: \"Fatal\", id: 4, color: \"white\", bg: \"brown\" },\n};\n\nlet currentLevel = () => levelStack[levelStack.length - 1];\nlet levelStack = [levels.INFO];\n\nexport let debug;\nexport let info;\nexport let warn;\nexport let error;\nexport let fatal;\nupdateLogs(currentLevel());\n\nfunction updateLogs(currentLevel) {\n    debug =\n        currentLevel.id <= levels.DEBUG.id\n            ? console.debug.bind(\n                  console,\n                  `%c Debug %c\\t%c${argPlaceholder}`,\n                  `color:white;background:${levels.DEBUG.bg};font-style:italic`,\n                  `color:${levels.DEBUG.color}`,\n                  `color:${levels.DEBUG.color}`\n              )\n            : function() {};\n\n    info =\n        currentLevel.id <= levels.INFO.id\n            ? console.info.bind(\n                  console,\n                  `%c Info  %c\\t%c${argPlaceholder}`,\n                  `color:white;background:${levels.INFO.bg};font-style:italic`,\n                  `color:${levels.INFO.color}`,\n                  `color:${levels.INFO.color}`\n              )\n            : function() {};\n\n    warn =\n        currentLevel.id <= levels.WARN.id\n            ? console.warn.bind(\n                  console,\n                  `%c Warn  %c\\t%c${argPlaceholder}`,\n                  `color:white;background:${levels.WARN.bg};font-style:italic`,\n                  `color: ${levels.WARN.color}`,\n                  `color:${levels.WARN.color}`\n              )\n            : function() {};\n\n    error =\n        currentLevel.id <= levels.ERROR.id\n            ? console.error.bind(\n                  console,\n                  `%c Error %c\\t%c${argPlaceholder}`,\n                  `color:white;background:${levels.ERROR.bg};font-style:italic`,\n                  `color: ${levels.ERROR.color}`,\n                  `color: ${levels.ERROR.color}`\n              )\n            : function() {};\n\n    fatal =\n        currentLevel.id <= levels.FATAL.id\n            ? console.error.bind(\n                  console,\n                  `%c Fatal \\t%c${argPlaceholder}`,\n                  `color: ${levels.FATAL.color}; background: ${levels.FATAL.bg};font-weight:bold`,\n                  `color: ${levels.FATAL.color}; background: ${levels.FATAL.bg};font-weight:bold`\n              )\n            : function() {};\n}\n\nexport function push(level) {\n    levelStack.push(level);\n    updateLogs(currentLevel());\n}\n\nexport function pop() {\n    levelStack.pop();\n    updateLogs(currentLevel());\n}\n","module.exports = __webpack_public_path__ + \"img/3.f741c501.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',{attrs:{\"id\":\"app\",\"dark\":true}},[_c('router-view')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <v-app id=\"app\" :dark=\"true\">\n        <router-view />\n    </v-app>\n</template>\n\n<script>\nexport default {\n    name: \"App\",\n\n    components: {},\n    beforeCreate() {\n        window.onSpotifyWebPlaybackSDKReady = () => {\n            console.log(\"The Web Playback SDK is ready. We have access to Spotify.Player\");\n        };\n    },\n    data: () => ({\n        //\n    }),\n    mounted: function() {\n        let elHtml = document.getElementsByTagName(\"html\")[0];\n        elHtml.style.overflowY = \"auto\";\n    },\n    destroyed: function() {\n        let elHtml = document.getElementsByTagName(\"html\")[0];\n        elHtml.style.overflowY = null;\n    },\n};\n</script>\n\n<style>\nhtml {\n    position: relative;\n    overflow: hidden;\n}\nbody {\n    overflow: hidden;\n}\n::-webkit-scrollbar {\n    display: none;\n}\n:not(input):not(textarea),\n:not(input):not(textarea)::after,\n:not(input):not(textarea)::before {\n    -webkit-user-select: none;\n    user-select: none;\n}\ninput,\nbutton,\ntextarea,\n:focus {\n    outline: none;\n}\n\nbutton {\n    cursor: pointer;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=1714e1bf&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VApp } from 'vuetify/lib/components/VApp';\ninstallComponents(component, {VApp})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"track\"},[_c('v-app-bar',{attrs:{\"dark\":\"\"}},[_c('v-toolbar-title',[_vm._v(\"Music Structure Visualizer\")]),_c('v-spacer'),(!_vm.testing && !_vm.synthesizing)?_c('form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.search($event)}}},[_c('v-text-field',{attrs:{\"label\":\"Search for songs\",\"hide-details\":\"\",\"append-icon\":\"mdi-magnify\",\"single-line\":\"\",\"rounded\":\"\",\"dense\":\"\",\"filled\":\"\"},on:{\"focus\":function($event){return _vm.$store.commit('setInputFocus', true)},\"blur\":function($event){return _vm.$store.commit('setInputFocus', false)}},model:{value:(_vm.searchQuery),callback:function ($$v) {_vm.searchQuery=$$v},expression:\"searchQuery\"}})],1):_vm._e(),_c('v-spacer'),_c('div',{staticClass:\"volumeSlider\"},[_c('v-container',[_c('v-slider',{attrs:{\"prepend-icon\":_vm.getVolumeIcon(),\"min\":0,\"max\":1,\"step\":0.02},on:{\"click:prepend\":_vm.clickVolume},model:{value:(_vm.volume),callback:function ($$v) {_vm.volume=$$v},expression:\"volume\"}})],1)],1),_c('v-btn',{attrs:{\"icon\":\"\"},on:{\"click\":function($event){return _vm.share()}}},[_c('v-icon',[_vm._v(\"mdi-share-variant\")])],1)],1),(!_vm.synthesizing)?_c('TrackSelector',{attrs:{\"tracks\":_vm.trackList,\"album-size\":120}}):_vm._e(),_c('div',{ref:\"mainContent\",staticClass:\"mainContent\",style:(_vm.mainContentStyle)},[(!_vm.synthesizing)?_c('Player',{attrs:{\"width\":_vm.mainContentWidth}}):_vm._e(),_c('Visualization',{attrs:{\"width\":_vm.mainContentWidth,\"showPrototype\":_vm.showPrototype}}),_c('v-btn',{staticClass:\"readMore\",staticStyle:{\"color\":\"#aaa\"},on:{\"click\":function($event){return _vm.readMore()}}},[_c('v-icon',{staticStyle:{\"margin-right\":\".5em\"}},[_vm._v(\"mdi-book-information-variant\")]),_vm._v(\" Read about this project \")],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-slide-group',{staticClass:\"pt-2\",attrs:{\"center-active\":\"\",\"mandatory\":\"\"},nativeOn:{\"scroll\":function($event){return _vm.onScroll($event)}},model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}},_vm._l((_vm.tracks),function(track,index){return _c('v-slide-item',{key:index,staticClass:\"mx-2 my-1\",scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar active = ref.active;\nvar toggle = ref.toggle;\nreturn [_c('Album',{attrs:{\"album\":track.trackData,\"imgSize\":active ? _vm.albumSize * 1.5 : _vm.albumSize,\"active\":active},on:{\"clicked\":toggle,\"clickedArtist\":function($event){return _vm.clickedArtist(track)}}})]}}],null,true)})}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{class:_vm.active ? 'elevation-3' : 'elevation-0',style:(_vm.cardStyle)},[_c('div',{directives:[{name:\"ripple\",rawName:\"v-ripple\"}],staticClass:\"track\",on:{\"click\":_vm.clicked}},[_c('v-img',{attrs:{\"height\":_vm.imgSize,\"width\":_vm.imgSize,\"src\":_vm.album.album.images[_vm.imgIndex].url}}),_c('v-card-text',{staticClass:\"pl-2 py-0 pt-1 ml-0 my-0\"},[_c('div',{staticClass:\"text-subtitle-2 text--primary text-truncate\"},[_vm._v(\" \"+_vm._s(_vm.album.name)+\" \")])])],1),_c('v-card-actions',{staticClass:\"pl-0 py-0 ml-0 my-0\"},[_c('v-btn',{staticClass:\"artistButton\",attrs:{\"text\":\"\",\"color\":\"grey\",\"small\":\"\"},on:{\"click\":function($event){return _vm.clickedArtist()}}},[_c('span',{staticClass:\"artistButtonText text-caption text-truncate\",style:({ 'max-width': this.imgSize - 12 + 'px' })},[_vm._v(\" \"+_vm._s(_vm.album.artists[0].name)+\" \")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <v-card :style=\"cardStyle\" :class=\"active ? 'elevation-3' : 'elevation-0'\">\n        <div class=\"track\" v-ripple @click=\"clicked\">\n            <v-img :height=\"imgSize\" :width=\"imgSize\" :src=\"album.album.images[imgIndex].url\"></v-img>\n            <v-card-text class=\"pl-2 py-0 pt-1 ml-0 my-0\">\n                <div class=\"text-subtitle-2 text--primary text-truncate\">\n                    {{ album.name }}\n                </div>\n            </v-card-text>\n        </div>\n        <v-card-actions class=\"pl-0 py-0 ml-0 my-0\">\n            <v-btn class=\"artistButton\" text color=\"grey\" small @click=\"clickedArtist()\">\n                <span\n                    class=\"artistButtonText text-caption text-truncate\"\n                    :style=\"{ 'max-width': this.imgSize - 12 + 'px' }\"\n                >\n                    {{ album.artists[0].name }}\n                </span>\n            </v-btn>\n        </v-card-actions>\n    </v-card>\n</template>\n\n<script>\nexport default {\n    props: [\"album\", \"imgSize\", \"active\"],\n    data() {\n        return {};\n    },\n    mounted() {},\n    computed: {\n        imgIndex() {\n            if (this.size <= this.album.album.images[2].height) return 2;\n            if (this.size <= this.album.album.images[1].height) return 1;\n            return 0;\n        },\n        cardStyle() {\n            return {\n                width: this.imgSize + \"px\",\n                height: this.imgSize + 55 + \"px\",\n            };\n        },\n    },\n    methods: {\n        clicked() {\n            this.$emit(\"clicked\");\n        },\n        clickedArtist() {\n            this.$emit(\"clickedArtist\");\n        },\n    },\n};\n</script>\n\n<style>\n.track:hover {\n    cursor: pointer;\n}\n.artistButton {\n    text-transform: none !important;\n}\n.artistButtonText {\n    margin-left: -3px;\n    margin-right: 0px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Album.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Album.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Album.vue?vue&type=template&id=82090b64&\"\nimport script from \"./Album.vue?vue&type=script&lang=js&\"\nexport * from \"./Album.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Album.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VImg } from 'vuetify/lib/components/VImg';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardText,VImg})\n\n\n/* vuetify-loader */\nimport installDirectives from \"!../../node_modules/vuetify-loader/lib/runtime/installDirectives.js\"\nimport Ripple from 'vuetify/lib/directives/ripple'\ninstallDirectives(component, {Ripple})\n","import * as log from \"../dev/log\";\nimport router from \"../router\";\n\nimport axios from \"axios\";\n\nconst port = process.env.SERVER_PORT || 5000;\nconst url = (process.env.VUE_APP_HOST_URL || \"http://localhost\" + \":\" + port) + \"/api\";\nconst api = axios.create({\n    baseURL: url,\n    withCredentials: false,\n});\n\nexport let token;\nlet tokenTimestamp = new Date();\nlet expiresIn = 3600;\nlet refreshToken;\n\nsetInterval(() => {\n    log.debug(\"Token expires in\", Math.floor((expiresIn - (new Date() - tokenTimestamp) / 1000) / 60), \"minutes\");\n}, 5 * 60000);\n\nexport async function requestFirstToken(code) {\n    await api\n        .post(\"spotify/token\", {\n            grant_type: \"authorization_code\",\n            code: code,\n        })\n        .then((res) => {\n            token = res.data.access_token;\n            window.sessionStorage.setItem(\"token\", token);\n            expiresIn = res.data.expires_in;\n            tokenTimestamp = new Date();\n            window.sessionStorage.setItem(\"tokenTimestamp\", new Date());\n            refreshToken = res.data.refresh_token;\n            window.sessionStorage.setItem(\"refreshToken\", refreshToken);\n            setTimeout(requestRefreshToken, expiresIn * 1000);\n        })\n        .catch((err) => {\n            log.error(err);\n        });\n}\n\nexport async function requestRefreshToken() {\n    if (!refreshToken) {\n        refreshToken = window.sessionStorage.getItem(\"refreshToken\");\n        if (!refreshToken) {\n            router.push(\"/login\");\n        }\n    }\n    await api\n        .post(\"spotify/token\", {\n            grant_type: \"refresh_token\",\n            refresh_token: refreshToken,\n        })\n        .then((res) => {\n            token = res.data.access_token;\n            window.sessionStorage.setItem(\"token\", token);\n            expiresIn = res.data.expires_in;\n            tokenTimestamp = new Date();\n            window.sessionStorage.setItem(\"tokenTimestamp\", new Date());\n            if (res.data.refresh_token) {\n                refreshToken = res.data.refresh_token;\n            }\n            window.sessionStorage.setItem(\"refreshToken\", refreshToken);\n            setTimeout(requestRefreshToken, expiresIn * 1000);\n        })\n        .catch((err) => {\n            log.error(err);\n        });\n}\n\nexport function isAuthorized() {\n    if (token === undefined) {\n        const t = window.sessionStorage.getItem(\"token\");\n        const e = window.sessionStorage.getItem(\"tokenTimestamp\");\n        const r = window.sessionStorage.getItem(\"refreshToken\");\n        if (t) {\n            token = t;\n            refreshToken = r;\n            if (!refreshToken || refreshToken.length <= 0) {\n                return false;\n            }\n            tokenTimestamp = new Date(e);\n            if (tokenExpired()) {\n                return false;\n            }\n            setTimeout(requestRefreshToken, timeLeftMilliseconds());\n            return true;\n        } else {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function tokenExpired() {\n    return timeLeftMilliseconds() < 0;\n}\n\nexport function timeLeftMilliseconds() {\n    return expiresIn * 1000 - (new Date() - tokenTimestamp) < 0;\n}\n","import * as log from \"../dev/log\";\nexport const measures = {\n    EUCLIDIAN: \"euclidian\",\n    MANHATTAN: \"manhattan\",\n    COSINE: \"cosine\",\n};\n\nconst maxEuclidianPitchDistance = Math.sqrt(12);\nconst maxEuclidianTimbreDistance = Math.sqrt(Math.pow(2, 2) * 12);\n\nexport function cosine(a, b) {\n    var adotv = 0;\n    var amag = 0;\n    var bmag = 0;\n    for (var i = 0; i < a.length; i++) {\n        adotv += a[i] * b[i];\n        amag += a[i] * a[i];\n        bmag += b[i] * b[i];\n    }\n    amag = Math.sqrt(amag);\n    bmag = Math.sqrt(bmag);\n    return adotv / (amag * bmag);\n}\n\nexport function cosineTransposed(a, b, p) {\n    var adotv = 0;\n    var amag = 0;\n    var bmag = 0;\n    for (var i = 0; i < a.length; i++) {\n        let transposedI = (i + p) % 12;\n        adotv += a[i] * b[transposedI];\n        amag += a[i] * a[i];\n        bmag += b[transposedI] * b[transposedI];\n    }\n    amag = Math.sqrt(amag);\n    bmag = Math.sqrt(bmag);\n    return adotv / (amag * bmag);\n}\n\nexport function manhattanDistance(a, b) {\n    let dist = 0;\n    for (let i = 0; i < a.length; i++) {\n        dist += Math.abs(a[i] - b[i]);\n    }\n    return dist;\n}\n// Manhattan distance scaled back to [0,1]\nexport function manhattan(a, b, range) {\n    return 1 - this.manhattanDistance(a, b) / range;\n}\n\nexport function euclidianDistance(a, b) {\n    return Math.sqrt(squaredDistance(a, b));\n}\n\nexport function euclidianDistanceTransposed(a, b, p) {\n    return Math.sqrt(squaredDistanceTransposed(a, b, p));\n}\nexport function maxEuclidianDistance(length, range) {\n    return Math.sqrt(range * range * length);\n}\nexport function euclidian(a, b, maxDist) {\n    return 1 - euclidianDistance(a, b) / maxDist;\n}\n\nexport function euclidianTimbre(a, b) {\n    return 1 - euclidianDistance(a, b) / maxEuclidianTimbreDistance;\n}\n\nexport function euclidianPitch(a, b) {\n    return 1 - euclidianDistance(a, b) / maxEuclidianPitchDistance;\n}\n\nexport function euclidianPitchTransposed(a, b, p) {\n    return 1 - euclidianDistanceTransposed(a, b, p) / maxEuclidianPitchDistance;\n}\n\nexport function squaredDistance(a, b) {\n    let dist = 0;\n    for (let i = 0; i < a.length; i++) {\n        const diff = a[i] - b[i];\n        dist += diff * diff;\n    }\n    return dist;\n}\n\nexport function squaredDistanceTransposed(a, b, p) {\n    let dist = 0;\n    for (let i = 0; i < a.length; i++) {\n        let transposedI = (i + p) % 12;\n        const diff = a[i] - b[transposedI];\n        dist += diff * diff;\n    }\n    return dist;\n}\n\nexport function correlate(featureA, featureB) {\n    const avgA = featureA.reduce((sum, val) => sum + val) / featureA.length;\n    const avgB = featureB.reduce((sum, val) => sum + val) / featureB.length;\n\n    let sum = 0;\n    for (let i = 0; i < featureA.length; i++) {\n        sum += (featureA[i] - avgA) * (featureB[i] - avgB);\n    }\n\n    const sumSquaresA = featureA.reduce((sum, val) => sum + Math.pow(val - avgA, 2));\n    const sumSquaresB = featureB.reduce((sum, val) => sum + Math.pow(val - avgB, 2));\n\n    return sum / Math.sqrt(sumSquaresA * sumSquaresB);\n}\n","import { stat } from \"fs\";\nimport Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport Track from \"../app/Track\";\nimport * as log from \"../dev/log\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n    state: {\n        browser: \"\",\n        user: Object,\n        trackList: [],\n        selectedIndex: 0,\n        loadingTrack: true,\n        // Player global variables\n        playerReady: false,\n        playing: false,\n        seeker: 0,\n        seekerUpdateSpeed: 40, // 100ms\n        isZoomed: false,\n        zoomScale: 10,\n        playerActive: true,\n        inputFocus: false,\n    },\n    mutations: {\n        setSeeker(state, time_ms) {\n            state.seeker = time_ms;\n        },\n        setUser(state, user) {\n            state.user = user;\n        },\n        setPlayerState(state, playerState) {\n            state.playerState = playerState;\n        },\n        loadingTrack(state, loadingTrack) {\n            state.loadingTrack = loadingTrack;\n        },\n        playerReady(state, playerReady) {\n            state.playerReady = playerReady;\n        },\n        addToTrackList(state, track) {\n            state.trackList.push(track);\n        },\n        addToTrackListIndex(state, index, track) {\n            state.trackList.splice(index, 0, track);\n        },\n        addToTrackListFront(state, track) {\n            state.trackList.unshift(track);\n        },\n        clearTrackList(state) {\n            state.trackList = [];\n        },\n        setSelectedIndex(state, index) {\n            state.selectedIndex = index;\n        },\n        setPlaying(state, playing) {\n            state.playing = playing;\n        },\n        incrementSeeker(state, increment) {\n            state.seeker += increment;\n        },\n        setZoomed(state, zoomed) {\n            state.isZoomed = zoomed;\n        },\n        toggleZoomed(state) {\n            state.isZoomed = !state.isZoomed;\n        },\n        setPlayerActive(state, active) {\n            state.playerActive = active;\n        },\n        setInputFocus(state, focus) {\n            state.inputFocus = focus;\n        },\n    },\n    actions: {},\n    getters: {\n        seeker(state) {\n            return state.seeker;\n        },\n        selectedIndex(state) {\n            return state.selectedIndex;\n        },\n        selectedTrack(state) {\n            return state.trackList[state.selectedIndex];\n        },\n        user(state) {\n            return state.user;\n        },\n        track(state, id) {\n            return state.trackList[id];\n        },\n        trackList(state) {\n            return state.trackList;\n        },\n        playerState(state) {\n            return state.playerState;\n        },\n        playerReady(state) {\n            return state.playerReady;\n        },\n        playing(state) {\n            return state.playing;\n        },\n        isZoomed(state) {\n            return state.isZoomed;\n        },\n        zoomScale(state) {\n            return state.zoomScale;\n        },\n        seekerUpdateSpeed(state) {\n            return state.seekerUpdateSpeed;\n        },\n        playerActive(state) {\n            return state.playerActive;\n        },\n        isInputFocused(state) {\n            return state.inputFocus;\n        },\n    },\n    modules: {},\n});\n","import * as log from \"../dev/log\";\n\nconst d3 = require(\"d3\");\nexport const circleOfFifths = [0, 7, 2, 9, 4, 11, 6, 1, 8, 3, 10, 5]; // Starting from C=0\nexport const noteNames = [\"C\", \"C\", \"D\", \"D\", \"E\", \"F\", \"F\", \"G\", \"G\", \"A\", \"A\", \"B\"];\nexport const keyNames = [\n    \"C\",\n    \"D\",\n    \"D\",\n    \"E\",\n    \"E\",\n    \"F\",\n    \"F\",\n    \"G\",\n    \"A\",\n    \"A\",\n    \"B\",\n    \"B\",\n    \"Cm\",\n    \"Dm\",\n    \"Dm\",\n    \"Em\",\n    \"Em\",\n    \"Fm\",\n    \"Fm\",\n    \"Gm\",\n    \"Am\",\n    \"Am\",\n    \"Bm\",\n    \"Bm\",\n];\n\n//https://www.vectorstock.com/royalty-free-vector/color-wheel-spectrum-scheme-selection-color-vector-25483441\nexport const colorWheelOld = d3\n    .scaleLinear()\n    .domain([\n        0,\n        1 / 12,\n        2 / 12,\n        2.8 / 12,\n        3.8 / 12,\n        4.3 / 12,\n        5.3 / 12,\n        6.8 / 12,\n        8 / 12,\n        8.8 / 12,\n        9.3 / 12,\n        10.5 / 12,\n        1,\n    ])\n    .interpolate(d3.interpolateHcl)\n    .range([\n        d3.rgb(\"#FE0000\"),\n        d3.rgb(\"#FF7300\"),\n        d3.rgb(\"#FFAA01\"),\n        d3.rgb(\"#FFD300\"),\n        d3.rgb(\"#FFFF01\"),\n        d3.rgb(\"#9FEE00\"),\n        d3.rgb(\"#01CC00\"),\n        d3.rgb(\"#009899\"),\n        d3.rgb(\"#1241AB\"),\n        d3.rgb(\"#3914B1\"),\n        d3.rgb(\"#7209AC\"),\n        d3.rgb(\"#CD0174\"),\n        d3.rgb(\"#FE0000\"),\n    ]);\nexport const colorWheel = d3\n    .scaleLinear()\n    .domain([0, 1 / 12, 2 / 12, 3 / 12, 4 / 12, 5 / 12, 6 / 12, 7 / 12, 8 / 12, 9 / 12, 10 / 12, 11 / 12, 1])\n    .interpolate(d3.interpolateHcl)\n    .range([\n        d3.rgb(\"#da321f\"),\n        d3.rgb(\"#e06300\"),\n        d3.rgb(\"#e89b00\"),\n        d3.rgb(\"#ebcb03\"),\n        d3.rgb(\"#9fbb04\"),\n        d3.rgb(\"#2cbe03\"),\n        d3.rgb(\"#03b779\"),\n        d3.rgb(\"#06b3bd\"),\n        d3.rgb(\"#3875cc\"),\n        d3.rgb(\"#7503db\"),\n        d3.rgb(\"#c203ae\"),\n        d3.rgb(\"#e84b90\"),\n        d3.rgb(\"#da321f\"),\n    ]);\n\nexport function getNoteName(i) {\n    return noteNames[i];\n}\n\nvar DEGREES_PER_RADIAN = 180 / Math.PI;\nvar RADIANS_PER_DEGREE = Math.PI / 180;\nexport const TWO_PI = 2 * Math.PI;\nexport const OFFSET = Math.PI / 2; // (3 * Math.PI) / 2; // full cycle is 2pi\n\nfunction sortWithIndeces(toSort) {\n    const toSortValIndex = [];\n    for (var i = 0; i < toSort.length; i++) {\n        toSortValIndex.push([toSort[i], i]);\n    }\n    toSortValIndex.sort(function(left, right) {\n        return left[0] < right[0] ? -1 : 1;\n    });\n    const toSortIndex = [];\n    for (var j = 0; j < toSort.length; j++) {\n        toSortIndex.push(toSortValIndex[j][1]);\n    }\n    return toSortIndex;\n}\n\nexport function tonality(pitches) {\n    let x = 0;\n    let y = 0;\n    let energy = 0;\n    for (let i = 0; i < 12; i++) {\n        const vangle = (circleOfFifths[i] / 12.0) * TWO_PI;\n        const vradius = pitches[i]; // Between 0 and 1\n        energy += vradius / 12;\n        x += vradius * Math.cos(vangle);\n        y += vradius * Math.sin(vangle);\n    }\n    const angle = (1 + Math.atan2(y, x) / TWO_PI) % 1;\n    const radius = Math.sqrt(x * x + y * y) / (energy * 12);\n    //return tonalityThirds(pitches);\n    return [angle, radius, energy];\n}\n\nexport function tonalityThirds(pitches) {\n    let x = 0;\n    let y = 0;\n    let energy = 0;\n\n    const sortedPitchIndexes = sortWithIndeces(pitches).reverse();\n    for (let i = 0; i < pitches.length; i++) {\n        const index = sortedPitchIndexes[i];\n        if (index === -1) continue;\n        sortedPitchIndexes[i] = -1;\n        const vangle = -(circleOfFifths[index] / 12.0) * TWO_PI + OFFSET;\n        const vradius = pitches[index]; // Between 0 and 1\n        energy += vradius / 12;\n        x += vradius * Math.cos(vangle);\n        y += vradius * Math.sin(vangle);\n\n        const majThirdIndex = (index + 4) % 12;\n        if (sortedPitchIndexes.includes(majThirdIndex)) {\n            const vangle = -(((12 + circleOfFifths[majThirdIndex] - 3.5) % 12) / 12.0) * TWO_PI + OFFSET;\n            const vradius = pitches[majThirdIndex]; // Between 0 and 1\n            energy += vradius / 12;\n            x += vradius * Math.cos(vangle);\n            y += vradius * Math.sin(vangle);\n            sortedPitchIndexes[sortedPitchIndexes.indexOf(majThirdIndex)] = -1;\n        }\n    }\n    const angle = (1 - Math.atan2(x, y) / TWO_PI + 0.25) % 1;\n    const radius = Math.sqrt(x * x + y * y) / (energy * 12);\n    return [angle, radius, energy];\n}\n\nexport function tonalityThird(pitches) {\n    let x = 0;\n    let y = 0;\n    let energy = 0;\n\n    let maxIndex = -1;\n    let max = -1;\n    let secondMaxIndex = -1;\n    let secondMax = -1;\n\n    for (let i = 0; i < 12; i++) {\n        if (pitches[i] > max) {\n            max = pitches[i];\n            maxIndex = i;\n        }\n        if (pitches[i] >= secondMax && i !== maxIndex) {\n            secondMax = pitches[i];\n            secondMaxIndex = i;\n        }\n    }\n    // major third apart\n    if ((12 + secondMaxIndex - maxIndex) % 12 !== 4) {\n        secondMaxIndex = -1;\n    }\n\n    for (let i = 0; i < 12; i++) {\n        let vangle = -(circleOfFifths[i] / 12.0) * TWO_PI + OFFSET;\n\n        if (i === secondMaxIndex) {\n            // add differently\n            vangle = -(((12 + circleOfFifths[i] - 3.5) % 12) / 12.0) * TWO_PI + OFFSET;\n        }\n\n        const vradius = pitches[i]; // Between 0 and 1\n        energy += vradius / 12;\n        x += vradius * Math.cos(vangle);\n        y += vradius * Math.sin(vangle);\n    }\n    const angle = (1 - Math.atan2(x, y) / TWO_PI + 0.25) % 1;\n    const radius = Math.sqrt(x * x + y * y) / (energy * 12);\n    return [angle, radius, energy];\n}\n\nexport function tonalVectorColor(pitches) {\n    const [angle, radius, energy] = tonality(pitches);\n\n    //const color = d3.color(d3.interpolateSinebow((angle+OFFSET)%1.0));\n    const color = d3.hsl(colorWheel(angle));\n    const saturation = Math.min((radius * 3) / (energy * 12), 1); // 3 because chord usually minimally 3 tones\n    color.s = saturation;\n    return color.hex();\n}\nexport function loudness(db) {\n    return Math.max(0, 60 + db) / 60;\n}\n\nexport function loudnessPerceived(db) {\n    return Math.pow(2, db / 10);\n}\n\nexport function logCompression(value, gamma = 1) {\n    return Math.log(1 + gamma * value) / Math.log(gamma);\n}\n","import * as log from \"../dev/log\";\nimport * as audioUtil from \"./audioUtil\";\n\nconst tryRemovePercussion = false;\nconst equalizeBass = false;\n\nexport default class SpotifySegment {\n    segment = null;\n    start = 0;\n    duration = 0;\n    loudness_start = 0;\n    loudness_max_time = 0;\n    loudness_max = 0;\n    loudness_end = 0;\n\n    pitches = [];\n    noise = [];\n    timbres = [];\n    timbresScaled = [];\n\n    cluster = -1;\n    tsneCoord = [0, 0];\n\n    tonalityAngle = 0; // [0,1] Angle of vector on circle of fifths\n    tonalityRadius = 0; // [0,1] Radius of vector on circle of fifths, low value means very dissonant or atonal\n    tonalityEnergy = 0; // [0,1] Total energy of all the pitches, high energy means lots of notes played at the same time\n\n    percussiony = 0; // [0,1] segments larger than .15\n\n    constructor(segment) {\n        this.segment = segment;\n        this.start = segment.start;\n        this.duration = segment.duration;\n        this.loudness_start = segment.loudness_start;\n        this.loudness_max = segment.loudness_max;\n        this.loudness_max_time = segment.loudness_max_time;\n        this.loudness_end = segment.loudness_end;\n        this.processPitch();\n        this.processPitchEqualizeBass();\n    }\n\n    processedPitch = false;\n    processPitch() {\n        if (this.processedPitch) return;\n        if (this.processedPitchSmooth) throw Error(\"processed pitchSmooth before setting initial pitch\");\n        this.segment.pitches.forEach((pitch, i) => {\n            this.pitches.push(pitch); //audioUtil.logCompression(pitch, GAMMA));\n        });\n        [this.tonalityAngle, this.tonalityRadius, this.tonalityEnergy] = audioUtil.tonality(this.pitches);\n\n        const minDuration = 0.2;\n        const decay = 0.5;\n        const shortness = this.duration < minDuration ? 1 : decay - (this.duration - 0.15);\n\n        for (let p = 0; p < 12; p++) {\n            this.noise.push(\n                Math.max(0, this.pitches[(p + 11) % 12] + this.pitches[p] + this.pitches[(p + 1) % 12] - 2)\n            );\n        }\n\n        this.percussiony = Math.max(Math.min(1, (1 - this.tonalityRadius) * this.tonalityEnergy * 2) * shortness, 0);\n        this.percussiony = Math.max(0, Math.min(1, 1 - this.tonalityRadius * 6));\n        this.percussiony = Math.max(0, Math.min(1, (1 - this.tonalityRadius) * this.tonalityEnergy));\n        this.percussiony = this.noise.reduce((sum, val) => sum + val / 12) * 2;\n        this.processedPitch = true;\n    }\n\n    processedPitchSmooth = false;\n    processPitchSmooth(prevSegment, nextSegment) {\n        if (!tryRemovePercussion) return;\n        if (this.processedPitchSmooth) return;\n        if (!this.processedPitch) throw Error(\"processed pitchSmooth called before setting initial pitch\");\n\n        for (let p = 0; p < this.pitches.length; p++) {\n            this.pitches[p] =\n                (1 - this.percussiony) * this.pitches[p] +\n                (this.percussiony *\n                    (prevSegment.pitches[p] * this.pitches[p] + nextSegment.pitches[p] * this.pitches[p])) /\n                    2;\n        }\n\n        //this.pitches[11] = this.percussiony;\n        //this.pitches[10] = 1 - this.tonalityRadius;\n        //this.pitches[9] = this.tonalityEnergy;\n\n        this.processedPitchSmooth = true;\n    }\n\n    processPitchEqualizeBass() {\n        if (equalizeBass) {\n            let maxPitch = 0;\n            this.pitches.forEach((pitch) => {\n                if (pitch > maxPitch) {\n                    maxPitch = pitch;\n                }\n            });\n\n            let secondMaxPitch = 0;\n            this.pitches.forEach((pitch) => {\n                if (pitch < maxPitch && pitch > secondMaxPitch) {\n                    secondMaxPitch = pitch;\n                }\n            });\n\n            const equalizeAmount = 0; // 1 is full equalize: loudest is same as second loudest, 0 is none\n            const scale = 1 / (1 - (maxPitch - secondMaxPitch) * equalizeAmount);\n            for (let p = 0; p < this.pitches.length; p++) {\n                this.pitches[p] = Math.min(1, this.pitches[p] * scale);\n            }\n        }\n    }\n\n    processedTimbre = false;\n    processTimbre(min, max, biggest, totalBiggest) {\n        if (this.processedTimbre) return;\n        this.segment.timbre.forEach((timbre, i) => {\n            this.timbres.push(timbre / totalBiggest);\n        });\n        this.segment.timbre.forEach((timbre, i) => {\n            this.timbresScaled.push(timbre / biggest[i]);\n        });\n        this.processedTimbre = true;\n    }\n\n    getPitches() {\n        return this.pitches;\n    }\n    getTimbres() {\n        return this.timbres;\n    }\n    getDuration() {\n        return this.duration_ms;\n    }\n    getStart() {\n        return this.start;\n    }\n    getEnd() {\n        return this.start + this.duration;\n    }\n    getOriginalTimbres() {\n        return this.segment.timbre;\n    }\n    getFeatures() {\n        return this.pitches.concat(this.timbres);\n    }\n    setCluster(i) {\n        this.cluster = i;\n    }\n    setTSNECoord(coord) {\n        this.tsneCoord = coord;\n    }\n    getTonalEnergy() {\n        return this.tonalityEnergy;\n    }\n    getTonalAngle() {\n        return this.tonalityAngle;\n    }\n    getLoudnessFeatures() {\n        return [\n            audioUtil.loudnessPerceived(this.loudness_start),\n            audioUtil.loudnessPerceived(this.loudness_max),\n            this.loudness_max_time,\n            audioUtil.loudnessPerceived(this.loudness_end),\n        ];\n    }\n    getAverageLoudness(nextSegmentLoudness) {\n        const loudnessFeatures = this.getLoudnessFeatures();\n        const start = loudnessFeatures[0];\n        const end = nextSegmentLoudness;\n        const max = loudnessFeatures[1];\n        const maxTime = loudnessFeatures[2];\n\n        const avgFirst = (max + start) / 2;\n        const avgSecond = (max + end) / 2;\n        const avg = avgFirst * maxTime + avgSecond * (1 - maxTime);\n        return avg;\n    }\n}\n","import * as similarity from \"./similarity\";\nimport * as audioUtil from\"./audioUtil\";\nimport * as log from \"../dev/log\";\nconst d3 = require(\"d3\");\n\nexport const notes = [\"C\", \"C\", \"D\", \"E\", \"E\", \"F\", \"F\", \"G\", \"G\", \"A\", \"B\", \"B\"];\nexport const circleOfFifths = [0, 7, 2, 9, 4, 11, 6, 1, 8, 3, 10, 5]; // Starting from C=0\n\nexport const chords = {\n    major: { name: \"Major\", weight: 1, template: [1, 0, 0, 0, 0.8, 0, 0, 0.5, 0, 0, 0, 0] },\n    minor: { name: \"minor\", weight: 1, template: [1, 0, 0, 0.8, 0, 0, 0, 0.5, 0, 0, 0, 0] },\n    sus2: { name: \"Sus2\", weight: 0.9, template: [1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0] },\n    sus4: { name: \"Sus4\", weight: 0.9, template: [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0] },\n    dim: { name: \"Dim\", weight: 0.9, template: [1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0] },\n    aug: { name: \"Aug\", weight: 0.9, template: [1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0] },\n    maj7: { name: \"Maj7\", weight: 0.7, template: [1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1] },\n    seven: { name: \"7\", weight: 0.7, template: [1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0] },\n    min7: { name: \"min7\", weight: 0.7, template: [1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0] },\n    min6: { name: \"min6\", weight: 0.7, template: [1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0] },\n    min7b5: { name: \"min7/b5\", weight: 0.7, template: [1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0] },\n    minmaj7: { name: \"minMaj7\", weight: 0.7, template: [1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1] },\n    sus27: { name: \"Sus2/7\", weight: 0.7, template: [1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1] },\n    sus47: { name: \"Sus4/7\", weight: 0.7, template: [1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1] },\n    dim6: { name: \"Dim6\", weight: 0.7, template: [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0] },\n    maj7sharp5: { name: \"Maj7/#5\", weight: 0.7, template: [1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1] },\n};\nconst scales = {\n    major: { name: \"Major\", weight: 1, template: [1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1] },\n    minor: { name: \"minor\", weight: 1, template: [1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0] },\n};\n\nconst pureMajorMinor = {\n    major: { name: \"Major\", weight: 1, template: [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0] },\n    minor: { name: \"minor\", weight: 1, template: [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0] },\n};\n\nexport const majorminor = [chords.major, chords.minor];\nexport const popchords = [...majorminor, chords.dim, chords.aug, chords.seven, chords.maj7, chords.min7];\nexport const allchords = [\n    ...popchords,\n    chords.sus2,\n    chords.sus4,\n    chords.sus27,\n    chords.sus47,\n    chords.min6,\n    chords.min7b5,\n    chords.minmaj7,\n    chords.dim6,\n    chords.maj7sharp5,\n];\n\nexport function getConfidence(pitches, chord, bassNote) {\n    if (bassNote === undefined) {\n        bassNote = getBassNote(pitches);\n    }\n    return chord.weight * similarity.cosineTransposed(pitches, chord.template, 12 - bassNote);\n}\n\nexport function getMajorMinorChordVectors(pitchFeatures) {\n    const chordFeatures = [];\n    pitchFeatures.forEach((pitchVector) => {\n        chordFeatures.push(getMajorMinorChordVector(pitchVector));\n    });\n    return chordFeatures;\n}\n\nexport function getMajorMinorChordVector(pitches) {\n    const vector = [];\n    for (let i = 0; i < 12; i++) {\n        vector.push(similarity.cosineTransposed(pitches, chords.major.template, 12 - i));\n    }\n    for (let i = 0; i < 12; i++) {\n        vector.push(similarity.cosineTransposed(pitches, chords.minor.template, 12 - i));\n    }\n    return vector;\n}\n\nexport function maxChordFeatures(vectors, windowSize) {\n    const maxChordFeatures = [];\n    const vectorSize = vectors[0].length;\n    const totalWindowSize = windowSize * 2 + 1;\n    for (let i = 0; i < vectors.length; i++) {\n        const averagedVector = new Float32Array(vectorSize);\n\n        for (let w = -windowSize; w <= windowSize; w++) {\n            if (i + w >= 0 && i + w < vectors.length) {\n                const vector = vectors[i + w];\n                for (let f = 0; f < vectorSize; f++) {\n                    averagedVector[f] += vector[f] / totalWindowSize;\n                }\n            }\n        }\n        let max = 0;\n        let maxIndex = 0;\n        for (let f = 0; f < vectorSize; f++) {\n            if (averagedVector[f] > max) {\n                max = averagedVector[f];\n                maxIndex = f;\n            }\n        }\n\n        for (let f = 0; f < vectorSize; f++) {\n            if (f !== maxIndex) averagedVector[f] = 0;\n        }\n        maxChordFeatures.push(averagedVector);\n    }\n    return maxChordFeatures;\n}\n\nexport function getChordIndexes(maxChordFeatures) {\n    const chordIndexes = [];\n    for (let i = 0; i < maxChordFeatures.length; i++) {\n        chordIndexes.push(maxChordFeatures[i].findIndex((val) => val !== 0));\n    }\n    return chordIndexes;\n}\n\nexport function getChords(chordIndexes) {\n    const chords = [];\n    let prevChordIndex = 0;\n    for (let i = 0; i < chordIndexes.length; i++) {\n        const chordIndex = chordIndexes[i];\n        if (chordIndex !== prevChordIndex) {\n            prevChordIndex = chordIndex;\n            if (chords.length > 0) chords[chords.length - 1].endSample = i;\n            chords.push({\n                name: getChordName(chordIndex),\n                index: chordIndex,\n                angle: chordAngle(chordIndex),\n                startSample: i,\n            });\n        }\n    }\n    chords[chords.length - 1].endSample = chordIndexes.length;\n    return chords;\n}\n\nexport function chordAngle(chordIndex) {\n    const posZeroEleven = chordIndex >= 12 ? (chordIndex + 3) % 12 : chordIndex;\n    const angle = circleOfFifths[posZeroEleven] / 12;\n    return angle;\n}\n\nvar TWO_PI = 2 * Math.PI;\nvar OFFSET = (3 * Math.PI) / 2; // full cycle is 2pi\n\nexport function tonality(pitches) {\n    let x = 0;\n    let y = 0;\n    let energy = 0;\n    for (let i = 0; i < 12; i++) {\n        const angle = (-circleOfFifths[i] / 12.0) * TWO_PI + OFFSET;\n        const radius = pitches[i]; // Between 0 and 1\n        energy += radius / 12;\n        x += radius * Math.cos(angle);\n        y += radius * Math.sin(angle);\n    }\n\n    const angle = (Math.atan2(x, y) + Math.PI) / TWO_PI;\n    const radius = Math.sqrt(x * x + y * y);\n    return [angle, radius, energy];\n}\n\nexport function tonalVectorColor(pitches) {\n    const [angle, radius, energy] = tonality(pitches);\n\n    //const color = d3.color(d3.interpolateSinebow((angle+OFFSET)%1.0));\n    const color = d3.hsl(audioUtil.colorWheel(angle));\n    const saturation = Math.min((radius * 3) / (energy * 12), 1); // 3 because chord usually minimally 3 tones\n    color.s = saturation;\n    return color.hex();\n}\n\nexport function getChordName(chordIndex) {\n    return `${notes[chordIndex % 12]}${chordIndex >= 12 ? \"m\" : \"\"}`;\n}\n\n// Is it more Major than minor ?\nexport function isMajor(pitches) {\n    return getConfidence(pitches, chords.major) >= getConfidence(pitches, chords.minor);\n}\n\n// Is it more minor than Major ?\nexport function isMinor(pitches) {\n    return !isMajor(pitches);\n}\n\nexport function getBassNote(pitches) {\n    let maxPitch = 0;\n    let maxIndex = 0;\n    for (let i = 0; i < 12; i++) {\n        if (pitches[i] > maxPitch) {\n            maxPitch = pitches[i];\n            maxIndex = i;\n        }\n    }\n    return maxIndex;\n}\n\nexport function getHighestConfidenceChord(pitches, chordSet) {\n    const bassNote = getBassNote(pitches);\n\n    let maxChord = null;\n    let maxConfidence = 0;\n    chordSet.forEach((chord) => {\n        const confidence = getConfidence(pitches, chord, bassNote);\n        if (confidence > maxConfidence) {\n            maxConfidence = confidence;\n            maxChord = chord;\n        }\n    });\n    return maxChord;\n}\n\nexport function getMajorMinor(pitches) {\n    return getHighestConfidenceChord(pitches, majorminor);\n}\n\nexport function getMajorMinorNess(pitches) {\n    const majorness = getConfidence(pitches, pureMajorMinor.major);\n    const minorness = getConfidence(pitches, pureMajorMinor.minor);\n    return Math.max(-1, Math.min(1, (majorness - minorness) * 12));\n}\n\nexport function getPopChord(pitches) {\n    return getHighestConfidenceChord(pitches, popchords);\n}\n\nexport function getChord(pitches) {\n    return getHighestConfidenceChord(pitches, allchords);\n}\n","import * as log from \"../dev/log\";\nimport Matrix from \"./dataStructures/Matrix\";\nimport HalfMatrix from \"./dataStructures/HalfMatrix\";\n\nexport function generate1DgaussianKernel(size, sigma = size / 2) {\n    const kernel = new Float32Array(size);\n    const meanIndex = (size - 1) / 2;\n    let sum = 0; // For accumulating the kernel values\n    for (let x = 0; x < size; x++) {\n        kernel[x] = Math.exp(-0.5 * Math.pow((x - meanIndex) / sigma, 2.0));\n        // Accumulate the kernel values\n        sum += kernel[x];\n    }\n\n    // Normalize the kernel\n    for (let x = 0; x < size; x++) {\n        kernel[x] /= sum;\n    }\n    return kernel;\n}\n\nexport function generate1DlinearKernel(size) {\n    const kernel = new Float32Array(size);\n    const meanIndex = (size - 1) / 2;\n    let sum = 0; // For accumulating the kernel values\n    for (let x = 0; x < size; x++) {\n        kernel[x] = 1 - Math.abs((x - meanIndex) / (size / 2));\n        // Accumulate the kernel values\n        sum += kernel[x];\n    }\n\n    // Normalize the kernel\n    for (let x = 0; x < size; x++) {\n        kernel[x] /= sum;\n    }\n    return kernel;\n}\n\nexport function linearBlur2DOptimized(matrix, size) {\n    log.debug(\"Performing 2D linear\", size);\n    const matrixSize = matrix.getSize();\n    const fullKernelSize = size * 2 + 1;\n    const kernel1D = generate1DlinearKernel(fullKernelSize);\n    const blurredMatrix = Matrix.from(matrix);\n\n    // Smear horizontal\n    blurredMatrix.fill((x, y) => {\n        let sum = 0;\n        for (let kx = -size; kx <= size; kx++) {\n            if (x + kx >= 0 && x + kx < matrixSize) {\n                sum += matrix.getValueMirrored(x + kx, y) * kernel1D[kx + size];\n            } else if (x + kx < 0) {\n                sum += matrix.getValueMirrored(0, y) * kernel1D[kx + size];\n            } else if (x + kx >= matrixSize) {\n                sum += matrix.getValueMirrored(matrixSize - 1, y) * kernel1D[kx + size];\n            }\n        }\n        return sum;\n    });\n    const blurredMatrixSecondPass = Matrix.from(matrix);\n\n    // Smear vertical\n    blurredMatrixSecondPass.fill((x, y) => {\n        let sum = 0;\n        for (let ky = -size; ky <= size; ky++) {\n            if (y + ky >= 0 && y + ky < matrixSize) {\n                sum += blurredMatrix.getValueMirrored(x, y + ky) * kernel1D[ky + size];\n            } else if (y + ky < 0) {\n                sum += blurredMatrix.getValueMirrored(x, 0) * kernel1D[ky + size];\n            } else if (y + ky >= matrixSize) {\n                sum += blurredMatrix.getValueMirrored(x, matrixSize - 1) * kernel1D[ky + size];\n            }\n        }\n        return sum;\n    });\n    return blurredMatrixSecondPass;\n}\n\nexport function gaussianBlur2DOptimized(matrix, size) {\n    const matrixSize = matrix.getSize();\n    const fullKernelSize = size * 2 + 1;\n    const kernel1D = generate1DgaussianKernel(fullKernelSize, size / 2);\n    const blurredMatrix = Matrix.from(matrix);\n\n    // Smear horizontal\n    blurredMatrix.fill((x, y) => {\n        let sum = 0;\n        for (let kx = -size; kx <= size; kx++) {\n            if (x + kx >= 0 && x + kx < matrixSize) {\n                sum += matrix.getValueMirrored(x + kx, y) * kernel1D[kx + size];\n            } else if (x + kx < 0) {\n                sum += matrix.getValueMirrored(0, y) * kernel1D[kx + size];\n            } else if (x + kx >= matrixSize) {\n                sum += matrix.getValueMirrored(matrixSize - 1, y) * kernel1D[kx + size];\n            }\n        }\n\n        return sum;\n    });\n    const blurredMatrixSecondPass = Matrix.from(matrix);\n\n    // Smear vertical\n    blurredMatrixSecondPass.fill((x, y) => {\n        let sum = 0;\n        for (let ky = -size; ky <= size; ky++) {\n            if (y + ky >= 0 && y + ky < matrixSize) {\n                sum += blurredMatrix.getValueMirrored(x, y + ky) * kernel1D[ky + size];\n            } else if (y + ky < 0) {\n                sum += blurredMatrix.getValueMirrored(x, 0) * kernel1D[ky + size];\n            } else if (y + ky >= matrixSize) {\n                sum += blurredMatrix.getValueMirrored(x, matrixSize - 1) * kernel1D[ky + size];\n            }\n        }\n        return sum;\n    });\n    return blurredMatrixSecondPass;\n}\nexport function gaussianBlurFeatures(features, size) {\n    const blurredFeatures = [];\n    const fullKernelSize = size * 2 + 1;\n    const kernel = generate1DgaussianKernel(fullKernelSize, size / 2);\n    const featureAmount = features[0].length;\n\n    for (let i = 0; i < features.length; i++) {\n        const newVector = new Float32Array(featureAmount);\n        for (let f = 0; f < featureAmount; f++) {\n            let sum = 0;\n            let kernelSum = 0;\n            for (let k = -size; k <= size; k++) {\n                if (i + k >= 0 && i + k < features.length) {\n                    sum += features[i + k][f] * kernel[k + size];\n                    kernelSum += kernel[k + size];\n                }\n            }\n            newVector[f] = sum / kernelSum;\n        }\n        blurredFeatures.push(newVector);\n    }\n\n    return blurredFeatures;\n}\n\nexport function medianFilterFeatures(features, size) {\n    const resolution = 256;\n    const buckets = new Float32Array(resolution);\n\n    const filteredFeatures = [];\n    const featureAmount = features[0].length;\n\n    for (let i = 0; i < features.length; i++) {\n        const newVector = new Float32Array(featureAmount);\n        for (let f = 0; f < featureAmount; f++) {\n            let totalValues = 0;\n            for (let k = -size; k <= size; k++) {\n                if (i + k >= 0 && i + k < features.length) {\n                    const val = features[i + k][f];\n                    const valNormalized = val * 0.5 + 0.5;\n                    buckets[Math.floor(valNormalized * (resolution - 1))]++;\n                    totalValues++;\n                }\n            }\n            let middle = totalValues / 2;\n            //Both check middle and clear buckets\n            let median = -1;\n            for (let i = 0; i < resolution; i++) {\n                middle -= buckets[i];\n                if (middle < 0 && median === -1) {\n                    median = i / (resolution - 1);\n                }\n                buckets[i] = 0;\n            }\n            newVector[f] = 2 * (median - 0.5);\n        }\n        filteredFeatures.push(newVector);\n    }\n    return filteredFeatures;\n}\n\nexport function splitGaussianBlurFeatures(features, size, offset = 0) {\n    const leftBlur = [];\n    const rightBlur = [];\n\n    const fullKernelSize = size * 2 + 1;\n    const kernel = generate1DgaussianKernel(fullKernelSize, size / 2);\n    const featureAmount = features[0].length;\n\n    for (let i = 0; i < features.length; i++) {\n        const newTimbreLeft = new Float32Array(featureAmount);\n        const newTimbreRight = new Float32Array(featureAmount);\n\n        for (let f = 0; f < featureAmount; f++) {\n            let leftSum = 0;\n            let leftKernelSum = 0;\n            let rightSum = 0;\n            let rightKernelSum = 0;\n\n            // Left\n            for (let k = -size - offset; k <= -1 - offset; k++) {\n                if (i + k >= 0 && i + k < features.length) {\n                    leftSum += features[i + k][f] * kernel[k + size + offset];\n                    leftKernelSum += kernel[k + size + offset];\n                }\n            }\n            // Right\n            for (let k = 1 + offset; k <= size + offset; k++) {\n                if (i + k >= 0 && i + k < features.length) {\n                    rightSum += features[i + k][f] * kernel[k + size - offset];\n                    rightKernelSum += kernel[k + size - offset];\n                }\n            }\n            newTimbreLeft[f] = leftSum / leftKernelSum;\n            newTimbreRight[f] = rightSum / rightKernelSum;\n        }\n        if (i <= offset) {\n            leftBlur.push(features[i]);\n        } else {\n            leftBlur.push(newTimbreLeft);\n        }\n        if (i >= features.length - 1 - offset) {\n            rightBlur.push(features[i]);\n        } else {\n            rightBlur.push(newTimbreRight);\n        }\n    }\n    return [leftBlur, rightBlur];\n}\n\nexport function gaussianBlur1D(array, size, edgeStrategy = \"zeropad\") {\n    const fullKernelSize = size * 2 + 1;\n    const kernel = generate1DgaussianKernel(fullKernelSize, size / 2);\n    const blurredArray = new Float32Array(array.length);\n\n    for (let i = 0; i < array.length; i++) {\n        let sum = 0;\n        for (let k = -size; k <= size; k++) {\n            if (i + k >= 0 && i + k < array.length) {\n                sum += array[i + k] * kernel[k + size];\n            } else {\n                switch (edgeStrategy) {\n                    case \"zeropad\":\n                        break;\n                    case \"mirror\":\n                        if (i - k >= 0 && i - k < array.length) {\n                            sum += array[i - k] * kernel[k + size];\n                        }\n                        break;\n                }\n            }\n        }\n        blurredArray[i] = sum;\n    }\n\n    return blurredArray;\n}\n\nexport function createFades(feature, padding) {\n    for (let i = 0; i < feature.length; i++) {\n        if (i < padding) {\n            feature[i] *= i / padding;\n        }\n        if (i >= feature.length - padding) {\n            feature[i] *= (feature.length - 1 - i) / padding;\n        }\n    }\n    return feature;\n}\n\nexport function maxFrequencyFilter(feature, resolution, size) {\n    const buckets = new Int32Array(resolution);\n\n    const blurredFeature = [];\n\n    feature.forEach((val, i) => {\n        for (let o = -size; o <= size; o++) {\n            if (i + o >= 0 && i + o < feature.length) {\n                buckets[feature[i + o]]++;\n            }\n        }\n\n        let maxFrequency = -1;\n        let maxValue = -1;\n        for (let i = 0; i < resolution; i++) {\n            if (buckets[i] > maxFrequency) {\n                maxFrequency = buckets[i];\n                maxValue = i;\n            }\n            buckets[i] = 0;\n        }\n        blurredFeature.push(maxValue);\n    });\n\n    return blurredFeature;\n}\n\nexport function median2D(matrix, resolution, width, height) {\n    const buckets = new Float32Array(resolution);\n\n    const w = Math.floor((width - 1) / 2);\n    const h = Math.floor((height - 1) / 2);\n\n    const filteredMatrix = Matrix.from(matrix, { numberType: Matrix.NumberType.FLOAT32 });\n\n    filteredMatrix.fill((x, y) => {\n        let totalValues = 0;\n        for (let xOffset = -w; xOffset <= w; xOffset++) {\n            for (let yOffset = -h; yOffset <= h; yOffset++) {\n                if (matrix.hasCell(x + xOffset, y + yOffset)) {\n                    const value = matrix.getValueNormalized(x + xOffset, y + yOffset);\n                    buckets[Math.floor(value * (resolution - 1))]++;\n                    totalValues++;\n                }\n            }\n        }\n        let middle = totalValues / 2;\n\n        //Both check middle and clear buckets\n        let mean = -1;\n        for (let i = 0; i < resolution; i++) {\n            middle -= buckets[i];\n            if (middle < 0 && mean === -1) {\n                mean = i / (resolution - 1);\n            }\n            buckets[i] = 0;\n        }\n        return mean;\n    });\n\n    return filteredMatrix;\n}\n","import * as filter from \"./filter\";\nimport Matrix from \"./dataStructures/Matrix\";\nimport assert from \"assert\";\nimport * as similarity from \"./similarity\";\nimport * as log from \"../dev/log\";\n\n/**\n * Convolve checkerboard kernel along main diagonal\n * @param {*} ssm half matrix\n */\nexport function detect(ssm, size) {\n    const kernel = createKernel(size);\n    const halfSize = Math.floor(size / 2);\n    const ssmSize = ssm.size || ssm.width;\n    const novelty = new Float32Array(ssmSize);\n    for (let i = 0; i < ssmSize; i++) {\n        let kernelSum = 0;\n        let cell = 0;\n        for (let y = 0; y < size; y++) {\n            for (let x = 0; x <= y; x++) {\n                const ssmX = i - (size - halfSize) + x;\n                const ssmY = i - (size - halfSize + 1) + y;\n                if (ssmX >= 0 && ssmX < ssmSize && ssmY >= 0 && ssmY < ssmSize) {\n                    kernelSum += ssm.getValueNormalizedMirrored(ssmX, ssmY) * kernel[cell];\n                }\n                cell++;\n            }\n        }\n        novelty[i] = kernelSum;\n    }\n    return novelty;\n}\n\nexport function createKernel(size) {\n    const kernelSize = (size * size + size) / 2;\n    const kernel = new Float32Array(kernelSize).fill(0); // Don't need the diagonal itself\n    /**   \n     *     subsize is the filled in size\n     */\n    const subSize = size / 2;\n    const taper = 2 / size;\n\n    let cell = 0;\n    let sum = 0;\n    for (let y = 0; y < size; y++) {\n        for (let x = 0; x <= y; x++) {\n            let sign;\n            if (y >= subSize && x < size - subSize) {\n                sign = -1;\n            } else {\n                sign = 1;\n            }\n            const gauss = Math.exp(\n                -Math.pow(taper, 2) * (Math.pow(x - (size - subSize) + 0.5, 2) + Math.pow(y - subSize + 0.5, 2))\n            );\n            kernel[cell] = sign * gauss;\n            sum += Math.abs(kernel[cell]);\n            cell++;\n        }\n    }\n    for (let i = 0; i < kernelSize; i++) {\n        kernel[i] /= sum;\n    }\n\n    return kernel;\n}\n\nexport function computeNoveltyFromTimeLag(timeLagMatrix) {\n    return absoluteEuclideanColumnDerivative(timeLagMatrix);\n}\n\n// Detects amount of change in ssm for column n and column n+1\nexport function absoluteEuclideanColumnDerivative(ssm) {\n    const ssmSize = ssm.size || ssm.width;\n    const novelty = new Float32Array(ssmSize);\n    // sqrt of all distances\n    for (let x = 0; x < ssmSize; x++) {\n        let differenceSum = 0;\n        for (let y = 0; y < ssmSize; y++) {\n            const currentValue = ssm.getValueNormalizedMirrored(x, y);\n            if (x < ssmSize - 1) {\n                const nextValue = ssm.getValueNormalizedMirrored(x + 1, y);\n                const difference = nextValue - currentValue;\n                differenceSum += difference * difference;\n            } else {\n                differenceSum = novelty[x - 1] * novelty[x - 1]; // Last value just repeats the second to last\n            }\n        }\n        novelty[x] = Math.sqrt(differenceSum);\n    }\n    return novelty;\n}\n\nexport function featureDerivative(features) {\n    const derivative = new Float32Array(features.length);\n    const zeroFeature = Array(features[0].length).fill(0);\n    derivative[0] = 1 - similarity.euclidianTimbre(features[0], features[1]);\n    for (let i = 1; i < features.length; i++) {\n        derivative[i] = 1 - similarity.euclidianTimbre(features[i - 1], features[i]);\n    }\n    return derivative;\n}\n\n// Basically sums / averages in the direction of paths\nexport function computePriorLag(timeLagMatrix, fades = 0) {\n    const ssmSize = timeLagMatrix.size || timeLagMatrix.width;\n    const novelty = new Float32Array(ssmSize);\n    for (let y = 0; y < ssmSize; y++) {\n        for (let x = 0; x < ssmSize; x++) {\n            novelty[y] += timeLagMatrix.getValueNormalizedMirrored(x, y);\n        }\n        novelty[y] /= ssmSize;\n    }\n    const fadedNovelty = filter.createFades(novelty, fades);\n    return fadedNovelty;\n}\n\n// Basically sums / averages in the direction of paths\nexport function computePriorLagHalf(timeLagMatrix, fades = 0) {\n    const ssmSize = timeLagMatrix.size || timeLagMatrix.width;\n    const novelty = new Float32Array(ssmSize);\n    for (let y = 0; y < ssmSize; y++) {\n        for (let x = 0; x < ssmSize - y; x++) {\n            novelty[y] += timeLagMatrix.getValueNormalizedMirrored(x, y);\n        }\n        novelty[y] /= ssmSize - y;\n    }\n    const fadedNovelty = filter.createFades(novelty, fades);\n    return fadedNovelty;\n}\n\nexport function findLocalMaxima(novelty, threshold = 0) {\n    const max = Math.max.apply(Math, novelty);\n    const maximaIndexes = [0];\n    for (let i = 1; i < novelty.length - 1; i++) {\n        const val = novelty[i];\n        // prefers first index if maxima spans multiple samples\n        if (novelty[i - 1] < val && val >= novelty[i + 1] && val > threshold * max) {\n            maximaIndexes.push(i);\n        }\n    }\n    return maximaIndexes;\n}\n\nexport function findPeaks(novelty) {\n    const peaks = [];\n    peaks.push({ sample: 0, height: 0, confidence: 1 });\n    const max = Math.max.apply(Math, novelty);\n\n    const maxima = [];\n    const minima = [];\n\n    for (let i = 1; i < novelty.length - 1; i++) {\n        const val = novelty[i];\n        // prefers first index if maxima spans multiple samples\n        if (novelty[i - 1] < val && val >= novelty[i + 1]) {\n            maxima.push({ sample: i, height: val });\n        }\n        if (novelty[i - 1] > val && val <= novelty[i + 1]) {\n            minima.push({ sample: i, height: val });\n        }\n    }\n\n    for (let i = 0; i < maxima.length; i++) {\n        const maxi = maxima[i];\n        const leftMinima = i === 0 ? { sample: 0, height: 0 } : minima[i - 1];\n        const rightMinima = i >= minima.length ? { sample: novelty.length - 1, height: 0 } : minima[i];\n        let smallestMinima;\n        if (leftMinima.height < rightMinima.height) {\n            smallestMinima = leftMinima;\n        } else {\n            smallestMinima = rightMinima;\n        }\n        assert(smallestMinima, \"No minima assigned as smallest\");\n        const maxPeakHeightDiff = maxi.height - smallestMinima.height;\n        const confidence = maxPeakHeightDiff / max;\n        peaks.push({ sample: maxi.sample, height: maxi.height, confidence });\n    }\n    return peaks;\n}\n\nexport function columnDensity(matrix) {\n    const ssmSize = matrix.size || matrix.width;\n    const novelty = new Float32Array(ssmSize);\n    for (let i = 0; i < ssmSize; i++) {\n        novelty[i] = 0;\n        for (let j = 0; j < ssmSize; j++) {\n            novelty[i] += matrix.getValueNormalizedMirrored(i, j);\n        }\n        novelty[i] /= ssmSize;\n    }\n    return novelty;\n}\n\nexport function normalizeByColumnDensity(matrix) {\n    const ssmSize = matrix.size || matrix.width;\n    const density = columnDensity(matrix);\n    const normalizedMatrix = Matrix.from(matrix, { numberType: Matrix.NumberType.FLOAT32 });\n    let max = 0;\n    normalizedMatrix.fill((x, y) => {\n        let colDensity = density[x];\n        if (colDensity === 0) {\n            colDensity = 1 / ssmSize;\n        }\n        const val = matrix.getValueNormalizedMirrored(x, y) / (ssmSize * colDensity);\n        if (val > max) max = val;\n        return val;\n    });\n    normalizedMatrix.divide(max);\n\n    return normalizedMatrix;\n}\n","export function computeFitness(pathFamily, pathScores, score, sampleAmount, width) {\n    const pathAmount = pathFamily.length;\n    const error = 1e-16;\n\n    // normalized score\n    // we subtract the given self similarity path, and divide by total length of all paths (+ error to prevent divide by 0)\n    let pathFamilyLength = 0;\n    for (let p = 0; p < pathAmount; p++) {\n        pathFamilyLength += pathFamily[p].length / 2; // /2 because we store x and y flat\n    }\n    const normalizedScore = Math.max(0, (score - width) / (pathFamilyLength + error));\n\n    // normalized coverage\n    const coverage = computeInducedCoverage(pathFamily);\n    const normalizedCoverage = (coverage - width) / (sampleAmount + error);\n\n    // fitness\n    let fitness = (2 * normalizedScore * normalizedCoverage) / (normalizedScore + normalizedCoverage + error);\n\n    return { fitness, normalizedScore, coverage, normalizedCoverage, pathFamilyLength, prunedPathFamily: pathFamily };\n}\n\nexport function computeCustomFitness(pathFamily, pathScores, score, sampleAmount, width) {\n    const pathAmount = pathFamily.length;\n    const error = 1e-16;\n    const normalizedPathAmount = pathAmount - 1;\n\n    // normalized score\n    // we subtract the given self similarity path, and divide by total length of all paths (+ error to prevent divide by 0)\n    let pathFamilyLength = 0;\n    for (let p = 0; p < pathAmount; p++) {\n        pathFamilyLength += pathFamily[p].length / 2; // /2 because we store x and y flat\n    }\n    const normalizedScore = Math.max(0, (score - width) / (pathFamilyLength + error));\n\n    // normalized coverage\n    const coverage = computeInducedCoverage(pathFamily);\n    let normalizedCoverage = (coverage - width) / (sampleAmount + error);\n\n    // fitness\n    let fitness = (2 * normalizedScore * normalizedCoverage) / (normalizedScore + normalizedCoverage + error);\n    //fitness = (3 * normalizedScore * normalizedCoverage* normalizedPathAmount )/ (normalizedScore * normalizedCoverage + normalizedCoverage * normalizedPathAmount + normalizedPathAmount * normalizedScore);\n    fitness *= normalizedPathAmount;\n\n    return { fitness, normalizedScore, coverage, normalizedCoverage, pathFamilyLength, prunedPathFamily: pathFamily };\n}\n\nexport function computeFineFitness(pathFamily, pathScores, score, sampleAmount, width) {\n    const pathAmount = pathFamily.length;\n    const error = 1e-16;\n    const normalizedPathAmount = pathAmount - 1;\n\n    // normalized score\n    // we subtract the given self similarity path, and divide by total length of all paths (+ error to prevent divide by 0)\n    let pathFamilyLength = 0;\n    for (let p = 0; p < pathAmount; p++) {\n        pathFamilyLength += pathFamily[p].length / 2; // /2 because we store x and y flat\n    }\n    const normalizedScore = Math.max(0, (score - width) / (pathFamilyLength + error));\n\n    // normalized coverage\n    const coverage = computeInducedCoverage(pathFamily);\n    let normalizedCoverage = (coverage - width) / (sampleAmount + error);\n\n    // fitness\n    //let fitness = (2 * normalizedScore * pathAmount) / (normalizedScore + pathAmount + error);\n    let fitness =\n        (3 * normalizedScore * normalizedCoverage * pathAmount) /\n        (normalizedScore * normalizedCoverage + normalizedCoverage * pathAmount + pathAmount * normalizedScore);\n\n    return { fitness, normalizedScore, coverage, normalizedCoverage, pathFamilyLength, prunedPathFamily: pathFamily };\n}\n\nexport function computeCustomPrunedFitness(pathFamily, pathScores, score, sampleAmount, width) {\n    const [prunedPathFamily, prunedPathScores, totalScore] = prunePathFamily(pathFamily, pathScores, width, 0.25, 0.05);\n    pathFamily = prunedPathFamily;\n    pathScores = prunedPathScores;\n    score = totalScore;\n    const error = 1e-16;\n\n    // normalize pathAmount\n    const pathAmount = pathFamily.length;\n    const normalizedPathAmount = pathAmount - 1;\n\n    // normalized score\n    // we subtract the given self similarity path, and divide by total length of all paths (+ error to prevent divide by 0)\n    let pathFamilyLength = 0;\n    for (let p = 0; p < pathAmount; p++) {\n        pathFamilyLength += pathFamily[p].length / 2; // /2 because we store x and y flat\n    }\n    const normalizedScore = Math.max(0, (score - width) / (pathFamilyLength + error));\n\n    // normalized coverage\n    const coverage = computeInducedCoverage(pathFamily);\n    let normalizedCoverage = (coverage - width) / (sampleAmount + error);\n    //normalizedCoverage *= (normalizedPathAmount);\n\n    // fitness\n    let fitness = (2 * normalizedScore * normalizedCoverage) / (normalizedScore + normalizedCoverage + error);\n    fitness *= Math.log(normalizedPathAmount);\n    //fitness =  Math.sqrt(normalizedPathAmount*normalizedScore*normalizedCoverage);\n    //fitness = normalizedPathAmount*normalizedCoverage*normalizedScore;\n\n    return { fitness, normalizedScore, coverage, normalizedCoverage, pathFamilyLength, prunedPathFamily: pathFamily };\n}\n\nexport function computePrunedFitness(pathFamily, pathScores, score, sampleAmount, width) {\n    const [prunedPathFamily, prunedPathScores, totalScore] = prunePathFamily(pathFamily, pathScores, width, 0.5, 0.4);\n    pathFamily = prunedPathFamily;\n    pathScores = prunedPathScores;\n    score = totalScore;\n\n    const pathAmount = pathFamily.length;\n    const error = 1e-16;\n\n    // normalized score\n    // we subtract the given self similarity path, and divide by total length of all paths (+ error to prevent divide by 0)\n    let pathFamilyLength = width * pathAmount;\n    const normalizedScore = Math.max(0, (score - width) / (pathFamilyLength + error));\n\n    // normalized coverage\n    const coverage = computeInducedCoverage(pathFamily, pathScores);\n    const normalizedCoverage = (coverage - width) / (sampleAmount + error);\n    const normalizedNonInducedCoverage = (pathFamilyLength - width) / (sampleAmount + error);\n\n    // fitness\n    let fitness =\n        (2 * normalizedScore * normalizedNonInducedCoverage) / (normalizedScore + normalizedNonInducedCoverage + error);\n\n    //fitness = (2 * normalizedScore * pathFamilyLength) / (normalizedScore + pathFamilyLength + error);\n\n    return {\n        fitness,\n        normalizedScore,\n        coverage,\n        normalizedCoverage,\n        pathFamilyLength,\n        prunedPathFamily,\n        prunedPathScores,\n    };\n}\n\nexport function computeInducedCoverage(pathFamily) {\n    const pathAmount = pathFamily.length;\n    let coverage = 0;\n    if (pathAmount > 0) {\n        for (let p = 0; p < pathAmount; p++) {\n            // paths stored in reverse due to backtracking\n            const pathEndY = pathFamily[p][1];\n            const pathStartY = pathFamily[p][pathFamily[p].length - 1];\n            coverage += Math.abs(pathEndY - pathStartY);\n        }\n    }\n\n    return coverage;\n}\n\nexport function prunePathFamily(pathFamily, pathScores, width, smallestRatio = 0.3, smallestScore = 0.3) {\n    const totalScore = pathScores.reduce((a, b) => a + b, 0);\n    const normalizedTotalScore = totalScore - width;\n    const pathLength = pathFamily.length;\n    const averageScore = normalizedTotalScore / (pathLength - 1);\n    let bestScore = 0;\n    let secondBestScore = 0;\n    pathScores.forEach((score) => {\n        if (score > bestScore) {\n            bestScore = score;\n        }\n    });\n    pathScores.forEach((score) => {\n        if (score > secondBestScore && score < bestScore) {\n            secondBestScore = score;\n        }\n    });\n\n    const prunedPathFamily = [];\n    const prunedPathScores = [];\n    for (let p = 0; p < pathLength; p++) {\n        const path = pathFamily[p];\n        const score = pathScores[p];\n        if (score > smallestRatio * secondBestScore && score / width > smallestScore) {\n            prunedPathFamily.push(path);\n            prunedPathScores.push(score);\n        }\n    }\n    return [prunedPathFamily, prunedPathScores, totalScore];\n}\n","import * as log from \"../dev/log\";\nimport Matrix from \"./dataStructures/Matrix\";\nimport HalfMatrix from \"./dataStructures/HalfMatrix\";\nimport * as familyFitness from \"./familyFitness\";\n\nexport function createScoreMatrixBuffer(sampleAmount) {\n    return new Float32Array(sampleAmount * sampleAmount).fill(Number.NEGATIVE_INFINITY);\n}\n\nexport function extractPathFamily(ssm, start, end) {\n    const { D, width, height, score } = computeAccumulatedScoreMatrix(ssm, start, end, D);\n    const pathFamily = computeOptimalPathFamily(D, width, height);\n    //const pathScores = getScoresForPathFamily(D, width, pathFamily);\n    const pathScores = getBrightnessForPathFamily(ssm, pathFamily, start);\n\n    return [pathFamily, pathScores, score, width];\n}\n\n// The ratio between the length of the knight move vs length of a diagonal move\nconst knightMoveRatio = 1; //Math.sqrt(10) / 2 + .01 ; // plus slight offset to favour diagonal moves when going through penalties\nconst knightMoveTweak = 1; //0.99; //Also favouring diagonal moves when accumulating score\nexport function computeAccumulatedScoreMatrix(ssm, start, end, D) {\n    const sampleAmount = ssm.getSampleAmount();\n    if (start < 0) log.error(\"start below 0: \", start);\n    if (end > sampleAmount) log.error(\"end above sampleAmount: \", sampleAmount, \"end\", end);\n\n    const length = end - start;\n\n    const width = length + 1;\n    const height = sampleAmount;\n    // accumulatedScoreMatrix length + 1 for elevator\n    if (!D) {\n        D = new Float32Array(height * width).fill(Number.NEGATIVE_INFINITY);\n    }\n\n    const penalty = -2;\n    const penalize = (value) => {\n        return value <= 0 ? penalty : value; //(value-thresh)*(1/(1-thresh));\n        //return value < thresh ?  (thresh-value)*(1/thresh)*penalty : (value-thresh)*(1/thresh);\n        /*if(value <= 0.5){\n             return penalty;\n        }else if(value < thresh){\n            return  (-thresh+value);\n        }else{\n            return (value - thresh);\n        }*/\n    };\n\n    D[0] = 0;\n    D[1] = penalize(ssm.getValueNormalized(start, 0));\n\n    for (let y = 1; y < height; y++) {\n        D[y * width + 0] = Math.max(D[(y - 1) * width + 0], D[(y - 1) * width + width - 1]);\n        D[y * width + 1] = D[y * width + 0] + penalize(ssm.getValueNormalized(start, y));\n        for (let x = 2; x < width; x++) {\n            let down;\n            if (y === 1) {\n                down = Number.NEGATIVE_INFINITY;\n            } else {\n                down = D[(y - 2) * width + x - 1];\n            }\n            if (down < 0) {\n                down *= knightMoveRatio;\n            } else {\n                down *= knightMoveTweak;\n            }\n            let right = D[(y - 1) * width + x - 2]; //|| Number.NEGATIVE_INFINITY; // in case undefined\n            if (right < 0) {\n                right *= knightMoveRatio;\n            } else {\n                right *= knightMoveTweak;\n            }\n            const diag = D[(y - 1) * width + x - 1]; //|| Number.NEGATIVE_INFINITY; // in case undefined\n\n            D[y * width + x] = penalize(ssm.getValueNormalized(start + x - 1, y)) + Math.max(diag, right, down);\n        }\n    }\n\n    const score = Math.max(D[(height - 1) * width + 0], D[(height - 1) * width + width - 1]);\n\n    return { D, width, height, score };\n}\n\nexport function computeOptimalPathFamily(D, width, height) {\n    const pathFamily = [];\n    let path = [];\n\n    let y = height - 1;\n    let x;\n    if (D[y * width + width - 1] < D[y * width + 0]) {\n        x = 0;\n    } else {\n        x = width - 1;\n        path.push(x - 1, y);\n    }\n\n    // Declaring globally for improved running time\n    let predecessors = new Uint16Array(6);\n    let predecessorLength = 0; // in pairs, so max would be 3\n\n    while (y > 0 || x > 0) {\n        // obtaining the set of possible predecesors given our current position\n        predecessors[0] = y - 1;\n        predecessors[1] = x - 1;\n        if (y <= 2 && x <= 2) {\n            predecessorLength = 1;\n        } else if (y <= 2 && x > 2) {\n            predecessors[2] = y - 1;\n            predecessors[3] = x - 2;\n            predecessorLength = 2;\n        } else if (y > 2 && x <= 2) {\n            predecessors[2] = y - 2;\n            predecessors[3] = x - 1;\n            predecessorLength = 2;\n        } else {\n            predecessors[2] = y - 2;\n            predecessors[3] = x - 1;\n            predecessors[4] = y - 1;\n            predecessors[5] = x - 2;\n            predecessorLength = 3;\n        }\n\n        if (y === 0) {\n            // case for the first row, only horizontal movements are allowed\n            x--;\n        } else if (x === 0) {\n            // case for the elevator column: we can keep going down the column or jumping to the end of the next row\n            if (D[(y - 1) * width + width - 1] > D[(y - 1) * width + 0]) {\n                y--;\n                x = width - 1;\n                if (path.length > 0) {\n                    pathFamily.push(path);\n                }\n                path = [x - 1, y];\n            } else {\n                y--;\n                x = 0;\n            }\n        } else if (x === 1) {\n            // case for x=1, only horizontal steps to the elevator column are allowed\n            x = 0;\n        } else {\n            // regular case, obtain best of predecessors\n            let max = Number.NEGATIVE_INFINITY;\n            for (let i = 0; i < predecessorLength; i++) {\n                let val = D[predecessors[i * 2 + 0] * width + predecessors[i * 2 + 1]]; // value in D of predecessor\n                if (val > max) {\n                    max = val;\n                    y = predecessors[i * 2 + 0];\n                    x = predecessors[i * 2 + 1];\n                }\n            }\n            path.push(x - 1, y);\n        }\n    }\n    // add last path to family\n    pathFamily.push(path);\n    return pathFamily;\n}\n\nexport function getScoresForPathFamily(scoreMatrix, width, pathFamily) {\n    let pathScores = [];\n    pathFamily.forEach((path) => {\n        const endX = path[0];\n        const endY = path[0 + 1];\n        const endValue = scoreMatrix[endY * width + endX];\n        const startX = path[path.length - 2];\n        const startY = path[path.length - 2 + 1];\n        const startValue = scoreMatrix[startY * width + startX];\n        const pathScore = endValue - startValue;\n\n        pathScores.push(pathScore / width);\n    });\n    return pathScores;\n}\n\nlet deb = 0;\nexport function getBrightnessForPathFamily(pathSSM, pathFamily, start) {\n    deb++;\n    let pathScores = [];\n    pathFamily.forEach((path) => {\n        let sum = 0;\n        for (let i = 0; i < path.length; i += 2) {\n            const x = start + path[i + 0];\n            const y = path[i + 1];\n            const val = pathSSM.getValueNormalized(x, y);\n            sum += val;\n        }\n        const average = sum / (path.length / 2);\n        pathScores.push(average);\n    });\n    return pathScores;\n}\n\nexport function getInducedSegments(pathFamily) {\n    const pathAmount = pathFamily.length;\n    const inducedSegments = new Uint16Array(pathAmount * 2);\n\n    if (pathAmount > 0) {\n        for (let p = 0; p < pathAmount; p++) {\n            // paths stored in reverse due to backtracking\n            const pathEndY = pathFamily[p][1];\n            const pathStartY = pathFamily[p][pathFamily[p].length - 1];\n            inducedSegments[p * 2] = pathStartY;\n            inducedSegments[p * 2 + 1] = pathEndY;\n        }\n    }\n\n    return inducedSegments;\n}\n\nexport function visualizationMatrix(ssm, sampleAmount, start, end) {\n    const scoreMatrixBuffer = createScoreMatrixBuffer(sampleAmount);\n    const { D, width, height, score } = computeAccumulatedScoreMatrix(ssm, start, end, scoreMatrixBuffer);\n    const P = computeOptimalPathFamily(D, width, height);\n    const PScores = getScoresForPathFamily(D, width, P);\n    const { fitness, normalizedScore, coverage, normalizedCoverage, pathFamilyLength } = familyFitness.computeFitness(\n        P,\n        PScores,\n        score,\n        sampleAmount,\n        width\n    );\n\n    let maxVal = Number.NEGATIVE_INFINITY;\n    let minVal = Number.POSITIVE_INFINITY;\n    const sizeD = width * height;\n    for (let i = 0; i < sizeD; i++) {\n        if (D[i] > maxVal) {\n            maxVal = D[i];\n        }\n\n        if (i % width === 0 && D[i] !== Number.NEGATIVE_INFINITY && D[i] < minVal) {\n            minVal = D[i];\n        }\n    }\n    minVal = 0;\n\n    const length = end - start + 1;\n    const visualizationMatrix = new Matrix({\n        width: sampleAmount,\n        height: sampleAmount,\n        numberType: Matrix.NumberType.UINT8,\n    });\n\n    visualizationMatrix.fill((x, y) => {\n        if (x >= length * 3 && x < length * 4) {\n            return ssm.getValue(start + x - length * 3, y);\n        } else if (x >= length * 2) {\n            return 0; // Paths will be set from looping over paths\n        } else if (x >= length) {\n            return (Math.max(0, D[y * width + x - length] - minVal) / (maxVal - minVal)) * 255; // +1 to remove elevator, * 255 sinze value is\n        } else {\n            return ssm.getValue(start + x, y);\n        }\n    });\n\n    for (const path of P) {\n        for (let i = 0; i < path.length / 2; i++) {\n            const x = length * 2 + path[i * 2];\n            const y = path[i * 2 + 1];\n            visualizationMatrix.setValue(x, y, 255);\n            const x2 = length * 3 + path[i * 2];\n            visualizationMatrix.setValue(x2, y, 0);\n        }\n    }\n\n    return visualizationMatrix;\n}\n\nexport function getInducedSegmentsFromSampleRange(start, end, pathSSM) {\n    const { D, width, height, score } = computeAccumulatedScoreMatrix(pathSSM, start, end);\n    const pathFamily = computeOptimalPathFamily(D, width, height);\n    const inducedSegments = getInducedSegments(pathFamily);\n    return inducedSegments;\n}\n\nexport function getDistanceBetween(segmentA, segmentB, pathSSM) {\n    const startSampleA = Math.floor(segmentA.start / pathSSM.getSampleDuration());\n    const endSampleA = Math.floor(segmentA.end / pathSSM.getSampleDuration());\n\n    const startSampleB = Math.floor(segmentB.start / pathSSM.getSampleDuration());\n    const endSampleB = Math.floor(segmentB.end / pathSSM.getSampleDuration());\n\n    const inducedSegmentsA = getInducedSegmentsFromSampleRange(startSampleA, endSampleA, pathSSM);\n    const inducedSegmentsB = getInducedSegmentsFromSampleRange(startSampleB, endSampleB, pathSSM);\n\n    return segmentDistanceOverlap(inducedSegmentsA, inducedSegmentsB);\n}\n\nexport function segmentSimilarityDTW(segmentA, segmentB, ssm) {\n    const startSampleA = Math.floor(segmentA.start / ssm.getSampleDuration());\n    const endSampleA = Math.floor(segmentA.end / ssm.getSampleDuration());\n    const height = endSampleA - startSampleA + 1;\n\n    const startSampleB = Math.floor(segmentB.start / ssm.getSampleDuration());\n    const endSampleB = Math.floor(segmentB.end / ssm.getSampleDuration());\n    const width = endSampleB - startSampleB + 1;\n\n    const D = new Float32Array(height * width).fill(Number.NEGATIVE_INFINITY);\n\n    const penalty = 0;\n    const penalize = (value) => {\n        return value <= 0 ? penalty : value;\n    };\n\n    D[0] = penalize(ssm.getValueNormalized(startSampleA, startSampleB));\n\n    for (let y = 0; y < height; y++) {\n        for (let x = 0; x < width; x++) {\n            if (y === 0 && x === 0) continue;\n            let down = y - 2 >= 0 && x - 1 >= 0 ? D[(y - 2) * width + x - 1] : Number.NEGATIVE_INFINITY;\n            let right = y - 1 >= 0 && x - 2 >= 0 ? D[(y - 1) * width + x - 2] : Number.NEGATIVE_INFINITY;\n            let diag = y - 1 >= 0 && x - 1 >= 0 ? D[(y - 1) * width + x - 1] : Number.NEGATIVE_INFINITY;\n\n            D[y * width + x] =\n                penalize(ssm.getValueNormalized(startSampleB + x, startSampleA + y)) + Math.max(diag, right, down);\n        }\n    }\n\n    const score = D[D.length - 1];\n    if (score <= 0) return 0;\n\n    let x = width - 1;\n    let y = height - 1;\n    let pathLength = 1;\n    while (x > 0 || y > 0) {\n        let down = y - 2 >= 0 && x - 1 >= 0 ? D[(y - 2) * width + x - 1] : Number.NEGATIVE_INFINITY;\n        let right = y - 1 >= 0 && x - 2 >= 0 ? D[(y - 1) * width + x - 2] : Number.NEGATIVE_INFINITY;\n        let diag = y - 1 >= 0 && x - 1 >= 0 ? D[(y - 1) * width + x - 1] : Number.NEGATIVE_INFINITY;\n\n        if (x === 0) {\n            x--;\n        } else if (y === 0) {\n            y--;\n        } else if (down >= right && down >= diag) {\n            y -= 2;\n            x -= 1;\n        } else if (right >= down && right >= diag) {\n            y -= 1;\n            x -= 2;\n        } else if (diag >= down && diag >= right) {\n            y -= 1;\n            x -= 1;\n        }\n        pathLength++;\n    }\n    const similarity = score / pathLength;\n\n    return similarity;\n}\n\n/**\n * Similar if they are aproximately repetitions of each other (overlap)\n * @param inducedSegmentsA in the form of a flat Uint16Array with pairs of start and end position of segments\n */\nexport function segmentDistanceOverlap(inducedSegmentsA, inducedSegmentsB) {\n    let maxSimilarity = 0;\n    for (let a = 0; a < inducedSegmentsA.length; a += 2) {\n        for (let b = 0; b < inducedSegmentsB.length; b += 2) {\n            const startA = inducedSegmentsA[a];\n            const endA = inducedSegmentsA[a + 1];\n            const startB = inducedSegmentsB[b];\n            const endB = inducedSegmentsB[b + 1];\n\n            const disjoint = endA <= startB || endB <= startA;\n            if (disjoint) continue;\n\n            const smallestStart = Math.min(startA, startB);\n            const largestEnd = Math.max(endA, endB);\n            const union = largestEnd - smallestStart;\n\n            const smallestEnd = Math.min(endA, endB);\n            const largestStart = Math.max(startA, startB);\n            const overlap = smallestEnd - largestStart;\n            const similarity = overlap / union;\n\n            if (similarity > maxSimilarity) {\n                maxSimilarity = similarity;\n            }\n        }\n    }\n    return 1 - maxSimilarity;\n}\n\nlet logi = 0;\nexport function computeSegmentPathFamilyInfo(pathSSM, startInSamples, endInSamples, scoreMatrixBuffer, strategy) {\n    logi++;\n    const sampleAmount = pathSSM.getSampleAmount();\n    if (!scoreMatrixBuffer) {\n        scoreMatrixBuffer = createScoreMatrixBuffer(sampleAmount);\n    }\n    const [P, pathScores, score, width] = extractPathFamily(pathSSM, startInSamples, endInSamples, scoreMatrixBuffer);\n\n    const fitnessFunction = (strategy, P, pathScores, score, sampleAmount, width) => {\n        switch (strategy) {\n            case \"classic\":\n                return familyFitness.computeFitness(P, pathScores, score, sampleAmount, width);\n            case \"fine\":\n                return familyFitness.computeFineFitness(P, pathScores, score, sampleAmount, width);\n            case \"pruned\":\n                return familyFitness.computePrunedFitness(P, pathScores, score, sampleAmount, width);\n            case \"custom\":\n                return familyFitness.computeCustomFitness(P, pathScores, score, sampleAmount, width);\n            case \"customPruned\":\n                return familyFitness.computeCustomPrunedFitness(P, pathScores, score, sampleAmount, width);\n            default:\n                log.error(\"No fitness strategy given, falling back to classic\");\n                return familyFitness.computeFitness(P, pathScores, score, sampleAmount, width);\n        }\n    };\n\n    const {\n        fitness,\n        normalizedScore,\n        coverage,\n        normalizedCoverage,\n        pathFamilyLength,\n        prunedPathFamily,\n        prunedPathScores,\n    } = fitnessFunction(strategy, P, pathScores, score, sampleAmount, width);\n\n    const pathFamily = [];\n    prunedPathFamily.forEach((path) => {\n        const pathCoords = [];\n        for (let i = 0; i < path.length; i += 2) {\n            const x = startInSamples + path[i];\n            const y = path[i + 1];\n            pathCoords.push([x, y]);\n        }\n        pathFamily.push(pathCoords);\n    });\n\n    return {\n        score: score,\n        pathScores: pathScores,\n        normalizedScore: normalizedScore,\n        coverage: coverage,\n        normalizedCoverage: normalizedCoverage,\n        fitness: fitness,\n        pathFamily: pathFamily,\n    };\n}\n\nexport function simplePathDetect(pathSSM, threshold = 0.1) {\n    const size = pathSSM.getSize();\n    const paths = [];\n\n    for (let y = 0; y < size; y++) {\n        let path = [];\n        for (let i = 0; i + y < size; i++) {\n            const value = pathSSM.getValueNormalized(i, i + y);\n            if (value > threshold) {\n                path.push(i, i + y);\n            }\n        }\n    }\n}\n\nexport function getDistanceMatrix(segments, pathSSM, strategy, kappa = 0.7) {\n    const amount = segments.length;\n    const distanceMatrix = new HalfMatrix({ size: amount, numberType: HalfMatrix.NumberType.FLOAT32 });\n\n    const segmentInducedSegments = [];\n\n    segments.forEach((segment) => {\n        const sampleStart = Math.floor(segment.start / pathSSM.getSampleDuration());\n        const sampleEnd = Math.floor(segment.end / pathSSM.getSampleDuration());\n        const inducedSegments = getInducedSegmentsFromSampleRange(sampleStart, sampleEnd, pathSSM);\n        segmentInducedSegments.push(inducedSegments);\n    });\n    distanceMatrix.fill((x, y) => {\n        let dist = 0;\n        const sameGroup = segments[x].groupID === segments[y].groupID;\n        switch (strategy) {\n            case \"DTW\":\n                dist = (1 - segmentSimilarityDTW(segments[x], segments[y], pathSSM)) * (sameGroup ? kappa : 1);\n                //dist = Math.max(0, (1 - segmentSimilarityDTW(segments[x], segments[y], pathSSM) - 0.5) * 2);\n                //dist = 1 / (1 + segmentSimilarityDTW(segments[x], segments[y], pathSSM));\n                break;\n            case \"overlap\":\n                dist = segmentDistanceOverlap(segmentInducedSegments[x], segmentInducedSegments[y]);\n                break;\n        }\n        return dist;\n    });\n    return distanceMatrix;\n}\n","//import Matrix from \"ml-matrix\";\nimport HalfMatrix from \"./dataStructures/HalfMatrix\";\nimport * as similarity from \"./similarity\";\n\nimport * as log from \"../dev/log\";\nimport seedrandom from \"seedrandom\";\nimport numeric from \"numeric\";\nimport { features } from \"process\";\nconst {\n    Matrix,\n    inverse,\n    solve,\n    linearDependencies,\n    QrDecomposition,\n    LuDecomposition,\n    CholeskyDecomposition,\n    EigenvalueDecomposition,\n    pseudoInverse,\n} = require(\"ml-matrix\");\nexport function getMDSFeature(\n    distanceMatrix,\n    { lr = 40, maxSteps = 20, minLossDifference = 1e-6, momentum = 0, logEvery = 5 } = {}\n) {\n    let feature = classicalMDS(distanceMatrix.getNestedArray(), 1);\n    feature = feature.map((val) => val[0]);\n\n    //normalize to [0, 1]\n\n    let max = Math.max(...feature);\n    let min = Math.min(...feature);\n\n    feature = feature.map((val) => (val - min) / (max - min));\n\n    return feature;\n}\n\nexport function getMDSCoordinatesSamples(features, strategy) {\n    log.debug(\"CalculatingMDSSamples\");\n    const amount = features.length;\n    const distanceMatrix = new HalfMatrix({ size: amount, numberType: HalfMatrix.NumberType.FLOAT32 });\n    distanceMatrix.fill((x, y) => {\n        return 1 - similarity.cosine(features[x], features[y]);\n    });\n    let coords = [];\n    switch (strategy) {\n        case \"Classic\":\n            coords = classicalMDS(distanceMatrix.getNestedArray(), 1);\n            break;\n        case \"GD\":\n            coords = getMdsCoordinatesWithGradientDescentMatrix(new Matrix(distanceMatrix.getNestedArray()), {\n                lr: 5,\n            }).coordinates.data;\n            break;\n    }\n\n    return normalize1DCoordinates(coords);\n}\n\nexport function getMDSCoordinates(\n    distanceMatrix,\n    strategy = \"Classic\",\n    { lr = 40, maxSteps = 20, minLossDifference = 1e-6, momentum = 0, logEvery = 5 } = {}\n) {\n    log.debug(\"CalculatingMDS\");\n\n    // transform matrix to Matrix\n    const mlDistanceMatrix = new Matrix(distanceMatrix.getNestedArray());\n    /*const mlCoordinates = getMdsCoordinatesWithGradientDescentMatrix(mlDistanceMatrix, {\n        lr,\n        maxSteps,\n        minLossDifference,\n        momentum,\n        logEvery,\n    });*/\n\n    /*const mlCoordinates = getMdsCoordinatesWithGaussNewton(mlDistanceMatrix, {\n        lr: 2,\n        maxSteps: 200,\n        minLossDifference,\n        logEvery,\n    });*/\n\n    //const coordsOld = classicalMDS(distanceMatrix.getNestedArray(), 2);\n    //log.debug(\"oldcoords\", coordsOld);\n    const learnRates = [13];\n    let best = null;\n    let bestLoss = 1;\n    let coords;\n    switch (strategy) {\n        case \"Classic\":\n            coords = classicalMDS(distanceMatrix.getNestedArray(), 2);\n            break;\n        case \"GDTries\":\n            learnRates.push(0.5, 1, 2, 4, 8);\n            for (let r = 0; r < learnRates.length; r++) {\n                const rate = learnRates[r];\n                coords = getMdsCoordinatesWithGradientDescentMatrix(new Matrix(distanceMatrix.getNestedArray()), {\n                    lr: rate,\n                });\n                if (coords.lossPerStep[coords.lossPerStep.length - 1] < bestLoss) {\n                    best = coords;\n                    log.debug(\"Best is\", rate);\n                    bestLoss = coords.lossPerStep[coords.lossPerStep.length - 1];\n                }\n            }\n            coords = best.coordinates.data;\n            break;\n        case \"GD\":\n            for (let r = 0; r < learnRates.length; r++) {\n                const rate = learnRates[r];\n                coords = getMdsCoordinatesWithGradientDescentMatrix(new Matrix(distanceMatrix.getNestedArray()), {\n                    lr: rate,\n                });\n                if (isNaN(coords.lossPerStep[coords.lossPerStep.length - 1])) {\n                    learnRates.push(learnRates[learnRates.length - 1] / 2);\n                    log.debug(\"Changing rate to\", learnRates[learnRates.length - 1]);\n                } else if (coords.lossPerStep[coords.lossPerStep.length - 1] < bestLoss) {\n                    best = coords;\n                    log.debug(\"Best is\", rate);\n                    bestLoss = coords.lossPerStep[coords.lossPerStep.length - 1];\n                }\n            }\n            coords = best.coordinates.data;\n            break;\n        case \"GN\":\n            coords = getMdsCoordinatesWithGaussNewton(new Matrix(distanceMatrix.getNestedArray())).coordinates.data;\n            break;\n    }\n\n    return normalize2DCoordinates(coords);\n}\n\n/**\n * @fileoverview Functions for solving a Multidimensional Scaling problem with\n * gradient descent (optionally with momentum) or the Gauss-Newton algorithm.\n *\n * The two central functions are getMdsCoordinatesWithGradientDescent(...) and\n * getMdsCoordinatesWithGaussNewton(...).\n *\n * Dependencies:\n * - The ml-matrix library for computing matrix manipulations, see\n *   https://github.com/mljs/matrix.\n *   Version used: 6.4.1\n * - seedrandom, see https://github.com/davidbau/seedrandom.\n *   Version used: 3.0.5\n */\n\n/**\n * Solves a Multidimensional Scaling problem with gradient descent.\n *\n * If momentum is != 0, the update is:\n *\n * accumulation = momentum * accumulation + gradient\n * parameters -= learning_rate * accumulation\n *\n * like in TensorFlow and PyTorch.\n *\n * In the returned object, coordinates is a matrix of shape (n, 2) containing\n * the solution.\n *\n * @param {!Matrix} distances - matrix of shape (n, n) containing the\n *   distances between n points.\n * @param {!number} lr - learning rate to use.\n * @param {!number} maxSteps - maximum number of update steps.\n * @param {!number} minLossDifference - if the absolute difference between the\n *   losses of the current and the previous optimization step is smaller than\n *   this value, the function will return early.\n * @param {!number} momentum - momentum of the gradient descent. Set this value\n *   to zero to disable momentum.\n * @param {!number} logEvery - if larger than zero, this value determines the\n *   steps between logs to the console.\n * @returns {{coordinates: Matrix, lossPerStep: number[]}}\n */\nfunction getMdsCoordinatesWithGradientDescentMatrix(\n    distances,\n    { lr = 7, maxSteps = 500, minLossDifference = 1e-9, momentum = 0, logEvery = 0 } = {}\n) {\n    const numCoordinates = distances.rows;\n    let coordinates = getInitialMdsCoordinates(numCoordinates);\n\n    const lossPerStep = [];\n    let accumulation = null;\n\n    for (let step = 0; step < maxSteps; step++) {\n        const loss = getMdsLoss(distances, coordinates);\n        lossPerStep.push(loss);\n\n        // Check if we should early stop.\n        if (lossPerStep.length > 1) {\n            const lossPrev = lossPerStep[lossPerStep.length - 2];\n            if (Math.abs(lossPrev - loss) < minLossDifference || isNaN(loss) || loss > 10) {\n                return { coordinates: coordinates, lossPerStep: lossPerStep };\n            }\n        }\n\n        if (logEvery > 0 && step % logEvery === 0) {\n            console.log(`Step: ${step}, loss: ${loss}`);\n        }\n\n        // Apply the gradient for each coordinate.\n        for (let coordIndex = 0; coordIndex < numCoordinates; coordIndex++) {\n            const gradient = getGradientForCoordinate(distances, coordinates, coordIndex);\n\n            if (momentum === 0 || accumulation == null) {\n                accumulation = gradient;\n            } else {\n                accumulation = Matrix.add(Matrix.mul(accumulation, momentum), gradient);\n            }\n            const update = Matrix.mul(accumulation, lr);\n            const updatedCoordinates = Matrix.sub(coordinates.getRowVector(coordIndex), update);\n            coordinates.setRow(coordIndex, updatedCoordinates);\n        }\n    }\n\n    return { coordinates: coordinates, lossPerStep: lossPerStep };\n}\n\n/**\n * Solves a Multidimensional Scaling problem with the Gauss-Newton algorithm.\n *\n * In the returned object, coordinates is a matrix of shape (n, 2) containing\n * the solution.\n *\n * @param {!Matrix} distances - matrix of shape (n, n) containing the\n *   distances between n points.\n * @param {!number} lr - learning rate / alpha to use.\n * @param {!number} maxSteps - maximum number of update steps.\n * @param {!number} minLossDifference - if the absolute difference between the\n *   losses of the current and the previous optimization step is smaller than\n *   this value, the function will return early.\n * @param {!number} logEvery - if larger than zero, this value determines the\n *   steps between logs to the console.\n * @returns {{coordinates: Matrix, lossPerStep: number[]}}\n * { lr = 0.1, maxSteps = 200, minLossDifference = 1e-7, logEvery = 0 }\n */\nfunction getMdsCoordinatesWithGaussNewton(\n    distances,\n    { lr = 0.7, maxSteps = 100, minLossDifference = 0.0001, logEvery = 5 } = {}\n) {\n    const numCoordinates = distances.rows;\n    let coordinates = getInitialMdsCoordinates(numCoordinates);\n    const dimensions = coordinates.columns;\n\n    const lossPerStep = [];\n\n    for (let step = 0; step < maxSteps; step++) {\n        const loss = getMdsLoss(distances, coordinates);\n        lossPerStep.push(loss);\n\n        // Check if we should early stop.\n        if (lossPerStep.length > 1) {\n            const lossPrev = lossPerStep[lossPerStep.length - 2];\n            if (Math.abs(lossPrev - loss) < minLossDifference) {\n                return { coordinates: coordinates, lossPerStep: lossPerStep };\n            }\n        }\n\n        if (logEvery > 0 && step % logEvery === 0) {\n            console.log(`Step: ${step}, loss: ${loss}`);\n        }\n\n        // Apply the update.\n        const { residuals, jacobian } = getResidualsWithJacobian(distances, coordinates);\n        const update = pseudoInverse(jacobian).mmul(residuals);\n        for (let coordIndex = 0; coordIndex < numCoordinates; coordIndex++) {\n            for (let dimension = 0; dimension < dimensions; dimension++) {\n                const updateIndex = coordIndex * dimensions + dimension;\n                const paramValue = coordinates.get(coordIndex, dimension);\n                const updateDelta = lr * update.get(updateIndex, 0);\n                const updatedValue = paramValue - updateDelta;\n                coordinates.set(coordIndex, dimension, updatedValue);\n            }\n        }\n    }\n\n    return { coordinates: coordinates, lossPerStep: lossPerStep };\n}\n\n/**\n * Initializes the solution by sampling from a uniform distribution, which\n * only allows distances in [0, 1].\n *\n * @param {!number} numCoordinates - the number of points in the solution.\n * @param {!number} dimensions - the number of dimensions of each point.\n * @param {!number} seed - seed for the random number generator.\n * @returns {Matrix}\n */\nfunction getInitialMdsCoordinates(numCoordinates, dimensions = 2, seed = 1) {\n    const randomUniform = Matrix.rand(numCoordinates, dimensions, { random: new seedrandom(seed) });\n    return Matrix.div(randomUniform, Math.sqrt(dimensions));\n}\n\n/**\n * Returns the loss of a given solution to the Multidimensional Scaling\n * problem by computing the mean squared difference between target distances\n * and distances between points in the solution.\n *\n * @param {!Matrix} distances - matrix of shape (n, n) containing the\n *   distances between n points, defining the MDS problem.\n * @param {!Matrix} coordinates - a matrix of shape (n, d) containing\n *   the solution, for example given by getMdsCoordinatesWithGaussNewton(...).\n *   d is the number of dimensions.\n * @returns {number}\n */\nfunction getMdsLoss(distances, coordinates) {\n    // Average the squared differences of target distances and predicted\n    // distances.\n    let loss = 0;\n    const normalizer = Math.pow(coordinates.rows, 2);\n    for (let coordIndex1 = 0; coordIndex1 < coordinates.rows; coordIndex1++) {\n        for (let coordIndex2 = 0; coordIndex2 < coordinates.rows; coordIndex2++) {\n            if (coordIndex1 === coordIndex2) continue;\n\n            const coord1 = coordinates.getRowVector(coordIndex1);\n            const coord2 = coordinates.getRowVector(coordIndex2);\n            const target = distances.get(coordIndex1, coordIndex2);\n            const predicted = Matrix.sub(coord1, coord2).norm();\n            loss += Math.pow(target - predicted, 2) / normalizer;\n        }\n    }\n    return loss;\n}\n\n/**\n * Returns the residuals and the Jacobian matrix for performing one step of the\n * Gauss-Newton algorithm.\n *\n * The residuals are returned in a flattened vector as (target - predicted) /\n * numCoordinates. The flattened vector is ordered based on iterating the\n * matrix given by distances in row-major order. We divide by coordinates.rows,\n * so that the sum of squared residuals equals the MDS loss, which involves a\n * division by coordinates.rows ** 2.\n *\n * The element of the Jacobian at row i and column j should contain the\n * partial derivative of the i-th residual w.r.t. the j-th coordinate. The\n * coordinates are indexed in row-major order, such that in two dimensions,\n * the 5th zero-based index corresponds to the second coordinate of the third\n * point.\n *\n * @param {!Matrix} distances - matrix of shape (n, n) containing the\n *   distances between n points, defining the MDS problem.\n * @param {!Matrix} coordinates - a matrix of shape (n, d) containing\n *   the current solution, where d is the number of dimensions.\n * @returns {{jacobian: Matrix, residuals: Matrix}}\n */\nfunction getResidualsWithJacobian(distances, coordinates) {\n    const residuals = [];\n    const numCoordinates = coordinates.rows;\n    const dimensions = coordinates.columns;\n    const jacobian = Matrix.zeros(numCoordinates * numCoordinates, numCoordinates * dimensions);\n\n    for (let coordIndex1 = 0; coordIndex1 < numCoordinates; coordIndex1++) {\n        for (let coordIndex2 = 0; coordIndex2 < numCoordinates; coordIndex2++) {\n            if (coordIndex1 === coordIndex2) {\n                residuals.push(0);\n                // The gradient for all coordinates is zero, so we can skip\n                // this row of the Jacobian.\n                continue;\n            }\n\n            // Compute the residual.\n            const coord1 = coordinates.getRowVector(coordIndex1);\n            const coord2 = coordinates.getRowVector(coordIndex2);\n            const squaredDifferenceSum = Matrix.sub(coord1, coord2)\n                .pow(2)\n                .sum();\n            const predicted = Math.sqrt(squaredDifferenceSum);\n            const target = distances.get(coordIndex1, coordIndex2);\n            const residual = (target - predicted) / numCoordinates;\n            residuals.push(residual);\n\n            // Compute the gradient w.r.t. the first coordinate only. The\n            // second coordinate is seen as a constant.\n            const residualWrtPredicted = -1 / numCoordinates;\n            const predictedWrtSquaredDifferenceSum = 0.5 / Math.sqrt(squaredDifferenceSum);\n            const squaredDifferenceSumWrtCoord1 = Matrix.mul(Matrix.sub(coord1, coord2), 2);\n            const residualWrtCoord1 = Matrix.mul(\n                squaredDifferenceSumWrtCoord1,\n                residualWrtPredicted * predictedWrtSquaredDifferenceSum\n            );\n\n            // Set the corresponding indices in the Jacobian.\n            const rowIndex = numCoordinates * coordIndex1 + coordIndex2;\n            for (let dimension = 0; dimension < dimensions; dimension++) {\n                const columIndex = dimensions * coordIndex1 + dimension;\n                const jacobianEntry = jacobian.get(rowIndex, columIndex);\n                const entryUpdated = jacobianEntry + residualWrtCoord1.get(0, dimension);\n                jacobian.set(rowIndex, columIndex, entryUpdated);\n            }\n        }\n    }\n    return {\n        residuals: Matrix.columnVector(residuals),\n        jacobian: jacobian,\n    };\n}\n\n/**\n * Returns the gradient of the loss w.r.t. to a specific point in the\n * given solution.\n *\n * The returned matrix has the shape (1, d), where d is the number of\n * dimensions.\n *\n * @param {!Matrix} distances - matrix of shape (n, n) containing the\n *   distances between n points, defining the MDS problem.\n * @param {!Matrix} coordinates - a matrix of shape (n, d) containing\n *   the current solution, where d is the number of dimensions.\n * @param {!number} coordIndex - index of the point for which the gradient\n *   shall be computed.\n * @returns {Matrix}\n */\nfunction getGradientForCoordinate(distances, coordinates, coordIndex) {\n    const coord = coordinates.getRowVector(coordIndex);\n    const normalizer = Math.pow(coordinates.rows, 2);\n    let gradient = Matrix.zeros(1, coord.columns);\n\n    for (let otherCoordIndex = 0; otherCoordIndex < coordinates.rows; otherCoordIndex++) {\n        if (coordIndex === otherCoordIndex) continue;\n\n        const otherCoord = coordinates.getRowVector(otherCoordIndex);\n        const squaredDifferenceSum = Matrix.sub(coord, otherCoord)\n            .pow(2)\n            .sum();\n        const predicted = Math.sqrt(squaredDifferenceSum);\n        const targets = [distances.get(coordIndex, otherCoordIndex), distances.get(otherCoordIndex, coordIndex)];\n\n        for (const target of targets) {\n            const lossWrtPredicted = (-2 * (target - predicted)) / normalizer;\n            const predictedWrtSquaredDifferenceSum = 0.5 / Math.sqrt(squaredDifferenceSum);\n            const squaredDifferenceSumWrtCoord = Matrix.mul(Matrix.sub(coord, otherCoord), 2);\n            const lossWrtCoord = Matrix.mul(\n                squaredDifferenceSumWrtCoord,\n                lossWrtPredicted * predictedWrtSquaredDifferenceSum\n            );\n            gradient = Matrix.add(gradient, lossWrtCoord);\n        }\n    }\n\n    return gradient;\n}\n\nfunction classicalMDS(distances, dimensions) {\n    dimensions = dimensions || 2;\n\n    // square distances\n    var M = numeric.mul(-0.5, numeric.pow(distances, 2));\n\n    // double centre the rows/columns\n    function mean(A) {\n        return numeric.div(numeric.add.apply(null, A), A.length);\n    }\n    var rowMeans = mean(M),\n        colMeans = mean(numeric.transpose(M)),\n        totalMean = mean(rowMeans);\n\n    for (var i = 0; i < M.length; ++i) {\n        for (var j = 0; j < M[0].length; ++j) {\n            M[i][j] += totalMean - rowMeans[i] - colMeans[j];\n        }\n    }\n\n    // take the SVD of the double centred matrix, and return the\n    // points from it\n    var ret = numeric.svd(M),\n        eigenValues = numeric.sqrt(ret.S);\n    return ret.U.map(function(row) {\n        return numeric.mul(row, eigenValues).splice(0, dimensions);\n    });\n}\n\nexport function getAngleAndRadius(mdsCoordinate) {\n    const x = mdsCoordinate[0];\n    const y = mdsCoordinate[1];\n    let angle = Math.atan2(y, x) / (2 * Math.PI);\n    angle = angle < 0 ? 1 + angle : angle;\n    const radius = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n    return [angle, radius];\n}\nexport function normalize1DCoordinates(coords) {\n    coords = coords.map((coord) => coord[0]);\n    let min = Number.POSITIVE_INFINITY;\n    let max = Number.NEGATIVE_INFINITY;\n    for (let i = 0; i < coords.length; i++) {\n        if (coords[i] < min) min = coords[i];\n        if (coords[i] > max) max = coords[i];\n    }\n    for (let i = 0; i < coords.length; i++) {\n        coords[i] = (coords[i] - min) / (max - min);\n    }\n    log.debug(\"minmax\", min, max, coords);\n    return coords;\n}\nexport function normalize2DCoordinates(coords) {\n    let centerX = 0;\n    let centerY = 0;\n\n    for (let i = 0; i < coords.length; i++) {\n        centerX += coords[i][0];\n        centerY += coords[i][1];\n    }\n    centerX /= coords.length;\n    centerY /= coords.length;\n    for (let i = 0; i < coords.length; i++) {\n        coords[i][0] -= centerX;\n        coords[i][1] -= centerY;\n    }\n\n    // scale by largest\n    let maxRadius = 0;\n    for (let i = 0; i < coords.length; i++) {\n        const coord = coords[i];\n        const radius = Math.sqrt(coord[0] * coord[0] + coord[1] * coord[1]);\n        if (radius > maxRadius) maxRadius = radius;\n    }\n\n    for (let i = 0; i < coords.length; i++) {\n        coords[i] = [coords[i][0] / maxRadius, coords[i][1] / maxRadius];\n    }\n    return coords;\n}\n","import * as sim from \"./similarity\";\nimport * as audioUtil from \"./audioUtil\";\nimport * as log from \"../dev/log\";\nimport Matrix from \"./dataStructures/Matrix\";\nimport HalfMatrix from \"./dataStructures/HalfMatrix\";\nimport { NumberType } from \"./dataStructures/NumberType\";\nimport asciichart from \"asciichart\";\n\nexport function calculateSSM(\n    features,\n    sampleDuration,\n    allPitches = false,\n    threshold = 0,\n    similarityFunction = \"cosine\"\n) {\n    const ssm = new HalfMatrix({\n        size: features.length,\n        numberType: HalfMatrix.NumberType.UINT8,\n        sampleDuration: sampleDuration,\n        featureAmount: allPitches ? 12 : 1,\n    });\n    ssm.fillFeaturesNormalized((x, y, f) => {\n        if (similarityFunction === \"cosine\") {\n            return Math.max(0, sim.cosineTransposed(features[x], features[y], f) - threshold) / (1 - threshold);\n        } else if (similarityFunction === \"euclidean\") {\n            const val = sim.euclidianPitchTransposed(features[x], features[y], f);\n            if (val < 0 || val > 1) {\n                log.debug(x, y, val, features[x], features[y]);\n            }\n            return (\n                Math.max(0, Math.min(1, sim.euclidianPitchTransposed(features[x], features[y], f) - threshold)) /\n                (1 - threshold)\n            );\n        } else if (similarityFunction === \"euclideanTimbre\") {\n            return (\n                Math.max(0, Math.min(1, sim.euclidianTimbre(features[x], features[y]) - threshold)) / (1 - threshold)\n            );\n        }\n    });\n    return ssm;\n}\n\n/**\n * Diagonal smoothing of ssm, keeps paths but removes noise\n * @param {*} ssm\n * @param {*} options {`strategy`: choice of `onedir, linear, gauss, linmed`,`blurTime`: length in seconds, `blurLength`: length in samples, `tempoRatios`: array of ratios (e.g. [1.5] blurs paths that denote segment similarity with speed difference of 1.5)}\n */\nexport function enhanceSSM(ssm, options, allPitches = false) {\n    const blurLength = options.blurLength || Math.round(options.blurTime / ssm.sampleDuration) || 4;\n    const tempoRatios = options.tempoRatios || [1];\n    const strategy = options.strategy || \"linmed\";\n\n    const enhancementPasses = [];\n    for (const tempoRatio of tempoRatios) {\n        if (strategy === \"onedir\")\n            enhancementPasses.push(onedirectionalSmoothing(ssm, 1, Math.floor(blurLength / 2), tempoRatio));\n        if (strategy === \"onedir\")\n            enhancementPasses.push(onedirectionalSmoothing(ssm, -1, Math.floor(blurLength / 2), tempoRatio));\n        if (strategy === \"linear\" || strategy === \"lin\")\n            enhancementPasses.push(linearSmoothing(ssm, blurLength, tempoRatio));\n        if (strategy === \"gaussian\" || strategy === \"gauss\")\n            enhancementPasses.push(gaussianSmoothing(ssm, blurLength, tempoRatio));\n        if (strategy === \"onedirmed\")\n            enhancementPasses.push(\n                medianSmoothing(\n                    onedirectionalSmoothing(ssm, 1, Math.floor(blurLength / 2), tempoRatio),\n                    blurLength,\n                    tempoRatio\n                )\n            );\n        if (strategy === \"onedirmed\")\n            enhancementPasses.push(\n                medianSmoothing(\n                    onedirectionalSmoothing(ssm, -1, Math.floor(blurLength / 2), tempoRatio),\n                    blurLength,\n                    tempoRatio\n                )\n            );\n        if (strategy === \"linmed\")\n            enhancementPasses.push(\n                medianSmoothing(linearSmoothing(ssm, blurLength, tempoRatio), blurLength * 1.5, tempoRatio)\n            );\n        if (strategy === \"gaussmed\")\n            enhancementPasses.push(\n                medianSmoothing(gaussianSmoothing(ssm, blurLength, tempoRatio), blurLength * 1.5, tempoRatio)\n            );\n        if (strategy === \"med\") enhancementPasses.push(medianSmoothing(ssm, blurLength, tempoRatio));\n    }\n\n    const enhancedSSM = HalfMatrix.from(ssm);\n    enhancedSSM.fillByIndex((i) => {\n        let max = 0;\n        for (const enhancementPass of enhancementPasses) {\n            if (enhancementPass.data[i] > max) {\n                max = enhancementPass.data[i];\n            }\n        }\n        return max;\n    });\n    return enhancedSSM;\n}\n\nexport function onedirectionalSmoothing(ssm, direction, length, tempoRatio) {\n    const smoothedSSM = HalfMatrix.from(ssm);\n\n    const tempos = new Int8Array(length);\n    for (let i = 0; i < length; i++) {\n        tempos[i] = Math.round(i * tempoRatio);\n    }\n\n    smoothedSSM.fillFeatures((x, y, f) => {\n        let sum = 0;\n        for (let i = 0; i !== direction * length; i += direction) {\n            if (ssm.hasCell(x + i, y + direction * tempos[Math.abs(i)])) {\n                sum += ssm.getValue(x + i, y + direction * tempos[Math.abs(i)], f);\n            }\n        }\n        return sum / length;\n    });\n    return smoothedSSM;\n}\n\nfunction linearSmoothing(ssm, length, tempoRatio) {\n    const smoothedSSM = HalfMatrix.from(ssm);\n\n    const blur = Math.round(length / 2); //Math.floor(length / 2);\n    const total = Math.pow(blur + 1, 2);\n    const tempos = new Int8Array(blur * 2 + 1);\n    for (let i = -blur; i < 1 + blur; i++) {\n        tempos[i + blur] = Math.round(i * tempoRatio);\n    }\n\n    smoothedSSM.fillFeatures((x, y, f) => {\n        let sum = 0;\n        for (let i = -blur; i < 1 + blur; i++) {\n            if (ssm.hasCell(x + i, y + tempos[i + blur])) {\n                sum += ssm.getValue(x + i, y + tempos[i + blur], f) * (blur + 1 - Math.abs(i));\n            }\n        }\n        return sum / total;\n    });\n    return smoothedSSM;\n}\n\nfunction medianSmoothing(ssm, length, tempoRatio, resolution = 128) {\n    const buckets = new Float32Array(resolution);\n\n    const l = Math.floor((length - 1) / 2);\n\n    const tempos = new Int8Array(l * 2 + 1);\n    for (let i = -l; i < 1 + l; i++) {\n        tempos[i + l] = Math.round(i * tempoRatio);\n    }\n    const smoothedSSM = HalfMatrix.from(ssm);\n\n    smoothedSSM.fillFeaturesNormalized((x, y, f) => {\n        let totalValues = l * 2 + 1;\n        for (let offset = -l; offset <= l; offset++) {\n            if (ssm.hasCell(x + offset, y + tempos[offset + l])) {\n                const value = ssm.getValueNormalized(x + offset, y + tempos[offset + l], f);\n                buckets[Math.floor(value * (resolution - 1))]++;\n            } else {\n                buckets[0]++;\n            }\n        }\n        let middle = totalValues / 2;\n\n        //Both check middle and clear buckets\n        let mean = -1;\n        for (let i = 0; i < resolution; i++) {\n            middle -= buckets[i];\n            if (middle < 0 && mean === -1) {\n                mean = i / (resolution - 1);\n            }\n            buckets[i] = 0;\n        }\n        return mean;\n    });\n\n    return smoothedSSM;\n}\n\nfunction gaussianSmoothing(ssm, length, tempoRatio) {\n    const smoothedSSM = HalfMatrix.from(ssm);\n\n    const blur = Math.round(length / 2); //Math.floor(length / 2);\n    const tempos = new Int8Array(blur * 2 + 1);\n    const gaussianKernel = gauss(blur);\n    for (let i = -blur; i < 1 + blur; i++) {\n        tempos[i + blur] = Math.round(i * tempoRatio);\n    }\n    //const lengthRatio = 1/Math.sqrt(1+tempoRatio);\n\n    smoothedSSM.fillFeatures((x, y, f) => {\n        let sum = 0;\n        for (let i = -blur; i < 1 + blur; i++) {\n            if (ssm.hasCell(x + i, y + tempos[i + blur])) {\n                sum += ssm.getValue(x + i, y + tempos[i + blur], f) * gaussianKernel[i + blur];\n            }\n        }\n        return sum;\n    });\n    return smoothedSSM;\n}\n\nfunction gauss(blur, sigma = 2) {\n    const gauss = new Float32Array(blur * 2 + 1);\n    for (let i = -blur; i < 1 + blur; i++) {\n        gauss[i + blur] = (1 / (sigma * Math.sqrt(2 * Math.PI))) * Math.exp(-Math.pow(i, 2) / (2 * Math.pow(sigma, 2)));\n    }\n    return gauss;\n}\n\nexport function makeTranspositionInvariant(ssm) {\n    const lengthWithoutFeatures = ssm.length / ssm.featureAmount;\n    const transpositionInvariantSSM = new HalfMatrix({\n        size: ssm.size,\n        numberType: HalfMatrix.NumberType.UINT8,\n        sampleDuration: ssm.sampleDuration,\n    });\n\n    let i = 0;\n    while (i < lengthWithoutFeatures) {\n        let max = 0;\n        for (let f = 0; f < ssm.featureAmount; f++) {\n            if (ssm.data[i * ssm.featureAmount + f] > max) {\n                max = ssm.data[i * ssm.featureAmount + f];\n            }\n        }\n        transpositionInvariantSSM.data[i] = max;\n        i++;\n    }\n    return transpositionInvariantSSM;\n}\n\nexport function autoThreshold(ssm, percentage) {\n    const typeScale = ssm.numberType.scale;\n\n    let frequencies = new Uint32Array(typeScale + 1).fill(0);\n    let totalCells = 0;\n    let zeros = 0;\n    let tff = 0;\n    ssm.forEach((cell) => {\n        if (cell === 0) zeros++;\n        if (cell === 255) tff++;\n        frequencies[Math.floor(cell)] = frequencies[Math.floor(cell)] + 1;\n        totalCells++;\n    });\n\n    let percentagePosition = totalCells - totalCells * percentage;\n    let thresholdValue;\n    for (let i = 0; i < typeScale + 1; i++) {\n        percentagePosition -= frequencies[i];\n        if (percentagePosition <= 0) {\n            thresholdValue = i / typeScale;\n            break;\n        }\n    }\n    let thresholdSSM;\n    if (ssm instanceof Matrix) {\n        thresholdSSM = Matrix.from(ssm);\n    } else {\n        thresholdSSM = HalfMatrix.from(ssm);\n    }\n    for (let i = 0; i < ssm.length; i++) {\n        thresholdSSM.data[i] =\n            Math.min(Math.max(ssm.data[i] / typeScale - thresholdValue, 0) / (1 - thresholdValue), 1) * typeScale;\n    }\n    return thresholdSSM;\n}\n\nexport function multiply(ssm, factor) {\n    let multSSM;\n    if (ssm instanceof Matrix) {\n        multSSM = Matrix.from(ssm);\n    } else {\n        multSSM = HalfMatrix.from(ssm);\n    }\n\n    multSSM.fillNormalized((x, y) => {\n        const val = factor * ssm.getValueNormalizedMirrored(x, y);\n        if (val < 0) {\n            return 0;\n        } else if (val > 1) {\n            return 1;\n        } else {\n            return val;\n        }\n    });\n\n    return multSSM;\n}\n\nexport function threshold(ssm, threshold) {\n    let thresholdSSM;\n    if (ssm instanceof Matrix) {\n        thresholdSSM = Matrix.from(ssm);\n    } else {\n        thresholdSSM = HalfMatrix.from(ssm);\n    }\n\n    thresholdSSM.fillNormalized((x, y) => {\n        const originalValue = ssm.getValueNormalizedMirrored(x, y);\n        if (originalValue <= threshold) {\n            return 0;\n        } else {\n            return (originalValue - threshold) / (1 - threshold);\n        }\n    });\n\n    return thresholdSSM;\n}\nexport function rowColumnAutoThresholdBinary(ssm, percentageRow, percentageCol = percentageRow) {\n    const typeScale = ssm.numberType.scale;\n\n    const rowBinaryMatrix = new HalfMatrix({ size: ssm.size, numberType: NumberType.UINT8 });\n    const colBinaryMatrix = new HalfMatrix({ size: ssm.size, numberType: NumberType.UINT8 });\n    let frequencies = new Uint16Array(typeScale + 1);\n\n    for (let row = 0; row < ssm.size; row++) {\n        frequencies.fill(0);\n        for (let col = 0; col < ssm.size; col++) {\n            frequencies[ssm.getValueMirrored(col, row)]++;\n        }\n        let stopPosition = ssm.size * percentageRow;\n        let thresholdValue = 0;\n        for (let i = typeScale; i > 0; i--) {\n            stopPosition -= frequencies[i];\n            if (stopPosition <= 0) {\n                thresholdValue = i;\n                break;\n            }\n        }\n        for (let col = 0; col <= row; col++) {\n            if (ssm.getValue(col, row) >= thresholdValue) {\n                rowBinaryMatrix.setValue(col, row, 1);\n            } else {\n                rowBinaryMatrix.setValue(col, row, 0);\n            }\n        }\n    }\n\n    for (let col = 0; col < ssm.size; col++) {\n        frequencies.fill(0);\n        for (let row = 0; row < ssm.size; row++) {\n            frequencies[ssm.getValueMirrored(col, row)]++;\n        }\n        let stopPosition = ssm.size * percentageCol;\n        let thresholdValue = 0;\n        for (let i = typeScale; i > 0; i--) {\n            stopPosition -= frequencies[i];\n            if (stopPosition <= 0) {\n                thresholdValue = i;\n                break;\n            }\n        }\n\n        for (let row = col; row <= ssm.size; row++) {\n            if (ssm.getValue(col, row) >= thresholdValue) {\n                colBinaryMatrix.setValue(col, row, 1);\n            } else {\n                colBinaryMatrix.setValue(col, row, 0);\n            }\n        }\n    }\n    const thresholdSSM = HalfMatrix.from(ssm);\n    thresholdSSM.fill((x, y) => {\n        if (rowBinaryMatrix.getValue(x, y) > 0 && colBinaryMatrix.getValue(x, y) > 0) {\n            return ssm.getValueMirrored(x, y);\n        } else {\n            return ssm.getValueMirrored(x, y);\n        }\n    });\n\n    return thresholdSSM;\n}\n\nexport function rowColumnAutoThreshold(ssm, percentageRow, percentageCol = percentageRow) {\n    const typeScale = ssm.numberType.scale;\n\n    const rowBinaryMatrix = new HalfMatrix({ size: ssm.size, numberType: NumberType.UINT8 });\n    const colBinaryMatrix = new HalfMatrix({ size: ssm.size, numberType: NumberType.UINT8 });\n    let frequencies = new Uint16Array(typeScale + 1);\n\n    for (let row = 0; row < ssm.size; row++) {\n        frequencies.fill(0);\n        for (let col = 0; col < ssm.size; col++) {\n            frequencies[ssm.getValueMirrored(col, row)]++;\n        }\n        let stopPosition = ssm.size * percentageRow;\n        let thresholdValue = 0;\n        for (let i = typeScale; i > 0; i--) {\n            stopPosition -= frequencies[i];\n            if (stopPosition <= 0) {\n                thresholdValue = i;\n                break;\n            }\n        }\n        for (let col = 0; col <= row; col++) {\n            if (ssm.getValue(col, row) >= thresholdValue) {\n                rowBinaryMatrix.setValue(\n                    col,\n                    row,\n                    Math.min(\n                        (Math.max(ssm.getValue(col, row) - thresholdValue, 0) / (typeScale - thresholdValue)) *\n                            typeScale,\n                        typeScale\n                    )\n                );\n            }\n        }\n    }\n\n    for (let col = 0; col < ssm.size; col++) {\n        frequencies.fill(0);\n        for (let row = 0; row < ssm.size; row++) {\n            frequencies[ssm.getValueMirrored(col, row)]++;\n        }\n        let stopPosition = ssm.size * percentageCol;\n        let thresholdValue = 0;\n        for (let i = typeScale; i > 0; i--) {\n            stopPosition -= frequencies[i];\n            if (stopPosition <= 0) {\n                thresholdValue = i;\n                break;\n            }\n        }\n\n        for (let row = col; row <= ssm.size; row++) {\n            if (ssm.getValue(col, row) >= thresholdValue) {\n                colBinaryMatrix.setValue(\n                    col,\n                    row,\n                    Math.min(\n                        (Math.max(ssm.getValue(col, row) - thresholdValue, 0) / (typeScale - thresholdValue)) *\n                            typeScale,\n                        typeScale\n                    )\n                );\n            }\n        }\n    }\n    const thresholdSSM = HalfMatrix.from(ssm);\n    thresholdSSM.fill((x, y) => {\n        return (rowBinaryMatrix.getValue(x, y) + colBinaryMatrix.getValue(x, y)) / 2;\n    });\n\n    return thresholdSSM;\n}\n\nexport function binarize(matrix, threshold = 0.5) {\n    let binaryMatrix;\n    if (matrix instanceof Matrix) {\n        binaryMatrix = Matrix.from(matrix, { numberType: Matrix.NumberType.UINT8 });\n    } else {\n        binaryMatrix = HalfMatrix.from(matrix, { numberType: Matrix.NumberType.UINT8 });\n    }\n    binaryMatrix.fill((x, y) => {\n        if (matrix.getValueNormalized(x, y) > threshold) {\n            return 255;\n        } else {\n            return 0;\n        }\n    });\n\n    return binaryMatrix;\n}\n\nexport function soloOr(ssm, sectionsInSamples) {\n    let soloSSM;\n    if (ssm instanceof Matrix) {\n        soloSSM = Matrix.from(ssm);\n    } else {\n        soloSSM = HalfMatrix.from(ssm);\n    }\n\n    soloSSM.fill((x, y) => {\n        if (x === y) return soloSSM.numberType.max;\n        const inSelection = sectionsInSamples.some((section) => {\n            return (section.start <= x && x < section.end) || (section.start <= y && y < section.end);\n        });\n        return inSelection ? ssm.getValueMirrored(x, y) : 0;\n    });\n\n    return soloSSM;\n}\n\nexport function showInner(ssm, sectionsInSamples) {\n    const chosenSectionsSSM = soloAnd(ssm, sectionsInSamples);\n    const allContainedSectionsSSM = soloOr(ssm, sectionsInSamples);\n\n    let otherSectionsSSM;\n    if (allContainedSectionsSSM instanceof Matrix) {\n        otherSectionsSSM = Matrix.from(allContainedSectionsSSM);\n    } else {\n        otherSectionsSSM = HalfMatrix.from(allContainedSectionsSSM);\n    }\n\n    chosenSectionsSSM.forEachCell((x, y, value) => {\n        if (x !== y && value > 0) {\n            allContainedSectionsSSM.setValue(x, y, 0);\n        }\n    });\n\n    return allContainedSectionsSSM;\n}\n\nexport function soloAnd(ssm, sectionsInSamples, rowcol = \"rowcol\") {\n    let soloSSM;\n    if (ssm instanceof Matrix) {\n        soloSSM = Matrix.from(ssm);\n    } else {\n        soloSSM = HalfMatrix.from(ssm);\n    }\n\n    const row = rowcol.includes(\"row\");\n    const col = rowcol.includes(\"col\");\n\n    soloSSM.fill((x, y) => {\n        if (x === y) return soloSSM.numberType.max;\n        let inSelectionX = sectionsInSamples.some((section) => {\n            return section.start <= x && x < section.end;\n        });\n        let inSelectionY = sectionsInSamples.some((section) => {\n            return section.start <= y && y < section.end;\n        });\n        return (inSelectionX || !col) && (inSelectionY || !row) ? ssm.getValueMirrored(x, y) : 0;\n    });\n\n    return soloSSM;\n}\n\nexport function muteAnd(ssm, sectionsInSamples) {\n    let soloSSM;\n    if (ssm instanceof Matrix) {\n        soloSSM = Matrix.from(ssm);\n    } else {\n        soloSSM = HalfMatrix.from(ssm);\n    }\n\n    soloSSM.fill((x, y) => {\n        if (x === y) return soloSSM.numberType.max;\n        const inSelectionX = sectionsInSamples.some((section) => {\n            return section.start <= x && x < section.end;\n        });\n        const inSelectionY = sectionsInSamples.some((section) => {\n            return section.start <= y && y < section.end;\n        });\n        return inSelectionX && inSelectionY ? 0 : ssm.getValueMirrored(x, y);\n    });\n\n    return soloSSM;\n}\n\nexport function muteOr(ssm, sectionsInSamples) {\n    let soloSSM;\n    if (ssm instanceof Matrix) {\n        soloSSM = Matrix.from(ssm);\n    } else {\n        soloSSM = HalfMatrix.from(ssm);\n    }\n\n    soloSSM.fill((x, y) => {\n        if (x === y) return soloSSM.numberType.max;\n        const inSelection = sectionsInSamples.some((section) => {\n            return (section.start <= x && x < section.end) || (section.start <= y && y < section.end);\n        });\n        return inSelection ? 0 : ssm.getValueMirrored(x, y);\n    });\n\n    return soloSSM;\n}\n\nexport function removeSections(ssm, sectionsInSamples) {\n    let newSSM = ssm.clone();\n\n    sectionsInSamples.forEach((sectionA) => {\n        sectionsInSamples.forEach((sectionB) => {\n            if (sectionA !== sectionB) {\n                const startX = sectionA.start;\n                const startY = sectionB.start;\n                const endX = sectionA.end;\n                const endY = sectionB.end;\n                const xDuration = endX - startX;\n                const yDuration = endY - startY;\n\n                const duratio = yDuration / xDuration;\n                for (let i = 0; i < xDuration; i++) {\n                    const x = startX + i;\n                    const y = startY + i * duratio;\n                    newSSM.setValue(x + 2, y - 2, 0);\n                    newSSM.setValue(x + 1, y - 1, 0);\n                    newSSM.setValue(x, y, 0);\n                    newSSM.setValue(x - 1, y + 1, 0);\n                    newSSM.setValue(x - 2, y + 2, 0);\n                }\n            }\n        });\n    });\n\n    return newSSM;\n}\n\n// subtract b from a\nexport function subtract(a, b) {\n    const newSSM = Matrix.from(a);\n\n    newSSM.fillByIndex((i) => {\n        const value = a.data[i] - b.data[i];\n        return Math.max(0, value);\n    });\n\n    return newSSM;\n}\n","import assert from \"assert\";\nimport * as log from \"../dev/log\";\nimport * as audioUtil from \"./audioUtil\";\n\nimport * as _ from \"lodash\";\n/*\n *   Everything is defined in seconds; it is samplerate agnostic\n */\nexport default class Section {\n    start;\n    end;\n    startSample;\n    endSample;\n\n    confidence = 1;\n    groupID = 0;\n\n    key = -1;\n\n    mdsFeature;\n\n    // family variables\n    parent = false;\n    pathFamily;\n    pathFamilyScores;\n    score;\n    normalizedScore;\n    coverage;\n    normalizedCoverage;\n    fitness;\n\n    constructor(args) {\n        this.start = args.start;\n        this.end = args.end;\n        this.startSample = args.startSample;\n        this.endSample = args.endSample;\n        if (args.groupID !== undefined) {\n            this.groupID = args.groupID;\n        }\n        if (args.confidence !== undefined) {\n            this.confidence = args.confidence;\n        }\n        if (args.mdsFeature !== undefined) {\n            this.mdsFeature = args.mdsFeature;\n        }\n        if (args.colorAngle !== undefined) {\n            this.colorAngle = args.colorAngle;\n        }\n        if (args.colorRadius !== undefined) {\n            this.colorRadius = args.colorRadius;\n        }\n    }\n\n    //label;\n\n    getDuration() {\n        return this.end - this.start;\n    }\n\n    getVerticalPosition() {}\n\n    overlaps(otherSection) {\n        return (\n            (this.start <= otherSection.start && this.end > otherSection.start) ||\n            (this.start < otherSection.start && this.end >= otherSection.end) ||\n            (otherSection.start <= this.start && otherSection.end > this.start) ||\n            (otherSection.start < this.start && otherSection.end >= this.end) ||\n            (this.start >= otherSection.start && this.end <= otherSection.end) ||\n            (otherSection.start >= this.start && otherSection.end <= this.end)\n        );\n    }\n\n    splits(otherSection) {\n        return otherSection.start < this.start && otherSection.end > this.end;\n    }\n\n    covers(otherSection) {\n        return this.start <= otherSection.start && this.end >= otherSection.end;\n    }\n\n    clipsStart(otherSection) {\n        return this.end > otherSection.start && this.end < otherSection.end && this.start <= otherSection.start;\n    }\n\n    clipsEnd(otherSection) {\n        return this.start > otherSection.start && this.start < otherSection.end && this.end >= otherSection.end;\n    }\n\n    disjoint(otherSection) {\n        return this.end <= otherSection.start || this.start >= otherSection.end;\n    }\n\n    clone() {\n        return _.cloneDeep(this);\n    }\n\n    amountOfSectionsAfterSubtract(otherSection) {\n        if (otherSection.covers(this)) return 0;\n        if (otherSection.splits(this)) return 2;\n        return 1;\n    }\n\n    subtract(otherSection) {\n        if (otherSection.disjoint(this)) return this;\n\n        assert(\n            this.amountOfSectionsAfterSubtract(otherSection) === 1,\n            `Won't subtract, subtraction yields ${this.amountOfSectionsAfterSubtract(otherSection)} sections [${\n                this.start\n            }, ${this.end}] - [${otherSection.start}, ${otherSection.end}]`\n        );\n\n        if (otherSection.clipsEnd(this)) {\n            this.end = otherSection.start;\n        } else if (otherSection.clipsStart(this)) {\n            this.start = otherSection.end;\n        }\n\n        if (this.end <= this.start) {\n            throw new Error(\"Section end is before start\");\n        }\n\n        return this;\n    }\n\n    subtractAndCreateNew(otherSection) {\n        if (otherSection.covers(this)) return [];\n        if (otherSection.splits(this)) {\n            const left = this.clone();\n            left.end = otherSection.start;\n            const right = this.clone();\n            right.start = otherSection.end;\n            return [left, right];\n        }\n\n        const thisClone = this.clone();\n        return [thisClone.subtract(otherSection)];\n    }\n\n    getKeyName() {\n        return audioUtil.keyNames[this.key];\n    }\n}\n","import * as noveltyDetection from \"./noveltyDetection\";\nimport * as log from \"../dev/log\";\nimport * as pathExtraction from \"./pathExtraction\";\nimport * as similarity from \"./similarity\";\nimport * as mds from \"./mds\";\nimport * as clustering from \"./clustering\";\nimport * as SSM from \"./SSM\";\nimport * as _ from \"lodash\";\nimport HalfMatrix from \"./dataStructures/HalfMatrix\";\nimport Section from \"./Section\";\n\nexport function createFixedDurationStructureSegments(sampleAmount, sampleDuration, duration) {\n    const structureSegments = [];\n    let start = 0;\n    while (start + duration < sampleAmount) {\n        structureSegments.push(\n            new Section({ start: start * sampleDuration, end: (start + duration) * sampleDuration })\n        );\n        start += duration;\n    }\n    return structureSegments;\n}\n\nexport function createSegmentsFromNovelty(novelty, sampleDuration, threshold = 0.1) {\n    //const maxima = noveltyDetection.findLocalMaxima(novelty, threshold);\n    let peaks = noveltyDetection.findPeaks(novelty);\n    peaks = peaks.filter((peak) => peak.confidence > threshold);\n    const structureSegments = [];\n\n    for (let i = 0; i < peaks.length; i++) {\n        const peak = peaks[i];\n        const start = peak.sample * sampleDuration;\n        const startSample = peak.sample;\n        const end = i < peaks.length - 1 ? sampleDuration * peaks[i + 1].sample : sampleDuration * novelty.length;\n        const endSample = i < peaks.length - 1 ? peaks[i + 1].sample : novelty.length;\n        const confidence = peak.confidence;\n        const groupID = structureSegments.length;\n        structureSegments.push(\n            new Section({\n                start,\n                end,\n                confidence,\n                groupID,\n                startSample,\n                endSample,\n            })\n        );\n    }\n    return structureSegments;\n}\n\nexport function computeStructureCandidates(\n    pathSSM,\n    structureSegments,\n    minDurationSeconds = 1,\n    maxRatio = 0.4,\n    strategy\n) {\n    const sampleAmount = pathSSM.getSampleAmount();\n    const segmentAmount = structureSegments.length;\n    const sampleDuration = pathSSM.sampleDuration;\n    const maxLength = maxRatio * sampleAmount * sampleDuration;\n    const scoreMatrixBuffer = pathExtraction.createScoreMatrixBuffer(sampleAmount);\n    const candidates = [];\n\n    for (let start = 0; start < segmentAmount; start++) {\n        for (let end = start; end < segmentAmount; end++) {\n            const startInSeconds = structureSegments[start].start;\n            const endInSeconds = structureSegments[end].end;\n            const segmentLengthInSeconds = endInSeconds - startInSeconds;\n            if (segmentLengthInSeconds < minDurationSeconds || segmentLengthInSeconds > maxLength) continue;\n            const startInSamples = Math.floor(startInSeconds / sampleDuration);\n            const endInSamples = Math.floor(endInSeconds / sampleDuration);\n\n            candidates.push(\n                createCandidate(pathSSM, startInSamples, endInSamples, scoreMatrixBuffer, strategy, candidates.length)\n            );\n        }\n    }\n\n    return candidates;\n}\n\nexport function computeSeparateStructureCandidates(\n    pathSSM,\n    separateSegmentSets,\n    strategy,\n    minDurationSeconds = 1,\n    maxRatio = 0.25\n) {\n    const separateCandidateSets = [];\n    separateSegmentSets.forEach((segments) => {\n        const candidates = computeStructureCandidates(pathSSM, segments, minDurationSeconds, maxRatio, strategy);\n        separateCandidateSets.push(candidates);\n    });\n\n    return separateCandidateSets;\n}\n\nexport function findFittestSections(ssm, segments, strategy = \"classic\") {\n    const size = ssm.getSize();\n    const sampleDuration = ssm.getSampleDuration();\n    const scoreMatrixBuffer = pathExtraction.createScoreMatrixBuffer(size);\n\n    const candidates = [];\n    segments.forEach((segment) => {\n        const startInSamples = Math.floor(segment.start / sampleDuration);\n        const endInSamples = Math.floor(segment.end / sampleDuration);\n        candidates.push(\n            createCandidate(ssm, startInSamples, endInSamples, scoreMatrixBuffer, strategy, candidates.length)\n        );\n    });\n    const sortedCandidates = candidates.sort(fitnessSort);\n    const sections = [];\n\n    let repeats = 0;\n    while (sortedCandidates.length > 0 && repeats < segments.length) {\n        repeats++;\n\n        const bestSection = sortedCandidates.shift();\n        bestSection.groupID = repeats;\n\n        const pathFamily = getPathFamily(bestSection, sampleDuration, bestSection.groupID);\n        const extendedPathFamily = getExtendedPathFamily(\n            bestSection,\n            sampleDuration,\n            bestSection.groupID,\n            ssm,\n            strategy\n        );\n        const nonOverlappingExtendedPathFamily = addNonOverlapping(pathFamily, extendedPathFamily);\n        const prunedPaths = pruneLowConfidence(nonOverlappingExtendedPathFamily, 0.15);\n        prunedPaths.forEach((path) => {\n            path.normalizedScore = bestSection.normalizedScore;\n            path.normalizedCoverage = bestSection.normalizedCoverage;\n            path.fitness = bestSection.fitness;\n        });\n        sections.push(...prunedPaths);\n    }\n\n    return sections;\n}\n\nconst allowOverlap = true;\nexport function findMuteDecomposition(\n    pathSSM,\n    structureSegments,\n    sampleDuration,\n    strategy = \"classic\",\n    muteType = \"or\",\n    updateCallback,\n    comparisonProperty = \"fitness\",\n    minDurationSeconds = 2,\n    minFitness = 0.02\n) {\n    const trackEnd = structureSegments[structureSegments.length - 1].end;\n    let structureSections = [];\n    let sortedStructureSections = [];\n    const segments = [];\n\n    let separateSegmentSets = [structureSegments];\n\n    let ssm = pathSSM;\n\n    let i = 0;\n    const maxRepeats = 14;\n    while (separateSegmentSets.length > 0 && i < maxRepeats) {\n        let separateCandidateSets = computeSeparateStructureCandidates(\n            ssm,\n            separateSegmentSets,\n            strategy,\n            minDurationSeconds\n        );\n        const allCandidates = [].concat.apply([], separateCandidateSets);\n        if (allCandidates.length === 0) {\n            break;\n        }\n        const allCandidatesSorted = allCandidates.sort((a, b) => {\n            if (a[comparisonProperty] < b[comparisonProperty]) {\n                return 1;\n            }\n            if (a[comparisonProperty] > b[comparisonProperty]) {\n                return -1;\n            }\n            return 0;\n        });\n\n        let best = allCandidatesSorted.shift();\n        const initialFitness = best.fitness;\n        if (wiggle) {\n            best = findBetterFit(\n                ssm,\n                best,\n                wiggleSize,\n                comparisonProperty,\n                strategy,\n                sortedStructureSections,\n                minDurationSeconds,\n                allowOverlap\n            );\n        }\n        if (best === null || best[comparisonProperty] <= minFitness || isNaN(best[comparisonProperty])) {\n            break;\n        }\n        const groupID = i;\n        best.groupID = groupID;\n\n        const pathFamily = getPathFamily(best, sampleDuration, groupID);\n        const extendedPathFamily = getExtendedPathFamily(best, sampleDuration, groupID, pathSSM, strategy);\n        const nonOverlappingExtendedPathFamily = addNonOverlapping(pathFamily, extendedPathFamily);\n        const prunedPaths = pruneLowConfidence(nonOverlappingExtendedPathFamily, 0.1);\n        prunedPaths.forEach((path) => {\n            path.normalizedScore = best.normalizedScore;\n            path.normalizedCoverage = best.normalizedCoverage;\n            path.fitness = best.fitness;\n            path.initFitness = initialFitness;\n        });\n        sortedStructureSections.push(...prunedPaths);\n        structureSections.push(...prunedPaths);\n        const prunedPathsInSamples = prunedPaths.map((section) => {\n            const clone = section.clone();\n            clone.start = Math.floor(clone.start / sampleDuration);\n            clone.end = Math.floor(clone.end / sampleDuration);\n            return clone;\n        });\n        if (muteType === \"and\") {\n            ssm = SSM.muteAnd(ssm, prunedPathsInSamples);\n        } else if (muteType === \"remove\") {\n            ssm = SSM.removeSections(ssm, prunedPathsInSamples);\n        } else {\n            ssm = SSM.muteOr(ssm, prunedPathsInSamples);\n        }\n\n        sortedStructureSections = sortedStructureSections.sort((a, b) => (a.start > b.start ? 1 : -1));\n        if (updateCallback) {\n            updateCallback(structureSections);\n        }\n\n        separateSegmentSets = subtractStructureFromSegments(\n            _.cloneDeep(separateSegmentSets),\n            sortedStructureSections,\n            trackEnd,\n            minDurationSeconds\n        );\n        const allSegments = [].concat.apply([], separateSegmentSets);\n        allSegments.forEach((segment) => (segment.groupID = i));\n        segments.push(...allSegments);\n        i++;\n    }\n    return [sortedStructureSections, i, segments];\n}\n\nexport function findSubDecomposition(\n    pathSSM,\n    structureSections,\n    minDurationSeconds = 2,\n    strategy = \"fine\",\n    minFitness = 0.15\n) {\n    const sampleDuration = pathSSM.getSampleDuration();\n    const minDurationSamples = Math.ceil(minDurationSeconds / sampleDuration);\n\n    let subStructureSections = [];\n\n    let ID = 0;\n    for (let i = 0; i < 20; i++) {\n        let groupSections = structureSections.filter((section) => section.groupID === i);\n        const smallestSize = groupSections.reduce((min, section) => {\n            const size = section.end - section.start;\n            return size < min ? size : min;\n        }, Number.POSITIVE_INFINITY);\n        const maxDurationSeconds = Math.ceil(smallestSize / 2);\n\n        if (groupSections.length === 0) break;\n        groupSections = subtractSegments(groupSections, subStructureSections);\n        groupSections = groupSections.filter((section) => section.end - section.start >= minDurationSeconds);\n        let subStructureSection;\n        let j = 0;\n        do {\n            subStructureSection = findSubstructure(\n                pathSSM,\n                groupSections,\n                maxDurationSeconds,\n                minDurationSeconds,\n                minFitness,\n                strategy\n            );\n            if (subStructureSection) {\n                const subPathFamily = getPathFamily(subStructureSection, sampleDuration, ID);\n                const extendedSubPathFamily = getExtendedPathFamily(\n                    subStructureSection,\n                    sampleDuration,\n                    ID,\n                    pathSSM,\n                    strategy\n                );\n                const nonOverlappingExtendedSubPathFamily = addNonOverlapping(subPathFamily, extendedSubPathFamily);\n                const subFamily = pruneLowConfidence(nonOverlappingExtendedSubPathFamily, 0.1);\n\n                subStructureSections.push(...subFamily);\n                groupSections = subtractSegments(groupSections, subStructureSections);\n                groupSections = groupSections.filter((section) => section.end - section.start >= minDurationSeconds);\n                ID++;\n                j++;\n            } else {\n                // no more fit sections, use up remaining sections?\n                let remainingSections = groupSections.filter(\n                    (section) => section.end - section.start >= minDurationSeconds\n                );\n                if (remainingSections.length > 0) {\n                    remainingSections = remainingSections.map((s) => {\n                        const newSection = s.clone();\n                        newSection.groupID = ID;\n                        return newSection;\n                    });\n                    if (j > 0) {\n                        const candidates = [];\n                        const scoreMatrixBuffer = pathExtraction.createScoreMatrixBuffer(pathSSM.getSampleAmount());\n                        remainingSections.forEach((section) => {\n                            const startInSamples = Math.floor(section.start / pathSSM.sampleDuration);\n                            const endInSamples = Math.floor(section.end / pathSSM.sampleDuration);\n                            candidates.push(\n                                createCandidate(pathSSM, startInSamples, endInSamples, scoreMatrixBuffer, strategy, ID)\n                            );\n                        });\n                        candidates.sort((a, b) => b.fitness - a.fitness);\n\n                        let repeats = 0;\n                        while (remainingSections.length > 0 && repeats < 1) {\n                            repeats++;\n                            const candidate = candidates.shift();\n                            const subPathFamily = getPathFamily(candidate, sampleDuration, ID);\n                            const extendedSubPathFamily = getExtendedPathFamily(\n                                candidate,\n                                sampleDuration,\n                                ID,\n                                pathSSM,\n                                strategy\n                            );\n                            const nonOverlappingExtendedSubPathFamily = addNonOverlapping(\n                                subPathFamily,\n                                extendedSubPathFamily\n                            );\n                            const subFamily = pruneLowConfidence(nonOverlappingExtendedSubPathFamily, 0.1);\n\n                            subStructureSections.push(...subFamily);\n                            remainingSections = subtractSegments(remainingSections, subStructureSections);\n                            remainingSections = remainingSections.filter(\n                                (section) => section.end - section.start >= minDurationSeconds\n                            );\n                        }\n                    } else {\n                        subStructureSections.push(...remainingSections);\n                    }\n\n                    ID++;\n                }\n                break;\n            }\n        } while (subStructureSection && j < 10);\n    }\n    subStructureSections = sortGroupByCoverage(subStructureSections);\n    return [subStructureSections, ID];\n}\n\nexport function findSubstructure(\n    pathSSM,\n    courseSections,\n    maxDurationSeconds,\n    minDurationSeconds,\n    minFitness,\n    strategy = \"fine\"\n) {\n    const soloSSM = SSM.muteAnd(pathSSM, courseSections);\n\n    const maxSubSizeSamples = Math.floor(maxDurationSeconds / pathSSM.sampleDuration);\n    const minSubSizeSamples = Math.floor(minDurationSeconds / pathSSM.sampleDuration);\n    if (maxSubSizeSamples < minSubSizeSamples) return;\n    const step = 1;\n\n    const scoreMatrixBuffer = pathExtraction.createScoreMatrixBuffer(pathSSM.getSampleAmount());\n\n    const candidates = [];\n    courseSections.forEach((section) => {\n        const startInSamples = Math.floor(section.start / pathSSM.sampleDuration);\n        const endInSamples = Math.floor(section.end / pathSSM.sampleDuration);\n\n        for (let start = startInSamples; start < endInSamples - maxSubSizeSamples; start += step) {\n            for (let duration = 1; duration < maxSubSizeSamples; duration += step) {\n                candidates.push(\n                    createCandidate(soloSSM, start, start + duration, scoreMatrixBuffer, strategy, section.groupID)\n                );\n            }\n        }\n    });\n    // Assume that if the groupsections are same amount as subfamily, the subfamily is just pointing out largest fraction of groupsection\n    const candidatesFiltered = candidates.filter(\n        (c) => c.pathFamily.length !== courseSections.length && c.fitness >= minFitness\n    );\n    const candidatesSorted = candidatesFiltered.sort(fitnessSort);\n    let best = candidatesSorted.shift();\n    if (best === undefined) {\n        return null;\n    }\n    if (best.end - best.start < minDurationSeconds) {\n        return null;\n    }\n\n    return best;\n}\n\n// Structure is not sorted, structuresegments is\nconst wiggle = true;\nconst wiggleSize = 3;\nexport function findGreedyDecomposition(\n    pathSSM,\n    structureSegments,\n    sampleDuration,\n    strategy = \"classic\",\n    comparisonProperty = \"fitness\",\n    minDurationSeconds = 2,\n    minFitness = 0.1\n) {\n    const trackEnd = structureSegments[structureSegments.length - 1].end;\n    let structureSections = [];\n    const segments = [];\n    let separateSegmentSets = [structureSegments];\n\n    let i = 0;\n    const maxRepeats = 14;\n    while (separateSegmentSets.length > 0 && i < maxRepeats) {\n        let separateCandidateSets = computeSeparateStructureCandidates(\n            pathSSM,\n            separateSegmentSets,\n            strategy,\n            minDurationSeconds\n        );\n        const allCandidates = [].concat.apply([], separateCandidateSets);\n        if (allCandidates.length === 0) {\n            break;\n        }\n        const allCandidatesSorted = allCandidates.sort(fitnessSort);\n\n        let best = allCandidatesSorted.shift();\n        const initialFitness = best.fitness;\n        if (wiggle) {\n            best = findBetterFit(\n                pathSSM,\n                best,\n                wiggleSize,\n                comparisonProperty,\n                strategy,\n                structureSections,\n                minDurationSeconds\n            );\n        }\n        if (best === null || best[comparisonProperty] <= minFitness || isNaN(best[comparisonProperty])) {\n            break;\n        }\n        const groupID = i;\n        best.groupID = groupID;\n\n        const pathFamily = getPathFamily(best, sampleDuration, groupID);\n        const extendedPathFamily = getExtendedPathFamily(best, sampleDuration, groupID, pathSSM, strategy);\n        const nonOverlappingExtendedPathFamily = addNonOverlapping(pathFamily, extendedPathFamily);\n        const prunedPaths = pruneLowConfidence(nonOverlappingExtendedPathFamily, 0.1);\n        prunedPaths.forEach((path) => {\n            path.normalizedScore = best.normalizedScore;\n            path.normalizedCoverage = best.normalizedCoverage;\n            path.fitness = best.fitness;\n            path.initFitness = initialFitness;\n        });\n        structureSections.push(...prunedPaths);\n\n        // sort structuresections\n        structureSections = structureSections.sort((a, b) => (a.start > b.start ? 1 : -1));\n\n        separateSegmentSets = subtractStructureFromSegments(\n            _.cloneDeep(separateSegmentSets),\n            structureSections,\n            trackEnd,\n            minDurationSeconds\n        );\n        const allSegments = [].concat.apply([], separateSegmentSets);\n        allSegments.forEach((segment) => (segment.groupID = i));\n        segments.push(...allSegments);\n        i++;\n    }\n    return [structureSections, i, segments];\n}\n\nfunction getPathFamily(section, sampleDuration, groupID) {\n    const pathFamilySections = [];\n    if (!section.pathFamily) return [];\n    section.pathFamily.forEach((path, index) => {\n        const start = path[path.length - 1][1] * sampleDuration;\n        const end = (path[0][1] + 1) * sampleDuration;\n        const pathConfidence = section.pathFamilyScores ? section.pathFamilyScores[index] : section.pathScores[index];\n        const newSection = new Section({ start, end, groupID, confidence: pathConfidence });\n        /*if (!isSameSectionWithinError(best, section, 2)) {\n        // This is debatable, we might want to show this (why it got high fitness to begin with)\n        //if (!overlapWithStructureSections(section, structureSections)) {\n        structureSections.push(section);\n        //}\n    } else {\n        // It's the best path itself, but use the segment defined by the coverage in the path family\n        best.start = start;\n        best.end = end;\n        best.confidence = 1;\n        structureSections.push(best);\n    }*/\n        newSection.pathFamily = section.pathFamily;\n        pathFamilySections.push(newSection);\n    });\n    return pathFamilySections;\n}\n\n// multiply confidence?\n// includes regular family\nfunction getExtendedPathFamily(section, sampleDuration, groupID, pathSSM, strategy) {\n    const scoreMatrixBuffer = pathExtraction.createScoreMatrixBuffer(pathSSM.getSampleAmount());\n\n    const pathFamilySections = [];\n    section.pathFamily.forEach((path, index) => {\n        const start = path[path.length - 1][1] * sampleDuration;\n        const end = (path[0][1] + 1) * sampleDuration;\n        const pathConfidence = section.pathFamilyScores ? section.pathFamilyScores[index] : section.pathScores[index];\n\n        const newSection = new Section({ start, end, groupID, confidence: pathConfidence });\n\n        newSection.pathFamily = section.pathFamily;\n        pathFamilySections.push(newSection);\n    });\n\n    pathFamilySections.forEach((familySection) => {\n        const startInSamples = Math.floor(familySection.start / sampleDuration);\n        const endInSamples = Math.floor(familySection.end / sampleDuration);\n\n        const pathFamilyInfo = pathExtraction.computeSegmentPathFamilyInfo(\n            pathSSM,\n            startInSamples,\n            endInSamples,\n            scoreMatrixBuffer,\n            strategy\n        );\n        pathFamilyInfo.pathFamily.forEach((path, index) => {\n            const start = path[path.length - 1][1] * sampleDuration;\n            const end = (path[0][1] + 1) * sampleDuration;\n\n            const newSection = new Section({\n                start,\n                end,\n                groupID,\n                confidence: familySection.confidence * pathFamilyInfo.pathScores[index],\n            });\n\n            newSection.pathFamily = section.pathFamily;\n            pathFamilySections.push(newSection);\n        });\n    });\n\n    return pathFamilySections;\n}\n\nfunction pruneLowConfidence(sections, minConfidence) {\n    const prunedSections = [];\n    sections.forEach((section) => {\n        if (section.confidence >= minConfidence) prunedSections.push(section);\n    });\n    return prunedSections;\n}\n\nfunction addNonOverlapping(sectionsA, sectionsB, overlapRatioThreshold = 0) {\n    const allSections = [...sectionsA];\n\n    const sortedSectionsB = sectionsB.sort((a, b) => (a.confidence > b.confidence ? 1 : -1));\n\n    sortedSectionsB.forEach((sectionB) => {\n        let mostOverlapRatio = 0;\n        allSections.forEach((sectionA) => {\n            if (sectionA.overlaps(sectionB)) {\n                const durationA = sectionA.end - sectionA.start;\n                const durationB = sectionB.end - sectionB.start;\n                const overlap = computeOverlapSize(sectionA, sectionB);\n                const overlapRatio = overlap / (durationA + durationB);\n                if (overlapRatio > mostOverlapRatio) {\n                    mostOverlapRatio = overlapRatio;\n                }\n            }\n        });\n        if (mostOverlapRatio > 0 && mostOverlapRatio < overlapRatioThreshold) {\n            allSections.push(sectionB);\n        } else if (mostOverlapRatio <= 0) {\n            allSections.push(sectionB);\n        }\n    });\n\n    return allSections;\n}\n\nfunction mergeOverlap(sections) {\n    const mergedSections = [];\n\n    sections.forEach((section) => {\n        let indexToMergeWith = 0;\n        const hasToMerge = mergedSections.some((mergedSection, index) => {\n            // merge if middle is in section?\n            if (section.overlaps(mergedSection)) {\n                indexToMergeWith = index;\n                return true;\n            }\n        });\n        if (hasToMerge) {\n            mergedSections[indexToMergeWith] = mergeSection(mergedSections[indexToMergeWith], section);\n        } else {\n            mergedSections.push(section);\n        }\n    });\n\n    let overlapFound = true;\n    let timeout = 1000;\n    while (overlapFound || timeout < 0) {\n        let overlapIndexA = 0;\n        let overlapIndexB = 0;\n        overlapFound = mergedSections.some((sectionA, indexA) => {\n            return mergedSections.some((sectionB, indexB) => {\n                if (sectionA.overlaps(sectionB) && sectionA !== sectionB) {\n                    overlapIndexA = indexA;\n                    overlapIndexB = indexB;\n                    return true;\n                }\n            });\n        });\n        if (overlapFound) {\n            const sectionA = mergedSections[overlapIndexA];\n            const sectionB = mergedSections[overlapIndexB];\n            const mergedSection = mergeSection(sectionA, sectionB);\n            mergedSections.splice(overlapIndexB, 1);\n            mergedSections[overlapIndexA] = mergedSection;\n        }\n        timeout--;\n    }\n\n    return mergedSections;\n}\n\nfunction mergeSection(sectionA, sectionB) {\n    const start = Math.min(sectionA.start, sectionB.start);\n    const end = Math.max(sectionA.end, sectionB.end);\n    return new Section({ start, end, groupID: sectionA.groupID, confidence: sectionA.confidence });\n}\n\nfunction findBetterFit(\n    pathSSM,\n    section,\n    sampleOffset = 4,\n    comparisonProperty,\n    strategy,\n    structureSections = [],\n    minDurationSeconds\n) {\n    const sampleAmount = pathSSM.getSampleAmount();\n    const sampleDuration = pathSSM.sampleDuration;\n\n    const startInSamples = Math.floor(section.start / sampleDuration);\n    const endInSamples = Math.floor(section.end / sampleDuration);\n\n    const scoreMatrixBuffer = pathExtraction.createScoreMatrixBuffer(sampleAmount);\n    let max = section[comparisonProperty];\n    let bestFit = section;\n\n    for (let startOffset = -sampleOffset; startOffset < sampleOffset; startOffset++) {\n        for (let endOffset = -sampleOffset; endOffset < sampleOffset; endOffset++) {\n            const start = startInSamples + startOffset;\n            const end = endInSamples + endOffset;\n\n            const startInSeconds = start * sampleDuration;\n            const endInSeconds = end * sampleDuration;\n            // TODO: also check for overlap with existing sections\n\n            if (\n                start >= 0 &&\n                end < sampleAmount &&\n                endInSeconds - startInSeconds >= minDurationSeconds &&\n                (allowOverlap ||\n                    !overlapWithStructureSections({ start: startInSeconds, end: endInSeconds }, structureSections))\n            ) {\n                const segmentPathFamilyInfo = pathExtraction.computeSegmentPathFamilyInfo(\n                    pathSSM,\n                    start,\n                    end,\n                    scoreMatrixBuffer,\n                    strategy\n                );\n\n                segmentPathFamilyInfo.start = start * sampleDuration;\n                segmentPathFamilyInfo.end = end * sampleDuration;\n\n                if (segmentPathFamilyInfo[comparisonProperty] > max) {\n                    // TODO: log how the max moves (maybe it needs more offset to reach optimum)\n                    bestFit = segmentPathFamilyInfo;\n                    max = segmentPathFamilyInfo[comparisonProperty];\n                }\n            }\n        }\n    }\n\n    return bestFit;\n}\n\nfunction overlapWithStructureSections(section, structureSections) {\n    return structureSections.some((structureSection) => {\n        if (section.overlaps(structureSection)) return true;\n    });\n}\n\nfunction subtractStructureFromSegments(separateSegmentSets, sortedStructureSections, trackEnd, smallestAllowedSize) {\n    let newSeparateSegmentSets = [];\n    const allSegments = [].concat.apply([], separateSegmentSets);\n\n    const freeRanges = getFreeRanges(sortedStructureSections, trackEnd, smallestAllowedSize);\n    freeRanges.forEach((range) => {\n        const rangeStart = range[0];\n        const rangeEnd = range[1];\n        let segmentSet = [];\n\n        let previousBorder = rangeStart;\n        allSegments.forEach((segment) => {\n            if (segment.start > previousBorder && segment.start < rangeEnd) {\n                segmentSet.push(\n                    new Section({\n                        start: previousBorder,\n                        end: segment.start,\n                    })\n                );\n                previousBorder = segment.start;\n            }\n        });\n        segmentSet.push(\n            new Section({\n                start: previousBorder,\n                end: rangeEnd,\n            })\n        );\n        newSeparateSegmentSets.push(segmentSet);\n    });\n\n    return newSeparateSegmentSets;\n}\n\nfunction getFreeRangesNonOverlapping(structureSections, trackEnd, smallestAllowedSize) {\n    const freeRanges = [];\n    let previousEnd = 0;\n    structureSections.forEach((section) => {\n        freeRanges.push([previousEnd, section.start]);\n        previousEnd = section.end;\n    });\n    freeRanges.push([previousEnd, trackEnd]);\n    return freeRanges.filter((range) => range[1] - range[0] >= smallestAllowedSize);\n}\n\nfunction getFreeRanges(structureSections, trackEnd, smallestAllowedSize) {\n    const freeRanges = [[0, trackEnd]];\n    structureSections.forEach((section) => {\n        freeRanges.forEach((range, rangeIndex) => {\n            const rangeStart = range[0];\n            const rangeEnd = range[1];\n            // if range is encapsulated by section, remove\n            if (rangeStart >= section.start && rangeEnd <= section.end) {\n                freeRanges.splice(rangeIndex, 1);\n                return;\n            }\n            // if range overlaps section on left, cut range short, clip end\n            if (rangeStart <= section.start && rangeEnd > section.start && rangeEnd <= section.end) {\n                range[1] = section.start;\n                return;\n            }\n            // if range overlaps section on right, cut range short, clip start\n            if (rangeStart < section.end && rangeEnd >= section.start && rangeStart >= section.start) {\n                range[0] = section.end;\n                return;\n            }\n            // if range encapsulates section, cut range in half\n            if (rangeStart < section.start && rangeEnd > section.end) {\n                freeRanges.push([rangeStart, section.start]);\n                freeRanges.push([section.end, rangeEnd]);\n                freeRanges.splice(rangeIndex, 1);\n                return;\n            }\n        });\n    });\n    return freeRanges.filter((range) => range[1] - range[0] >= smallestAllowedSize);\n}\n\n/**\n * Picks highest similarity pair, groupIDs segments not yet groupIDed, repeat\n * @param {*} segments\n */\nexport function groupSimilarSegments(segments, pathSSM, maxDistance = 0.8) {\n    const groupedSegments = _.cloneDeep(segments);\n    groupedSegments.forEach((segment) => {\n        delete segment.groupID;\n        segment.confidence = 1;\n    });\n\n    let groupIDed = 0;\n    let newGroupID = 0;\n    while (groupIDed < segments.length) {\n        let minDistance = Number.POSITIVE_INFINITY;\n        let bestSegmentA = null;\n        let bestSegmentB = null;\n        groupedSegments.forEach((segmentA) => {\n            groupedSegments.forEach((segmentB) => {\n                if ((segmentA.groupID === undefined || segmentB.groupID === undefined) && segmentA !== segmentB) {\n                    const distance = pathExtraction.getDistanceBetween(segmentA, segmentB, pathSSM);\n                    if (distance < minDistance) {\n                        minDistance = distance;\n                        bestSegmentA = segmentA;\n                        bestSegmentB = segmentB;\n                    }\n                }\n            });\n        });\n        if (!bestSegmentA || !bestSegmentB) {\n            break;\n        }\n        if (minDistance > maxDistance) {\n            if (bestSegmentA.groupID === undefined && bestSegmentB.groupID === undefined) {\n                bestSegmentA.groupID = newGroupID;\n                newGroupID++;\n                bestSegmentB.groupID = newGroupID;\n            } else if (bestSegmentA.groupID === undefined) {\n                bestSegmentA.groupID = newGroupID;\n            } else if (bestSegmentB.groupID === undefined) {\n                bestSegmentB.groupID = newGroupID;\n            }\n            newGroupID++;\n        } else {\n            if (bestSegmentA.groupID === undefined && bestSegmentB.groupID === undefined) {\n                bestSegmentA.groupID = newGroupID;\n                bestSegmentB.groupID = newGroupID;\n                newGroupID++;\n            } else if (bestSegmentA.groupID === undefined) {\n                bestSegmentA.groupID = bestSegmentB.groupID;\n                bestSegmentA.confidence = 1 - minDistance;\n            } else if (bestSegmentB.groupID === undefined) {\n                bestSegmentB.groupID = bestSegmentA.groupID;\n                bestSegmentB.confidence = 1 - minDistance;\n            }\n        }\n    }\n    return groupedSegments;\n}\n\nexport function MDSColorSegments(segments, pathSSM, strategy = \"overlap\", coloringStrategy, colorBoth = false) {\n    if (segments.length === 0) return segments;\n\n    const distanceMatrix = pathExtraction.getDistanceMatrix(segments, pathSSM, strategy);\n    const segmentsColored = MDSColorGivenDistanceMatrix(segments, distanceMatrix, coloringStrategy);\n\n    if (colorBoth) {\n        const distanceMatrixCategorical = pathExtraction.getDistanceMatrix(segments, pathSSM, strategy, 0);\n        const segmentsColoredCategorical = MDSColorGivenDistanceMatrix(\n            segments,\n            distanceMatrixCategorical,\n            coloringStrategy\n        );\n\n        for (let i = 0; i < segmentsColored.length; i++) {\n            segmentsColored[i].catColorAngle = segmentsColoredCategorical[i].colorAngle;\n            segmentsColored[i].catColorRadius = segmentsColoredCategorical[i].colorRadius;\n            segmentsColored[i].catMdsFeature = segmentsColoredCategorical[i].mdsFeature;\n        }\n    }\n\n    return segmentsColored;\n}\n\nexport function MDSColorSegmentsPerGroup(segments, pathSSM, strategy = \"overlap\", coloringStrategy) {\n    if (segments.length === 0) return segments;\n\n    const segmentGroups = [];\n    segments.forEach((segment) => {\n        if (!segmentGroups[segment.groupID]) {\n            segmentGroups[segment.groupID] = [];\n        }\n        segmentGroups[segment.groupID].push(segment);\n    });\n\n    const coloredSegments = [];\n    segmentGroups.forEach((segmentGroup) => {\n        const distanceMatrix = pathExtraction.getDistanceMatrix(segmentGroup, pathSSM, strategy);\n        const distanceMatrixPlus = new HalfMatrix({\n            size: segmentGroup.length + 1,\n            numberType: HalfMatrix.NumberType.FLOAT32,\n        });\n        distanceMatrixPlus.fill((x, y) => {\n            if (x >= segmentGroup.length || y >= segmentGroup.length) {\n                if (x === y) {\n                    return 0;\n                }\n                return 1;\n            }\n            return Math.pow(distanceMatrix.getValue(x, y), 4);\n        });\n        const groupSegmentsColored = MDSColorGivenDistanceMatrix(segmentGroup, distanceMatrix, coloringStrategy);\n        coloredSegments.push(...groupSegmentsColored);\n    });\n    return coloredSegments;\n}\n\nexport function MDSColorGivenDistanceMatrix(segments, distanceMatrix, coloringStrategy) {\n    const coloredSegments = [];\n    const MdsCoordinates = mds.getMDSCoordinates(distanceMatrix, coloringStrategy);\n\n    const MdsFeature = mds.getMDSFeature(distanceMatrix);\n\n    segments.forEach((segment, index) => {\n        const [angle, radius] = mds.getAngleAndRadius(MdsCoordinates[index]);\n        const newSegment = segment.clone();\n        newSegment.colorAngle = angle;\n        newSegment.colorRadius = radius;\n        newSegment.mdsFeature = MdsFeature[index];\n        coloredSegments.push(newSegment);\n    });\n\n    // sort from small to high\n    coloredSegments.sort((a, b) => {\n        return a.colorAngle > b.colorAngle ? 1 : b.colorAngle > a.colorAngle ? -1 : 0;\n    });\n\n    let largestGap = 1 - coloredSegments[coloredSegments.length - 1].colorAngle + coloredSegments[0].colorAngle;\n    let largestGapAngle = coloredSegments[0].colorAngle;\n    for (let i = 1; i < coloredSegments.length; i++) {\n        const gap = coloredSegments[i].colorAngle - coloredSegments[i - 1].colorAngle;\n        if (gap > largestGap) {\n            largestGap = gap;\n            largestGapAngle = coloredSegments[i].colorAngle;\n        }\n    }\n\n    coloredSegments.forEach((segment) => {\n        segment.colorAngle = (1 + (segment.colorAngle - largestGapAngle)) % 1;\n    });\n\n    // sort by family and start time\n    coloredSegments.sort((a, b) => {\n        return a.groupID > b.groupID ? 1 : b.groupID > a.groupID ? -1 : a.start - b.start;\n    });\n\n    return coloredSegments;\n}\n\nexport function MDSIntuitionFlip(coloredSamples, timbreFeatures) {\n    const loudness = similarity.correlate(\n        coloredSamples,\n        timbreFeatures.map((val) => val[0])\n    );\n    const darkness = similarity.correlate(\n        coloredSamples,\n        timbreFeatures.map((val) => val[1])\n    );\n    const mids = similarity.correlate(\n        coloredSamples,\n        timbreFeatures.map((val) => val[2])\n    );\n    const attack = similarity.correlate(\n        coloredSamples,\n        timbreFeatures.map((val) => val[3])\n    );\n\n    log.debug(\"loudness\", loudness, \"darkness\", darkness, \"mids\", mids, \"attack\", attack);\n\n    if (Math.sign(loudness) < 0) {\n        return coloredSamples;\n    }\n\n    // By default the graph should display high loudness as high value\n    if (Math.sign(loudness) > 0) {\n        return coloredSamples.map((val) => 1 - val);\n    }\n\n    // If graph depicts mostly darkness, we want bright sounds to have a high value\n    /*if (Math.sign(darkness) > 0 && Math.abs(darkness) > 2 * Math.abs(loudness)) {\n        return coloredSamples.map((val) => 1 - val);\n    }*/\n\n    return coloredSamples;\n}\n\nexport function computeOverlapSize(a, b) {\n    if (a.start <= b.start && a.end > b.start) return a.end - b.start;\n    if (b.start <= a.start && b.end > a.start) return b.end - a.start;\n    if (a.start < b.start && a.end >= b.end) return b.end - b.start;\n    if (b.start < a.start && b.end >= a.end) return a.end - a.start;\n    if (a.start >= b.start && a.end <= b.end) return a.end - a.start;\n    if (b.start >= a.start && b.end <= a.end) return b.end - b.start;\n    return 0;\n}\n\nexport function disjoint(a, b) {\n    return a.start >= b.end || a.end <= b.start;\n}\n\nexport function isSameSectionWithinError(a, b, errorInSamples) {\n    const middleA = a.start + a.getDuration() / 2;\n    const middleB = b.start + b.getDuration() / 2;\n    return Math.abs(middleB - middleA) < errorInSamples;\n}\n\nexport function fillGapSingle(squashedSections, section) {\n    let newSection = section.clone();\n\n    // If any of the squashed sections will split or completely cover the section, don't add it\n    squashedSections.forEach((squashedSection) => {\n        if (squashedSection.splits(section)) return squashedSections;\n        if (squashedSection.covers(section)) return squashedSections;\n    });\n\n    // Cut off the ends\n    squashedSections.forEach((squashedSection) => {\n        if (squashedSection.splits(newSection)) return squashedSections;\n        if (squashedSection.covers(newSection)) return squashedSections;\n        newSection = newSection.subtract(squashedSection);\n    });\n\n    squashedSections.push(newSection);\n    return squashedSections;\n}\n\nexport function squash(strategy, sections, groupAmount, minSize = 2) {\n    const squashed = [];\n    const maxGroups = 10;\n\n    for (let i = 0; i < groupAmount && i < maxGroups; i++) {\n        const groupIDSections = sections.filter((section) => section.groupID === i);\n        groupIDSections.forEach((groupSection) => {\n            if (strategy === \"no-overlap\") {\n                const overlap = squashed.some((squashedSection) => {\n                    if (groupSection.overlaps(squashedSection)) return true;\n                });\n                if (!overlap) {\n                    squashed.push(groupSection);\n                }\n            } else if (strategy === \"overwrite\") {\n                let overlap = false;\n                squashed.forEach((squashedSection, index) => {\n                    if (groupSection.overlaps(squashedSection) && squashedSection !== groupSection) {\n                        overlap = true;\n                        if (\n                            squashedSection.start < groupSection.start &&\n                            squashedSection.end > groupSection.end &&\n                            groupSection.confidence > squashedSection.confidence\n                        ) {\n                            // split squashed\n                            const squashedSectionBefore = squashedSection.clone();\n                            const squashedSectionAfter = squashedSection.clone();\n                            squashedSectionBefore.end = groupSection.start;\n                            squashedSectionAfter.start = groupSection.end;\n                            squashed[index] = squashedSectionBefore;\n                            squashed.push(squashedSectionAfter);\n                            squashed.push(groupSection.clone());\n                        } else if (\n                            squashedSection.start < groupSection.start &&\n                            squashedSection.end > groupSection.start &&\n                            squashedSection.end <= groupSection.end &&\n                            groupSection.confidence > squashedSection.confidence\n                        ) {\n                            // groupID cuts off squashed end\n                            squashedSection.end = groupSection.start;\n                            squashed.push(groupSection.clone());\n                        } else if (\n                            groupSection.start <= squashedSection.start &&\n                            groupSection.end > squashedSection.start &&\n                            groupSection.end < squashedSection.end &&\n                            groupSection.confidence > squashedSection.confidence\n                        ) {\n                            // groupID cuts off squashed start\n                            squashedSection.start = groupSection.end;\n                            squashed.push(groupSection.clone());\n                        } else if (\n                            groupSection.start < squashedSection.start &&\n                            groupSection.end > squashedSection.end\n                        ) {\n                            // groupID is bigger than squashed  TBD\n                        }\n                    }\n                });\n                if (!overlap) {\n                    squashed.push(groupSection.clone());\n                }\n            } else if (strategy === \"smart-overwrite\") {\n                squashed.forEach((squashedSection) => {\n                    if (groupSection.overlaps(squashedSection)) {\n                        // align ends\n                        if (squashedSection.start < groupSection.start && squashedSection.end > groupSection.end) {\n                            // split squashed\n                        }\n                    }\n                });\n            } else if (strategy === \"fill-gap\") {\n                fillGapSingle(squashed, groupSection);\n            } else if (strategy === \"fill-gap-old\") {\n                let thereIsSpace = true;\n                const newGroupSection = groupSection.clone();\n                squashed.forEach((squashedSection, index) => {\n                    if (groupSection.overlaps(squashedSection) && squashedSection !== groupSection) {\n                        if (squashedSection.start < groupSection.start && squashedSection.end > groupSection.end) {\n                            // no gap\n                            thereIsSpace = false;\n                        } else if (\n                            squashedSection.start < groupSection.start &&\n                            squashedSection.end > groupSection.start &&\n                            squashedSection.end <= groupSection.end\n                        ) {\n                            // groupID is cut off by squashed end\n                            newGroupSection.start = squashedSection.end;\n                        } else if (\n                            groupSection.start <= squashedSection.start &&\n                            groupSection.end > squashedSection.start &&\n                            groupSection.end < squashedSection.end\n                        ) {\n                            // groupID is cut off by squashed start\n                            newGroupSection.end = squashedSection.start;\n                        } else if (\n                            groupSection.start < squashedSection.start &&\n                            groupSection.end > squashedSection.end\n                        ) {\n                            // groupID is bigger than squashed  TBD\n                            thereIsSpace = false;\n                        }\n                    }\n                    if (newGroupSection.end <= newGroupSection.start) {\n                        thereIsSpace = false;\n                    }\n                });\n                if (thereIsSpace && newGroupSection.end - newGroupSection.start > minSize) {\n                    squashed.push(newGroupSection);\n                }\n            }\n        });\n    }\n\n    return squashed;\n}\n\nexport function MDSColorTimbreSegmentsWithSSM(blurredTimbreSSM, segments) {\n    const amount = segments.length;\n    const distanceMatrix = new HalfMatrix({ size: amount, numberType: HalfMatrix.NumberType.FLOAT32 });\n\n    const segmentVectors = [];\n    segments.forEach((segment) => {\n        const middleSeconds = segment.start + segment.getDuration() / 2;\n        const middleSample = Math.floor(middleSeconds / blurredTimbreSSM.getSampleDuration());\n        const segmentVector = blurredTimbreSSM.getColumnNormalized(middleSample);\n        segmentVectors.push(segmentVector);\n    });\n\n    distanceMatrix.fill((x, y) => {\n        return similarity.euclidianTimbre(segmentVectors[x], segmentVectors[y]);\n    });\n\n    return MDSColorGivenDistanceMatrix(segments, distanceMatrix);\n}\n\nexport function MDSColorTimbreSegmentsWithFeatures(timbreFeatures, segments, sampleDuration, strategy) {\n    const amount = segments.length;\n    const distanceMatrix = new HalfMatrix({ size: amount, numberType: HalfMatrix.NumberType.FLOAT32 });\n\n    const segmentVectors = [];\n    segments.forEach((segment) => {\n        const vector = new Float32Array(12).fill(0);\n\n        const startSample = Math.floor(segment.start / sampleDuration);\n        const endSample = Math.floor(segment.end / sampleDuration);\n        const sampleAmount = endSample - startSample;\n        for (let i = startSample; i < endSample; i++) {\n            for (let f = 0; f < 12; f++) {\n                vector[f] += timbreFeatures[i][f];\n            }\n        }\n        for (let f = 0; f < 12; f++) {\n            vector[f] /= sampleAmount;\n        }\n        segmentVectors.push(vector);\n    });\n\n    distanceMatrix.fill((x, y) => {\n        return 1 - similarity.cosine(segmentVectors[x], segmentVectors[y]);\n    });\n\n    return MDSColorGivenDistanceMatrix(segments, distanceMatrix, strategy);\n}\n\nexport function MDSColorTimbreSamples(timbreFeatures) {\n    const amount = timbreFeatures.length;\n    const distanceMatrix = new HalfMatrix({ size: amount, numberType: HalfMatrix.NumberType.FLOAT32 });\n    distanceMatrix.fill((x, y) => {\n        return 1 - similarity.euclidianTimbre(timbreFeatures[x], timbreFeatures[y]);\n    });\n    //const MdsCoordinates = mds.getMdsCoordinates(distanceMatrix);\n    const MdsFeature = mds.getMDSFeature(distanceMatrix);\n\n    const coloredSamples = [];\n\n    for (let i = 0; i < amount; i++) {\n        coloredSamples.push(MdsFeature[i]);\n    }\n\n    return coloredSamples;\n}\n\nexport function clusterTimbreSegmentsWithFeatures(timbreFeatures, segments, sampleDuration) {\n    const coloredSegments = [];\n\n    const segmentVectors = [];\n    segments.forEach((segment) => {\n        const vector = new Float32Array(12).fill(0);\n\n        const startSample = Math.floor(segment.start / sampleDuration);\n        const endSample = Math.floor(segment.end / sampleDuration);\n        const sampleAmount = endSample - startSample;\n        for (let i = startSample; i < endSample; i++) {\n            for (let f = 0; f < 12; f++) {\n                vector[f] += timbreFeatures[i][f];\n            }\n        }\n        for (let f = 0; f < 12; f++) {\n            vector[f] /= sampleAmount;\n        }\n        segmentVectors.push(vector);\n    });\n    const clusteringResult = clustering.kMeansSearch(segmentVectors, 1, 10, 5);\n\n    segments.forEach((segment, index) => {\n        const cluster = clusteringResult.idxs[index];\n        const newSegment = segment.clone();\n        newSegment.groupID = cluster;\n        newSegment.confidence = 1;\n        coloredSegments.push(newSegment);\n    });\n\n    return coloredSegments;\n}\nexport function processTimbreSegments(timbreFeatures, segments, sampleDuration, strategy) {\n    const mdsColoredSegments = MDSColorTimbreSegmentsWithFeatures(timbreFeatures, segments, sampleDuration, strategy);\n    //log.debug(\"Clustering timbre segments\")\n    //const clusteredSegments = clusterTimbreSegmentsWithFeatures(timbreFeatures, mdsColoredSegments, sampleDuration);\n    //log.debug(\"Clustered timbre segments\")\n    return mdsColoredSegments;\n}\n\nfunction fitnessSort(a, b) {\n    if (a.fitness < b.fitness) {\n        return 1;\n    }\n    if (a.fitness > b.fitness) {\n        return -1;\n    }\n    return 0;\n}\n\nfunction createCandidate(pathSSM, start, end, scoreMatrixBuffer, strategy, groupID) {\n    const segmentPathFamilyInfo = pathExtraction.computeSegmentPathFamilyInfo(\n        pathSSM,\n        start,\n        end,\n        scoreMatrixBuffer,\n        strategy\n    );\n    const startInSeconds = start * pathSSM.sampleDuration;\n    const endInSeconds = end * pathSSM.sampleDuration;\n    const candidate = new Section({ start: startInSeconds, end: endInSeconds, groupID: groupID });\n    candidate.pathFamily = segmentPathFamilyInfo.pathFamily;\n    candidate.pathFamilyScores = segmentPathFamilyInfo.pathScores;\n    candidate.score = segmentPathFamilyInfo.score;\n    candidate.normalizedScore = segmentPathFamilyInfo.normalizedScore;\n    candidate.coverage = segmentPathFamilyInfo.coverage;\n    candidate.normalizedCoverage = segmentPathFamilyInfo.normalizedCoverage;\n    candidate.fitness = segmentPathFamilyInfo.fitness;\n    return candidate;\n}\n\n// Remove B from A\n// Creates new array, doesn't edit A\nexport function subtractSegments(segmentsA, segmentsB) {\n    const newSegmentsA = segmentsA.map((a) => a.clone());\n\n    segmentsB.forEach((b) => {\n        let i = 0;\n        while (i < newSegmentsA.length) {\n            const a = newSegmentsA[i];\n            if (a.overlaps(b)) {\n                if (b.start > a.start && b.end < a.end) {\n                    const leftSize = b.start - a.start;\n                    const rightSize = a.end - b.end;\n                    const keepLeft = leftSize > 0;\n                    const keepRight = rightSize > 0;\n                    if (keepLeft && keepRight) {\n                        const clonedGroupSection = a.clone();\n                        a.end = b.start;\n                        clonedGroupSection.start = b.end;\n                        newSegmentsA.push(clonedGroupSection);\n                    } else if (keepLeft) {\n                        newSegmentsA[i].end = b.start;\n                    } else if (keepRight) {\n                        newSegmentsA[i].start = b.end;\n                    }\n                } else if (b.start > a.start && b.end >= a.end) {\n                    newSegmentsA[i].end = b.start;\n                } else if (b.start <= a.start && b.end < a.end) {\n                    newSegmentsA[i].start = b.end;\n                }\n            }\n\n            if (b.start <= a.start && b.end >= a.end) {\n                newSegmentsA.splice(i, 1);\n            } else {\n                i++;\n            }\n        }\n    });\n\n    return newSegmentsA;\n}\n\nexport function sortGroupByCoverage(sections) {\n    const newSections = [];\n\n    let groupCoverage = [];\n    sections.forEach((section) => {\n        if (groupCoverage[section.groupID] === undefined) {\n            groupCoverage[section.groupID] = { groupID: section.groupID, coverage: section.end - section.start };\n        } else {\n            groupCoverage[section.groupID].coverage += section.end - section.start;\n        }\n    });\n\n    groupCoverage = groupCoverage.sort((a, b) => b.coverage - a.coverage);\n    sections.forEach((section) => {\n        const newGroup = groupCoverage.findIndex((group) => group.groupID === section.groupID);\n        const newSection = section.clone();\n        newSection.groupID = newGroup;\n        newSections.push(newSection);\n    });\n\n    return newSections;\n}\n\nfunction sortGroupByFirstOccuring(sections) {\n    const newSections = [];\n    sections = sections.sort((a, b) => (a.start > b.start ? 1 : -1));\n\n    // index is groupID of new sections\n    const mapping = [];\n    sections.forEach((section) => {\n        let newGroup = mapping.indexOf(section.groupID);\n        if (newGroup === -1) {\n            mapping.push(section.groupID);\n            newGroup = mapping.length - 1;\n        }\n        const newSection = section.clone();\n        newSection.groupID = newGroup;\n        newSections.push(newSection);\n    });\n\n    return newSections;\n}\n\nexport function createSeparators(coloredSegments, pathSSM) {\n    const coloredSegmentsSorted = coloredSegments.sort((a, b) => a.start - b.start);\n    const separators = [];\n\n    for (let i = 0; i < coloredSegments.length; i++) {\n        const segment = coloredSegmentsSorted[i];\n\n        let distanceFromPreviousSegment = 1;\n        if (i > 0) {\n            distanceFromPreviousSegment = pathExtraction.getDistanceBetween(\n                segment,\n                coloredSegmentsSorted[i - 1],\n                pathSSM\n            );\n            const angleDistance = Math.abs(segment.colorAngle - coloredSegmentsSorted[i - 1].colorAngle);\n            distanceFromPreviousSegment = Math.min(angleDistance, 1 - angleDistance) * 2;\n        }\n\n        const separator = {\n            start: segment.start,\n            end: segment.end,\n            duration: segment.end - segment.start,\n            colorAngle: segment.colorAngle,\n            colorRadius: segment.colorRadius,\n            confidence: distanceFromPreviousSegment,\n        };\n        separators.push(separator);\n    }\n\n    return separators;\n}\n","import * as log from \"../dev/log\";\nimport SpotifySegment from \"./SpotifySegment\";\nimport * as chordDetection from \"./chordDetection\";\nimport * as filter from \"./filter\";\nimport { lowerFirst } from \"lodash\";\nimport * as structure from \"./structure\";\nimport * as SSM from \"./SSM\";\nimport * as noveltyDetection from \"./noveltyDetection\";\n\nconst timbreNormalizationAmount = 0.2;\n\nexport default class Features {\n    timbreMax = new Array(12).fill(0);\n    timbreMin = new Array(12).fill(0);\n    timbreBiggest = new Array(12).fill(0);\n    timbreTotalBiggest = 0;\n\n    duration = 0;\n    length = 0;\n    segments = [];\n    segmentStartDuration = [];\n    beatsStartDuration = [];\n    raw = { pitches: [], timbres: [], loudness: [] };\n    processed = {\n        pitches: [],\n        noise: [],\n        timbres: [],\n        loudness: [],\n        avgLoudness: [],\n        dynamics: [],\n        tonalEnergy: [],\n        tonalRadius: [],\n        tonalAngle: [],\n    };\n\n    clusterSelection = [];\n    tsneSelection = [];\n\n    sampleDuration = 0;\n    sampleAmount = 0;\n    sampled = {};\n    sampleStartDuration = [];\n    sampleBlur = 0; // in proportion to duration (<1 is no blur, 2 is blur of twice duration)\n\n    fastSampledPitch = [];\n    fastSampleDuration = 0.1;\n\n    downSampledTimbre = [];\n\n    directLoudnessSampleDuration = 0.25;\n    directLoudnessAmount;\n    directLoudness;\n\n    maxLoudness;\n    averageLoudness;\n\n    dynamicsBase = 0.12;\n\n    constructor(analysisData, options = {}) {\n        this.duration = analysisData.track.duration;\n        analysisData.segments.forEach((segment) => {\n            this.segments.push(new SpotifySegment(segment));\n            this.segmentStartDuration.push([segment.start, segment.duration]);\n        });\n        this.length = this.segments.length;\n        this.sampleAmount = Math.min(Math.ceil(this.duration / options.sampleDuration), options.samples);\n        this.sampleDuration = analysisData.track.duration / this.sampleAmount;\n        log.info(\"Sampling, Amount:\", this.sampleAmount, \"Duration: \", this.sampleDuration);\n        this.sampleBlur = options.sampleBlur || 1;\n        this.fillBeatsStartDuration(analysisData.beats);\n        this.calculateMaxMin();\n        log.debug(this.timbreBiggest);\n        log.debug(\"total biggest timbre\", this.timbreTotalBiggest);\n        this.processSegments();\n        if (this.segments.length) this.processDirectLoudness();\n        this.sampleFeatures();\n        this.processSamples();\n        this.downSampledTimbre = this.downSampleTimbre(options.downsampleAmount);\n        this.fastSampledPitch = this.sample(\"pitches\", { sampleDuration: this.fastSampleDuration });\n\n        const features = this.sampled.timbres;\n        const segmentationSmoothingLength = Math.round(5);\n        const continuousSmoothingLength = Math.round(10);\n\n        const ssmTimbre = SSM.calculateSSM(features, this.sampleDuration);\n        const blurredTimbreLarge = filter.gaussianBlur2DOptimized(ssmTimbre, 5);\n        const timbreNoveltyColumn = noveltyDetection.absoluteEuclideanColumnDerivative(blurredTimbreLarge);\n\n        const segmentationSmoothedFeatures = filter.gaussianBlurFeatures(features, segmentationSmoothingLength);\n        const segmentationDerivative = noveltyDetection.featureDerivative(segmentationSmoothedFeatures);\n        const smoothedSegmentationDerivative = filter.gaussianBlur1D(segmentationDerivative, 5);\n        const segments = structure.createSegmentsFromNovelty(smoothedSegmentationDerivative, this.sampleDuration, 0.2);\n        const averagedColouredSegments = structure.processTimbreSegments(features, segments, this.sampleDuration);\n\n        const segmentedFeatures = [];\n        segments.forEach((segment) => {\n            const featureSegment = features.slice(segment.startSample, segment.endSample);\n            const smoothedFeatureSegment = filter.gaussianBlurFeatures(featureSegment, continuousSmoothingLength);\n            segmentedFeatures.push(smoothedFeatureSegment);\n        });\n\n        log.debug(\"segmentedFeatures\", segmentedFeatures);\n\n        const frankenFeatures = [];\n        segmentedFeatures.forEach((featureSegment) => {\n            frankenFeatures.push(...featureSegment);\n        });\n        this.sampled.smoothedTimbre = segmentationSmoothedFeatures;\n        const medianFeatures = filter.medianFilterFeatures(this.sampled.timbres, 1);\n\n        this.sampled.frankenFeatures = medianFeatures;\n    }\n\n    /**\n     * The values calculated in this function are used to scale the raw features\n     */\n    calculateMaxMin() {\n        this.segments.forEach((segment, index) => {\n            for (let i = 0; i < 12; i++) {\n                this.timbreMax[i] = Math.max(this.timbreMax[i], segment.getOriginalTimbres()[i]);\n                this.timbreMin[i] = Math.min(this.timbreMin[i], segment.getOriginalTimbres()[i]);\n            }\n        });\n        for (let i = 0; i < 12; i++) {\n            this.timbreBiggest[i] = Math.max(Math.abs(this.timbreMax[i]), Math.abs(this.timbreMin[i]));\n            this.timbreTotalBiggest = Math.max(this.timbreTotalBiggest, this.timbreBiggest[i]);\n        }\n    }\n\n    fillBeatsStartDuration(beats) {\n        beats.forEach((beat) => {\n            this.beatsStartDuration.push([beat.start, beat.duration]);\n        });\n    }\n\n    processSegments() {\n        this.segments.forEach((s, i) => {\n            this.raw.pitches[i] = s.segment.pitches;\n            this.raw.timbres[i] = s.segment.timbre;\n            this.raw.loudness[i] = s.getLoudnessFeatures();\n            s.processPitch();\n\n            this.processed.pitches.push(s.pitches);\n            this.processed.noise.push(s.noise);\n\n            this.processed.loudness.push(s.getLoudnessFeatures());\n            const nextSegmentStartLoudness =\n                i + 1 < this.segments.length ? this.segments[i + 1].getLoudnessFeatures()[0] : 0;\n            this.processed.avgLoudness.push(s.getAverageLoudness(nextSegmentStartLoudness));\n            this.processed.dynamics.push(s.getAverageLoudness(nextSegmentStartLoudness));\n\n            s.processTimbre(this.timbreMin, this.timbreMax, this.timbreBiggest, this.timbreTotalBiggest);\n            const timbres = [];\n            for (let t = 0; t < 12; t++) {\n                if (t === 0) {\n                    // replace by loudnes\n                    const timbre = this.processed.avgLoudness[this.processed.avgLoudness.length - 1] - 0.5;\n                    timbres.push(timbre);\n                } else {\n                    const timbre =\n                        (1 - timbreNormalizationAmount) * s.timbres[t] + timbreNormalizationAmount * s.timbresScaled[t];\n                    timbres.push(timbre);\n                }\n            }\n            this.processed.timbres.push(timbres);\n\n            this.processed.tonalEnergy.push(s.tonalityEnergy);\n            this.processed.tonalRadius.push(s.tonalityRadius);\n            this.processed.tonalAngle.push(s.tonalityAngle);\n        });\n\n        for (let i = 0; i < this.segments.length; i++) {\n            // Try to remove percussion from pitch features\n            if (i > 0 && i < this.segments.length - 1) {\n                this.segments[i].processPitchSmooth(this.segments[i - 1], this.segments[i + 1]);\n            }\n\n            // Create feature selections\n            this.clusterSelection.push([\n                ...this.processed.timbres[i],\n                this.processed.tonalEnergy[i],\n                this.processed.tonalRadius[i],\n                ...this.processed.loudness[i],\n            ]);\n            this.tsneSelection.push([\n                ...this.processed.timbres[i],\n                this.processed.tonalEnergy[i],\n                this.processed.tonalRadius[i],\n                ...this.processed.loudness[i],\n            ]);\n        }\n    }\n\n    processDirectLoudness() {\n        this.directLoudnessAmount = Math.floor(this.duration / this.directLoudnessSampleDuration);\n        this.directLoudness = new Float32Array(this.directLoudnessAmount);\n\n        log.info(\n            \"Process direct loudness\",\n            \"duration\",\n            this.duration,\n            \"segmentAmount\",\n            this.segmentStartDuration.length,\n            \"amount\",\n            this.directLoudnessAmount\n        );\n\n        let segmentIndex = 0;\n        for (let i = 0; i < this.directLoudnessAmount; i++) {\n            const time = this.directLoudnessSampleDuration * i;\n            while (!this.isTimeInSegment(segmentIndex, time)) {\n                segmentIndex++;\n            }\n            this.directLoudness[i] = this.getExactLoudness(segmentIndex, time);\n        }\n    }\n\n    isTimeInSegment(index, time) {\n        const start = this.segmentStartDuration[index][0];\n        const end = start + this.segmentStartDuration[index][1];\n        return time >= start && time < end;\n    }\n\n    getExactLoudness(index, time) {\n        const startLoudness = this.raw.loudness[index][0];\n        const endLoudness = index + 1 < this.segmentStartDuration.length ? this.raw.loudness[index + 1][0] : 0;\n        const startTime = this.segmentStartDuration[index][0];\n        const fraction = (time - startTime) / this.segmentStartDuration[index][1];\n        //return fraction * endLoudness + (1 - fraction) * startLoudness;\n        return this.raw.loudness[index][1];\n    }\n\n    processSamples() {\n        this.sampled.pitches;\n        this.sampled.timbres;\n\n        //this.sampled.pitches = filter.gaussianBlurFeatures(this.sampled.pitches, 4);\n\n        this.sampled.chords = [];\n        this.sampled.majorminor = [];\n        for (let i = 0; i < this.sampleAmount; i++) {\n            this.sampled.chords[i] = chordDetection.getPopChord(this.sampled.pitches[i]);\n            this.sampled.majorminor[i] = chordDetection.getMajorMinorNess(this.sampled.pitches[i]);\n        }\n\n        this.sampled.smoothedAvgLoudness = filter.gaussianBlur1D(this.sampled.avgLoudness, 1);\n        this.averageLoudness = 0;\n        this.maxLoudness = 0;\n        this.sampled.smoothedAvgLoudness.forEach((loudness) => {\n            this.averageLoudness += loudness;\n            if (loudness > this.maxLoudness) {\n                this.maxLoudness = loudness;\n            }\n        });\n        log.debug(\"Maxloudness\", this.maxLoudness);\n        log.debug(this.sampled.dynamics[0]);\n        log.debug(this.sampled.dynamics[0] / this.maxLoudness);\n        log.debug((this.sampled.dynamics[0] / this.maxLoudness) * (1 - this.dynamicsBase) + this.dynamicsBase);\n\n        this.processed.dynamics = this.processed.dynamics.map((dynamic) => {\n            return (dynamic / this.maxLoudness) * (1 - this.dynamicsBase) + this.dynamicsBase;\n        });\n        this.sampled.dynamics = this.sampled.dynamics.map((dynamic) => {\n            return (dynamic / this.maxLoudness) * (1 - this.dynamicsBase) + this.dynamicsBase;\n        });\n        log.debug(this.sampled.dynamics[0]);\n\n        this.averageLoudness /= this.sampled.smoothedAvgLoudness.length;\n    }\n\n    sample(feature, options) {\n        const sampledFeature = [];\n\n        let sampleAmount = 0;\n        let sampleDuration = 0;\n        if (options.sampleDuration) {\n            // make sure the length of the track is divisble by sampleDuration\n            sampleAmount = Math.round(this.duration / options.sampleDuration);\n            sampleDuration = this.duration / sampleAmount;\n        }\n        if (options.sampleAmount) {\n            sampleAmount = options.sampleAmount;\n            sampleDuration = this.duration / sampleAmount;\n        }\n\n        let i = 0;\n        for (let s = 0; s < sampleAmount; s++) {\n            const averageFeature = new Float32Array(12).fill(0);\n\n            const sampleStart = s * sampleDuration;\n            const sampleEnd = (s + 1) * sampleDuration;\n\n            // Sample is contained in segment, simply copy pitch from segment and go to next sample\n            if (this.segments[i].getEnd() > sampleEnd) {\n                averageFeature.forEach((val, f) => (averageFeature[f] = val + this.segments[i][feature][f]));\n                sampledFeature.push(averageFeature);\n                continue;\n            }\n\n            // add part of first segment\n            if (this.segments[i].getEnd() > sampleStart) {\n                const weight = (this.segments[i].getEnd() - sampleStart) / sampleDuration;\n                averageFeature.forEach((val, f) => (averageFeature[f] = val + weight * this.segments[i][feature][f]));\n                i++;\n            }\n\n            // while entire segment is contained in sample\n            while (i < this.segments.length && this.segments[i].getEnd() < sampleEnd) {\n                const weight = this.segments[i].duration / sampleDuration;\n                averageFeature.forEach((val, f) => (averageFeature[f] = val + weight * this.segments[i][feature][f]));\n                i++;\n            }\n\n            // add part of last segment\n            if (i < this.segments.length) {\n                const weight = (sampleEnd - this.segments[i].start) / sampleDuration;\n                averageFeature.forEach((val, f) => (averageFeature[f] = val + weight * this.segments[i][feature][f]));\n            }\n\n            sampledFeature.push(averageFeature);\n        }\n        return sampledFeature;\n    }\n\n    /**\n     * Turn processed features into evenly discretized features int\n     */\n    sampleFeatures() {\n        // Fill sample start duration\n        for (let i = 0; i < this.sampleAmount - 1; i++) {\n            this.sampleStartDuration.push([i * this.sampleDuration, this.sampleDuration]);\n        }\n        // Last sample is shorter\n        const lastSampleStart = (this.sampleAmount - 1) * this.sampleDuration;\n        this.sampleStartDuration.push([lastSampleStart, this.duration - lastSampleStart]);\n        this.initSampleFeatures();\n\n        const blurDuration = this.sampleBlur * this.sampleDuration;\n\n        const blurOutsideSampleDuration = (blurDuration - this.sampleDuration) / 2;\n\n        this.segments.forEach((segment, segmentIndex) => {\n            const segmentEnd = segment.start + segment.duration;\n\n            // calculate range of samples e.g. [2,6] clip by 0 and size\n            const sampleRangeStartIndex = Math.max(\n                0,\n                Math.floor((segment.start - blurOutsideSampleDuration) / this.sampleDuration)\n            );\n            const sampleRangeEndIndex = Math.min(\n                this.sampleAmount - 1,\n                Math.floor((segmentEnd + blurOutsideSampleDuration) / this.sampleDuration)\n            );\n\n            const rangeSize = sampleRangeEndIndex - sampleRangeStartIndex;\n            if (rangeSize >= 1) {\n                // first sample in range\n                const firstSample = this.sampleStartDuration[sampleRangeStartIndex];\n                const sampleBlurEnd = firstSample[0] + firstSample[1] + blurOutsideSampleDuration;\n                const firstSampleOverlap = sampleBlurEnd - segment.start;\n                // firstSampleValue += firstSampleOverlap*segment.value;\n                this.addFeaturesScaled(sampleRangeStartIndex, segmentIndex, firstSampleOverlap);\n            }\n            if (rangeSize >= 1) {\n                // last sample in range\n                const sampleBlurStart = this.sampleStartDuration[sampleRangeEndIndex][0] - blurOutsideSampleDuration;\n                const lastSampleOverlap = segmentEnd - sampleBlurStart;\n                //lastSampleValue += lastSampleOverlap*segment.value;\n                this.addFeaturesScaled(sampleRangeEndIndex, segmentIndex, lastSampleOverlap);\n            }\n            if (rangeSize >= 2) {\n                // every middle sample\n                for (let i = sampleRangeStartIndex + 1; i < sampleRangeEndIndex; i++) {\n                    //sampleValue += segment.duration*segment.value\n                    this.addFeaturesScaled(i, segmentIndex, blurDuration);\n                }\n            }\n            if (rangeSize === 0) {\n                this.addFeaturesScaled(sampleRangeStartIndex, segmentIndex, segment.duration);\n            }\n        });\n\n        // First sample has only blur on right\n        //this.samples[0] /= this.sampleDuration + blurOutsideSampleDuration;\n        this.divideFeatures(0, this.sampleDuration + blurOutsideSampleDuration);\n\n        // Last sample has shorter duration and only blur on left\n        //this.samples[this.sampleAmount-1] /= this.sampleStartDuration[this.sampleAmount-1].duration + blurOutsideSampleDuration;\n        this.divideFeatures(\n            this.sampleAmount - 1,\n            this.sampleStartDuration[this.sampleAmount - 1][1] + blurOutsideSampleDuration\n        );\n\n        for (let i = 1; i < this.sampleAmount - 1; i++) {\n            //this.samples[i] /= blurDuration\n            this.divideFeatures(i, blurDuration);\n        }\n    }\n\n    downSampleTimbre(amount) {\n        const downSampleAmount = amount;\n        const downSampleRatio = this.sampleAmount / (downSampleAmount + 1);\n        const downSampledTimbre = [];\n        for (let i = 0; i < downSampleAmount; i++) {\n            const startIndex = i * downSampleRatio;\n            const endIndex = (i + 1) * downSampleRatio;\n\n            const startSample = Math.floor(startIndex);\n            const startSampleWeight = 1 - (startIndex - startSample);\n            const endSample = Math.floor(endIndex);\n            const endSampleWeight = endIndex - endSample;\n\n            let summedTimbre = new Float32Array(12).fill(0);\n\n            for (let f = 0; f < 12; f++) {\n                summedTimbre[f] += this.sampled.timbres[startSample][f] * startSampleWeight;\n                summedTimbre[f] += this.sampled.timbres[endSample][f] * endSampleWeight;\n            }\n\n            for (let s = startSample + 1; s < endSample; s++) {\n                for (let f = 0; f < 12; f++) {\n                    summedTimbre[f] += this.sampled.timbres[s][f];\n                }\n            }\n\n            for (let f = 0; f < 12; f++) {\n                summedTimbre[f] /= downSampleRatio;\n            }\n\n            downSampledTimbre.push(summedTimbre);\n        }\n        return downSampledTimbre;\n    }\n\n    initSampleFeatures() {\n        for (const featureName in this.processed) {\n            this.sampled[featureName] = new Array(this.sampleAmount).fill(0);\n            const featureSize = this.processed[featureName][0].length;\n\n            if (featureSize) {\n                for (let s = 0; s < this.sampleAmount; s++) {\n                    this.sampled[featureName][s] = new Array(this.processed[featureName][0].length).fill(0);\n                }\n            } else {\n                for (let s = 0; s < this.sampleAmount; s++) {\n                    this.sampled[featureName][s] = 0;\n                }\n            }\n        }\n    }\n\n    setFeaturesScaled(sampleIndex, segmentIndex, scalar) {\n        for (const featureName in this.processed) {\n            const featureSize = this.processed[featureName][0].length;\n            if (featureSize) {\n                for (let i = 0; i < featureSize; i++) {\n                    this.sampled[featureName][sampleIndex][i] = this.processed[featureName][segmentIndex][i] * scalar;\n                }\n            } else {\n                this.sampled[featureName][sampleIndex] = this.processed[featureName][segmentIndex] * scalar;\n            }\n        }\n    }\n\n    addFeaturesScaled(sampleIndex, segmentIndex, scalar) {\n        for (const featureName in this.processed) {\n            const featureSize = this.processed[featureName][0].length;\n            if (featureSize) {\n                for (let i = 0; i < featureSize; i++) {\n                    this.sampled[featureName][sampleIndex][i] += this.processed[featureName][segmentIndex][i] * scalar;\n                }\n            } else {\n                this.sampled[featureName][sampleIndex] += this.processed[featureName][segmentIndex] * scalar;\n            }\n        }\n    }\n\n    divideFeatures(sampleIndex, divisor) {\n        for (const featureName in this.sampled) {\n            const featureSize = this.processed[featureName][0].length;\n            if (featureSize) {\n                for (let i = 0; i < featureSize; i++) {\n                    this.sampled[featureName][sampleIndex][i] /= divisor;\n                }\n            } else {\n                this.sampled[featureName][sampleIndex] /= divisor;\n            }\n        }\n    }\n}\n\nexport function downSample(features, sampleAmount) {\n    const ratio = features.length / sampleAmount;\n    const newFeatures = [];\n    for (let i = 0; i < sampleAmount; i++) {\n        const average = new Float32Array(12);\n        const firstIndex = Math.floor(i * ratio);\n        const firstWeight = 1 - (i * ratio - firstIndex);\n        const lastIndex = Math.floor((i + 1) * ratio);\n        const lastWeight = (i + 1) * ratio - lastIndex;\n\n        if (firstWeight > 0) {\n            for (let f = 0; f < 12; f++) {\n                average[f] += (features[firstIndex][f] * firstWeight) / ratio;\n            }\n        }\n        if (lastWeight > 0) {\n            for (let f = 0; f < 12; f++) {\n                average[f] += (features[lastIndex][f] * lastWeight) / ratio;\n            }\n        }\n\n        //middle\n        for (let j = firstIndex + 1; j < lastIndex; j++) {\n            for (let f = 0; f < 12; f++) {\n                average[f] += features[j][f] / ratio;\n            }\n        }\n        newFeatures.push(average);\n    }\n    return newFeatures;\n}\n","import * as log from \"../dev/log\";\nimport * as d3 from \"d3\";\nimport * as audioUtil from \"./audioUtil\";\n\nimport * as Track from \"./Track\";\n\nconst PHI = (1 + Math.sqrt(5)) / 2;\n\nexport const colorWheel = d3\n    .scaleLinear()\n    .domain([0, 1 / 12, 2 / 12, 3 / 12, 4 / 12, 5 / 12, 6 / 12, 7 / 12, 8 / 12, 9 / 12, 10 / 12, 11 / 12, 1])\n    .interpolate(d3.interpolateHcl)\n    .range([\n        d3.rgb(\"#da321f\"),\n        d3.rgb(\"#e06300\"),\n        d3.rgb(\"#e89b00\"),\n        d3.rgb(\"#ebcb03\"),\n        d3.rgb(\"#9fbb04\"),\n        d3.rgb(\"#2cbe03\"),\n        d3.rgb(\"#03b779\"),\n        d3.rgb(\"#06b3bd\"),\n        d3.rgb(\"#3875cc\"),\n        d3.rgb(\"#7503db\"),\n        d3.rgb(\"#c203ae\"),\n        d3.rgb(\"#e84b90\"),\n        d3.rgb(\"#da321f\"),\n    ]);\n\nexport const zeroOneColor = d3\n    .scaleSequential()\n    .domain([0, 1])\n    .interpolator(d3.interpolateViridis);\nexport const zeroOneColorGreys = d3\n    .scaleSequential()\n    .domain([0, 1])\n    .interpolator(d3.interpolateGreys);\nexport const zeroOneColorGreysDark = d3\n    .scaleLinear()\n    .domain([0, 1])\n    .range([d3.rgb(\"#444444\"), d3.rgb(\"#ffffff\")]);\nexport const zeroOneColorGreysLight = d3\n    .scaleLinear()\n    .domain([0, 1])\n    .range([d3.rgb(\"#000000\"), d3.rgb(\"#cccccc\")]);\nexport const zeroOneColorWarm = d3\n    .scaleSequential()\n    .domain([0, 1])\n    .interpolator(d3.interpolateWarm);\nexport const zeroOneColorCool = d3\n    .scaleSequential()\n    .domain([0, 1])\n    .interpolator(d3.interpolateCool);\nexport const zeroOneColorTurbo = d3\n    .scaleSequential()\n    .domain([0, 1])\n    .interpolator(d3.interpolateTurbo);\nexport const pitchColor = zeroOneColor;\nexport const greyScaleColor = d3\n    .scaleSequential()\n    .domain([1, 0])\n    .interpolator(d3.interpolateGreys);\nexport const rainbowColor = d3\n    .scaleSequential()\n    .domain([0, 11])\n    .interpolator(d3.interpolateRainbow);\nexport const sinebowColorNormalized = d3\n    .scaleSequential()\n    .domain([0, 1])\n    .interpolator(d3.interpolateSinebow);\nexport const rawTimbreColor = d3\n    .scaleDiverging()\n    .domain([-300, 0, 300])\n    .interpolator(d3.interpolateRdBu);\nexport const divergingColor = d3\n    .scaleDiverging()\n    .domain([-1, 0, 1])\n    .interpolator(d3.interpolateRdBu);\n\nexport function goldenRatioCategoricalColor(i, offset, opacity) {\n    const angle = (offset - i * PHI) % 1;\n    const c = d3.rgb(sinebowColorNormalized(angle));\n    return `rgba(${c.r},${c.g},${c.b},${opacity})`;\n}\n\nexport const categoryColor = d3.scaleOrdinal().range(d3.schemeCategory10);\nexport function categoryColorWithOpacity(color, opacity) {\n    const c = d3.rgb(categoryColor(color));\n    return `rgba(${c.r},${c.g},${c.b},${opacity})`;\n}\nexport function lightness(color, lightness) {\n    const hslColor = d3.hsl(color);\n    hslColor.l = lightness;\n    return hslColor.hex();\n}\n\nexport function sinebowColorNormalizedRadius(angle, radius, confidence = 1) {\n    const color = sinebowColorNormalized(angle);\n    const colorHSL = d3.hsl(color);\n    colorHSL.s = radius; //Math.pow(radius, 0.2);\n    colorHSL.l = (colorHSL.l - 0.5) * radius + 0.5;\n    const c = d3.rgb(colorHSL);\n    return `rgba(${c.r},${c.g},${c.b},${confidence})`;\n}\n\nexport function circleOfFifthsColor(angle, radius, confidence = 1) {\n    const color = colorWheel(angle);\n    const colorHSL = d3.hsl(color);\n    colorHSL.s = radius; //Math.pow(radius, 0.2);\n    colorHSL.l = (colorHSL.l - 0.5) * radius + 0.5;\n    const c = d3.rgb(colorHSL);\n    return `rgba(${c.r},${c.g},${c.b},${confidence})`;\n}\n\nexport function circleOfFifthsColorBrightness(angle, radius, brightness = 1) {\n    const color = colorWheel(angle);\n    const colorHSL = d3.hsl(color);\n    colorHSL.s = radius; //Math.pow(radius, 0.2);\n    colorHSL.l = brightness;\n    return d3.rgb(colorHSL);\n}\n\nexport function renderRawPitch(track, left, width, yOffset, height, ctx) {\n    const scale = width / track.getAnalysis().track.duration;\n    track.getSegments().forEach((segment) => {\n        for (let i = 0; i < 12; i++) {\n            const x = left + segment.start * scale;\n            const segmentHeight = height / 12 - 2;\n            const y = yOffset + (11 - i) * (segmentHeight + 2);\n            const segmentWidth = segment.duration * scale;\n            ctx.fillStyle = pitchColor(segment.segment.pitches[i]);\n            ctx.fillRect(x, y, segmentWidth, segmentHeight);\n        }\n    });\n}\n\nexport function renderPercussionPitch(track, left, width, yOffset, height, ctx) {\n    const scale = width / track.getAnalysis().track.duration;\n    track.getSegments().forEach((segment, segmentIndex) => {\n        const x = left + segment.start * scale;\n        const segmentHeight = height / 3 - 2;\n        let y = yOffset + 0 * (segmentHeight + 2);\n        const segmentWidth = segment.duration * scale;\n        ctx.fillStyle = pitchColor(segment.tonalityEnergy * 2 - 0.5);\n        ctx.fillRect(x, y, segmentWidth, segmentHeight);\n        y = yOffset + 1 * (segmentHeight + 2);\n        ctx.fillStyle = pitchColor(1 - segment.tonalityRadius);\n        ctx.fillRect(x, y, segmentWidth, segmentHeight);\n        y = yOffset + 2 * (segmentHeight + 2);\n        ctx.fillStyle = segment.duration > 0.15 ? pitchColor(0) : pitchColor(segment.percussiony);\n        ctx.fillRect(x, y, segmentWidth, segmentHeight);\n    });\n}\n\nexport function renderProcessedPitch(track, left, width, yOffset, height, ctx) {\n    const scale = width / track.getAnalysis().track.duration;\n    track.getSegments().forEach((segment) => {\n        for (let i = 0; i < 12; i++) {\n            const x = left + segment.start * scale;\n            const segmentHeight = height / 12 - 2;\n            const y = yOffset + (11 - i) * (segmentHeight + 2);\n            const segmentWidth = segment.duration * scale;\n            ctx.fillStyle = pitchColor(segment.pitches[i]);\n            ctx.fillRect(x, y, segmentWidth, segmentHeight);\n        }\n    });\n}\nexport function renderRawTimbre(track, left, width, yOffset, height, ctx) {\n    const scale = width / track.getAnalysis().track.duration;\n    track.getSegments().forEach((segment, segmentIndex) => {\n        for (let i = 0; i < 12; i++) {\n            const x = left + segment.start * scale;\n            const segmentHeight = height / 12 - 2;\n            const y = yOffset + (11 - i) * (segmentHeight + 2);\n            const segmentWidth = segment.duration * scale;\n            ctx.fillStyle = divergingColor(track.getProcessedTimbre(segmentIndex)[i]);\n            ctx.fillRect(x, y, segmentWidth, segmentHeight);\n        }\n    });\n}\n\nexport function renderRawRhythm(track, left, width, yOffset, height, ctx) {\n    const scale = width / track.getAnalysis().track.duration;\n    track.getBars().forEach((bar) => {\n        const x = left + bar.start * scale;\n        const y = yOffset;\n        ctx.fillStyle = greyScaleColor(0.3 + bar.confidence);\n        ctx.fillRect(x, y, 1, height / 3);\n    });\n    track.getBeats().forEach((beat) => {\n        const x = left + beat.start * scale;\n        const y = yOffset + height / 3;\n        ctx.fillStyle = greyScaleColor(0.3 + beat.confidence);\n        ctx.fillRect(x, y, 1, height / 3);\n    });\n    track.getTatums().forEach((tatum) => {\n        const x = left + tatum.start * scale;\n        const y = yOffset + (height / 3) * 2;\n        ctx.fillStyle = greyScaleColor(0.3 + tatum.confidence);\n        ctx.fillRect(x, y, 1, height / 3);\n    });\n}\n\nexport function renderTonality(track, left, width, yOffset, height, ctx) {\n    const scale = width / track.getAnalysis().track.duration;\n    track.getSegments().forEach((segment) => {\n        const x = left + segment.start * scale;\n        const segmentHeight = height;\n        const y = yOffset;\n        const segmentWidth = segment.duration * scale;\n        ctx.fillStyle = audioUtil.tonalVectorColor(segment.pitches);\n        ctx.fillRect(x, y, segmentWidth, segmentHeight);\n    });\n}\n\nexport function renderSSM(track, left, width, yOffset, height, ctx) {\n    const scale = height / track.getAnalysis().track.duration;\n    const size = track.getSegments().length;\n    for (let i = 0; i < size; i++) {\n        for (let j = i; j < size; j++) {\n            const segmentA = track.getSegment(i);\n            const segmentB = track.getSegment(j);\n\n            const pitch = track.getSSM()[i][j - i][0];\n\n            ctx.fillStyle = greyScaleColor(Math.pow(pitch, 4));\n\n            const x = left + segmentA.start * scale;\n            const segmentWidth = segmentA.duration * scale;\n\n            const y = yOffset + segmentB.start * scale;\n            const segmentHeight = segmentB.duration * scale;\n            if (!segmentHeight) {\n                return;\n            }\n            ctx.fillRect(x, y, segmentWidth, segmentHeight);\n\n            const timbre = track.getSSM()[i][j - i][1];\n\n            ctx.fillStyle = greyScaleColor(Math.pow(timbre, 5));\n            ctx.fillRect(y + left - yOffset, x - left + yOffset, segmentHeight, segmentWidth);\n        }\n    }\n}\n\nexport function renderWaveform(ctx, x, y, width, height, track, options = {}) {\n    const segments = track.features.segments;\n    const scale = width / track.features.duration;\n    ctx.fillStyle = \"#bbbbbb\";\n    if (options.detailed) {\n        ctx.beginPath();\n        ctx.moveTo(0, height);\n        segments.forEach((segment) => {\n            const startTime = segment.start * scale;\n            const startVolume = audioUtil.loudnessPerceived(segment.loudness_start) * height;\n            const maxTime = (segment.start + segment.loudness_max_time) * scale;\n            const maxVolume = audioUtil.loudnessPerceived(segment.loudness_max) * height;\n\n            ctx.lineTo(startTime, height - startVolume);\n            ctx.lineTo(maxTime, height - maxVolume);\n        });\n        ctx.lineTo(width, height);\n\n        ctx.closePath();\n        ctx.fill();\n    } else {\n        segments.forEach((segment) => {\n            ctx.fillRect(\n                segment.start * scale,\n                y + (1 - audioUtil.loudnessPerceived(segment.loudness_max)) * height,\n                segment.duration * scale,\n                y + height\n            );\n        });\n    }\n}\n\nexport function drawAnchorPoints(track, ctx, canvasWidth) {\n    const ancholor = track.scapePlotAnchorColor;\n    const anchorAmount = ancholor.length / 5;\n    const halfWidth = canvasWidth / 2;\n    const scale = halfWidth * 0.95;\n    const size = 6;\n    const scaleFromTopLeft = 0.35;\n    for (let i = 0; i < anchorAmount; i++) {\n        const anchorX = ancholor[i * 5 + 2];\n        const anchorY = ancholor[i * 5 + 3];\n        const anchorAngle = ancholor[i * 5 + 4];\n\n        const color = d3.hsl(d3.interpolateSinebow(anchorAngle));\n        color.l = 0.6;\n        ctx.fillStyle = color.hex();\n\n        const x = halfWidth + anchorX * scale;\n        const y = halfWidth + anchorY * scale;\n        ctx.fillRect(\n            (x - size / 2) * scaleFromTopLeft,\n            (y - size / 2) * scaleFromTopLeft,\n            size * scaleFromTopLeft,\n            size * scaleFromTopLeft\n        );\n    }\n}\n\nexport function drawScapePlot(track, ctx, canvasWidth, color = true) {\n    ctx.clearRect(0, 0, canvasWidth, canvasWidth);\n    // eslint-disable-next-line no-unreachable\n    const scapePlot = track.scapePlot;\n    const scapePlotAnchorColor = track.scapePlotAnchorColor;\n    const minSize = Track.SPminSize;\n    const stepSize = Track.SPstepSize;\n    const sampleAmount = track.features.sampleAmount;\n    const scale = canvasWidth / sampleAmount;\n\n    //const size = Math.ceil((sampleAmount - minSize) / stepSize);\n    const sqrt2 = Math.sqrt(2);\n\n    scapePlot.forEachCell((x, y, value) => {\n        //ctx.fillStyle = greyScaleColor(value);\n        if (color) {\n            ctx.fillStyle = anchorColorLerp(x, y, scapePlotAnchorColor, value);\n        } else {\n            ctx.fillStyle = zeroOneColor(value);\n\n            if (value > 0.95) {\n                ctx.fillStyle = \"red\";\n            }\n        }\n\n        const start = x * stepSize;\n        const size = (scapePlot.size - 1 - y) * stepSize;\n\n        const rectX = start + size / 2;\n        const rectY = sampleAmount - size - minSize;\n        const width = stepSize;\n        const height = stepSize;\n        ctx.fillRect(rectX * scale, rectY * scale, width * scale * 1.1, height * scale * 1.1);\n    });\n    drawAnchorPoints(track, ctx, canvasWidth);\n}\n\nfunction anchorColorLerp(cellX, cellY, ancholor, value) {\n    const anchorAmount = ancholor.length / 5;\n\n    let aDist = Infinity;\n    let aAngle;\n    let bDist = Infinity;\n    let bAngle;\n    for (let i = 0; i < anchorAmount; i++) {\n        const anchorX = ancholor[i * 5];\n        const anchorY = ancholor[i * 5 + 1];\n        const anchorAngle = ancholor[i * 5 + 4];\n        const dist = Math.pow(anchorX - cellX, 2) + Math.pow(anchorY - cellY, 2);\n        if (dist < aDist || dist < bDist) {\n            if (aDist > bDist) {\n                aDist = dist;\n                aAngle = anchorAngle;\n            } else {\n                bDist = dist;\n                bAngle = anchorAngle;\n            }\n        }\n    }\n    const closenessToB = aDist / (aDist + bDist);\n    const angle = angleLerp(aAngle, bAngle, closenessToB);\n    //const color = d3.hsl(audioUtil.colorWheel(angle));\n    const color = d3.hsl(d3.interpolateSinebow(angle));\n    color.l = value * 0.9; // values that are 1 need to be a little darker for the color to\n    color.s = 0.3 + value / 2;\n    //const fitnessColor = d3.hsl(zeroOneColor(Math.pow(value, 1.5)));\n    //fitnessColor.l = value < 0.5 ? fitnessColor.l * (value / 0.5) : fitnessColor.l;\n    return color.hex();\n}\n\nfunction angleLerp(angleA, angleB, val) {\n    if (angleB > angleA) {\n        const distClock = angleB - angleA;\n        const distAntiClock = angleA + (1 - angleB);\n        if (distClock < distAntiClock) {\n            return (angleA + distClock * val) % 1;\n        } else {\n            return (angleB + distAntiClock * (1 - val)) % 1;\n        }\n    } else if (angleA > angleB) {\n        const distClock = angleA - angleB;\n        const distAntiClock = angleB + (1 - angleA);\n        if (distClock < distAntiClock) {\n            return (angleB + distClock * (1 - val)) % 1;\n        } else {\n            return (angleA + distAntiClock * val) % 1;\n        }\n    } else {\n        return angleA;\n    }\n}\n\nexport function createCanvasContext(canvas, type = \"2d\") {\n    if (!canvas) {\n        log.error(\"canvas not ready\");\n        return;\n    }\n    const ctx = canvas.getContext(type);\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    return ctx;\n}\n","import * as sim from \"./similarity\";\nimport store from \"../store\";\nimport Features from \"./Features\";\nimport * as workers from \"./workers/workers\";\nimport * as log from \"../dev/log\";\nimport * as audioUtil from \"./audioUtil\";\nimport * as vis from \"./vis\";\nimport * as filter from \"./filter\";\nimport * as structure from \"./structure\";\nimport * as SSM from \"./SSM\";\nimport * as events from \"./events\";\nimport * as noveltyDetection from \"./noveltyDetection\";\nimport Section from \"./Section\";\nimport * as mds from \"./mds\";\nimport * as pathExtraction from \"./pathExtraction\";\nimport * as d3 from \"d3\";\n\nexport const GAMMA = 1.7;\nexport const CLUSTERAMOUNT = 10;\nexport const samples = 600;\nexport const sampleDuration = 0.33;\nexport const sampleBlur = 1; // smaller than 1 => no blur, e.g. when 2 every sample is blurred over duration of 2 samples\n\nexport const enhanceBlurLength = 6;\nexport const threshold = 0.65;\nexport const thresholdPercentage = 0.5;\nexport const tempoRatios = [0.66, 0.81, 1, 1.22, 1.5];\n\nexport const SPminSize = 2; // Minimal size of segment in scape plot\nexport const SPstepSize = 2; // Size of the step between segment start and size in scape plot\nexport const createScapePlot = false;\n\nexport const averageLoudnessBlur = 3;\n\nexport const maxTimbreDownSamples = 200;\n\nconst useSampled = true;\nconst allPitches = false;\nexport default class Track {\n    eventListenerSet = false;\n\n    trackData = null;\n    analysisData = null;\n    groundTruth = null;\n\n    markers = []; // {time, color, label}\n    markersCreated = 0;\n\n    matrixes = []; // {name, matrix}\n    scapePlot = null;\n    scapePlotAnchorColor = null;\n    graphFeatures = []; // {name, data};\n    structures = []; // {name, data: [{start, duration, label}]}\n\n    separators = [];\n    courseStructure = [];\n    fineStructure = [];\n\n    harmonicStructureCourse = [];\n    harmonicStructureFine = [];\n\n    chordsVector = [];\n    chords = [];\n    tonalityFeatureSmall = [];\n    tonalityFeatureLarge = [];\n\n    keyFeature = [];\n\n    //tempoFeature = { data: [], min: 0, max: 0, avg: 0 };\n\n    events = [];\n    timbreStructure = [];\n    timbreFeatureGraph;\n    segmentedTimbreGraph = [];\n\n    features;\n\n    processed = false;\n    processing = false;\n\n    smoothedTimbre = [];\n    tsneCoords = [];\n    clusters = [];\n    clusterSections;\n\n    constructor(trackData) {\n        this.trackData = trackData;\n\n        if (trackData.groundTruth) {\n            log.debug(\"Ground truth for\", this.getName());\n            this.groundTruth = trackData.groundTruth;\n        }\n    }\n\n    separatorGenerator() {\n        log.debug(\"GENERATING SEPARATORS\");\n        const separators = [];\n        if (!this.harmonicStructureCourse) return separators;\n        for (const section of this.harmonicStructureCourse) {\n            separators.push({\n                start: section.start,\n                end: section.end,\n                colorAngle: section.colorAngle,\n                confidence: 1,\n                groupID: section.groupID,\n            });\n        }\n        return separators;\n    }\n\n    process() {\n        this.processing = true;\n        log.info(\"Processing Track\", this.getName());\n        log.debug(\"Analysis File\", this.analysisData);\n        this.features = new Features(this.analysisData, {\n            samples: samples,\n            sampleDuration: sampleDuration,\n            sampleBlur: sampleBlur,\n            downsampleAmount: maxTimbreDownSamples,\n        });\n\n        const segmentationSmoothingLength = Math.round(10);\n        const continuousSmoothingLength = Math.round(10);\n\n        const ssmTimbre = SSM.calculateSSM(\n            this.features.sampled.timbres,\n            this.features.sampleDuration,\n            false,\n            0,\n            \"cosine\"\n        );\n        const blurredTimbreLarge = filter.gaussianBlur2DOptimized(ssmTimbre, 5);\n        const timbreNoveltyColumn = noveltyDetection.absoluteEuclideanColumnDerivative(blurredTimbreLarge);\n\n        const segmentationSmoothedFeatures = filter.gaussianBlurFeatures(\n            this.features.sampled.timbres,\n            segmentationSmoothingLength\n        );\n        const segmentationDerivative = noveltyDetection.featureDerivative(segmentationSmoothedFeatures);\n        const smoothedSegmentationDerivative = filter.gaussianBlur1D(segmentationDerivative, 5);\n        const segments = structure.createSegmentsFromNovelty(\n            smoothedSegmentationDerivative,\n            this.features.sampleDuration,\n            0.2\n        );\n        const averagedColouredSegments = structure.processTimbreSegments(\n            this.features.sampled.timbres,\n            segments,\n            this.features.sampleDuration\n        );\n\n        const segmentedFeatures = [];\n        segments.forEach((segment) => {\n            const featureSegment = this.features.sampled.timbres.slice(segment.startSample, segment.endSample);\n            const smoothedFeatureSegment = filter.gaussianBlurFeatures(featureSegment, 5);\n            segmentedFeatures.push(smoothedFeatureSegment);\n        });\n\n        const frankenFeatures = [];\n        segmentedFeatures.forEach((featureSegment) => {\n            frankenFeatures.push(...featureSegment);\n        });\n        const downSampleAmount = 200;\n        //this.smoothedTimbre = Features.downSample(frankenFeatures, downSampleAmount);\n        this.smoothedTimbre = frankenFeatures;\n        //this.smoothedTimbre = filter.gaussianBlurFeatures(this.features.sampled.timbres, 4);\n        log.debug(\"Emit features processed\");\n\n        /*let beatIndex = 0;\n        const tempoSampleAmount = 350;\n        const tempoSampleDuration = this.features.duration / tempoSampleAmount;\n        this.tempoFeature.min = 500;\n        this.tempoFeature.max = 0;\n        this.tempoFeature.avg = 0;\n        for (let i = 0; i < tempoSampleAmount; i++) {\n            let [start, duration] = this.features.beatsStartDuration[beatIndex];\n            while (start + duration < tempoSampleDuration * i) {\n                beatIndex++;\n                [start, duration] = this.features.beatsStartDuration[beatIndex];\n            }\n            const bpm = 60 / duration;\n            this.tempoFeature.data.push(bpm);\n            this.tempoFeature.avg += bpm / tempoSampleAmount;\n            this.tempoFeature.min = Math.min(this.tempoFeature.min, bpm);\n            this.tempoFeature.max = Math.max(this.tempoFeature.max, bpm);\n        }\n        this.tempoFeature.data = filter.gaussianBlur1D(\n            this.tempoFeature.data,\n            Math.round(10 / tempoSampleDuration),\n            \"mirror\"\n        );*/\n\n        //log.debug(\"Tempofeature\", this.tempoFeature);\n        window.eventBus.$emit(\"featuresProcessed\");\n\n        //this.tsne();\n        //this.cluster();\n        //this.calculateSSM();\n        this.computeChords();\n        this.computeHarmonicStructure();\n        this.computeTimbreStructure();\n\n        this.processed = true;\n        this.processing = false;\n    }\n\n    computeChords() {\n        workers\n            .computeChords(\n                this.features.sampled.pitches,\n                this.features.fastSampledPitch,\n                this.features.sampleDuration,\n                this.features.fastSampleDuration\n            )\n            .then((result) => {\n                this.chordsVector = result.chordsVector;\n                this.chords = result.chords;\n                this.key = result.key;\n                this.tonalityFeatureSmall = result.tonalityFeatureSmall;\n                this.tonalityFeatureLarge = result.tonalityFeatureLarge;\n\n                this.keyFeature = result.keyFeature;\n                log.debug(\n                    \"Key comparison: mine:\",\n                    result.key,\n                    \"spotify:\",\n                    audioUtil.keyNames[this.analysisData.track.key],\n                    this.analysisData.track.mode === 1 ? \"major\" : \"minor\"\n                );\n            });\n    }\n\n    computeHarmonicStructure() {\n        workers\n            .computeHarmonicStructure({\n                pitchFeatures: this.features.sampled.pitches,\n                sampleDuration: this.features.sampleDuration,\n                allPitches,\n                enhanceBlurLength,\n                tempoRatios,\n            })\n            .then((result) => {\n                this.harmonicStructureCourse = result.harmonicStructure;\n            });\n        window.eventBus.$on(\"harmonicStructure\", this.harmonicStructureListener);\n        this.eventListenerSet = true;\n    }\n\n    harmonicStructureListener = (result) => {\n        this.harmonicStructureCourse = result.harmonicStructure;\n    };\n\n    deselect() {\n        if (this.eventListenerSet) {\n            window.eventBus.$off(\"harmonicStructure\", this.harmonicStructureListener);\n            window.eventBus.$off(\"tsneReady\", this.harmonicStructureListener);\n\n            this.eventListenerSet = false;\n        }\n    }\n\n    computeTimbreStructure() {\n        workers.computeTimbreStructure(this.features.sampled.timbres, this.features.sampleDuration).then((result) => {\n            this.timbreStructure = result.timbreStructure;\n            this.events = result.events;\n            this.segmentedTimbreGraph = result.segmentedTimbreGraph;\n        });\n    }\n\n    updatingTimbreGraphVis = false;\n    updateTimbreVis(timbreSliders) {\n        if (!this.processed) return;\n        this.updatingTimbreGraphVis = true;\n        workers\n            .updateTimbreGraphVis(this.features.downSampledTimbre, timbreSliders, this.features.sampleDuration)\n            .then((result) => {\n                this.timbreFeatureGraph = result;\n                this.updatingTimbreGraphVis = false;\n            });\n    }\n\n    /**\n     * Self similarity matrix, takes a few seconds so async is needed\n     */\n    calculateSSM() {\n        const time = new Date();\n\n        let features = this.features.processed;\n        if (useSampled) {\n            features = this.features.sampled;\n        }\n        workers\n            .startSSM(\n                this.getID(),\n                features.pitches,\n                features.timbres,\n                features.avgLoudness,\n                this.features.sampleDuration,\n                this.getSegmentStartDuration(),\n                this.features.beatsStartDuration,\n                {\n                    enhanceBlurLength,\n                    threshold,\n                    thresholdPercentage,\n                    tempoRatios,\n                    allPitches,\n                    SPminSize,\n                    SPstepSize,\n                    createScapePlot,\n                }\n            )\n            .then((result) => {\n                const diff = new Date() - time;\n                const diffBack = new Date() - result.timestamp;\n                log.info(\"workerSSM outside\", diff);\n                log.info(\"workerSSM sending back\", diffBack);\n                this.matrixes = result.matrixes;\n                this.graphFeatures = result.graphs;\n                this.structures = result.structures;\n                this.scapePlot = result.scapePlot;\n                this.scapePlotAnchorColor = result.scapePlotAnchorColor;\n                this.structureSections = result.structureSections;\n                this.optimalStructure = result.optimalStructure;\n                this.separators = result.separators;\n                this.courseStructure = result.courseStructure;\n                this.fineStructure = result.fineStructure;\n                window.eventBus.$emit(\"readyForPrototypeVis\");\n            });\n    }\n\n    getMatrixByName(name) {\n        for (const matrix of this.matrixes) {\n            if (matrix.name === name) return matrix;\n        }\n        log.error(\"Could not find matrix with name\", name);\n    }\n\n    updateDTW(start, end) {\n        let index = -1;\n        for (var i = this.matrixes.length - 1; i >= 0; --i) {\n            if (this.matrixes[i].name == \"DTW\") {\n                index = i;\n            }\n        }\n\n        const strictpath = this.getMatrixByName(\"StrictPath\").matrix;\n\n        const scoreMatrix = pathExtraction.visualizationMatrix(strictpath, strictpath.getSampleAmount(), start, end);\n\n        if (index < 0) {\n            this.matrixes.push({ name: \"DTW\", matrix: scoreMatrix });\n        } else {\n            this.matrixes[index] = { name: \"DTW\", matrix: scoreMatrix };\n        }\n        window.eventBus.$emit(\"readyForPrototypeVis\");\n    }\n\n    cluster() {\n        workers.cluster({ features: this.smoothedTimbre, minK: 2, maxK: 10, tries: 10 }).then((result) => {\n            log.debug(\"Clustering Result\", result);\n\n            this.clusters = result;\n            let prevCluster = result[0];\n\n            this.clusterSections = [];\n            this.clusterSections.push({ cluster: prevCluster, start: 0 });\n            for (let i = 1; i < result.length; i++) {\n                const cluster = result[i];\n                if (cluster !== prevCluster) {\n                    this.clusterSections[this.clusterSections.length - 1].end = i;\n                    this.clusterSections.push({ cluster: cluster, start: i });\n                    prevCluster = cluster;\n                }\n            }\n            this.clusterSections[this.clusterSections.length - 1].end = result.length;\n            log.debug(this.clusterSections);\n        });\n    }\n\n    tsne() {\n        workers.tsne({ features: this.smoothedTimbre }).then((result) => {\n            this.tsneListener(result);\n        });\n        window.eventBus.$on(\"tsneReady\", this.tsneListener);\n        this.eventListenerSet = true;\n    }\n    tsneListener = (result) => {\n        this.tsneCoords = result;\n    };\n\n    getClosestSegment(coord) {\n        let minDist = Infinity;\n        let closestSegment = null;\n        this.features.segments.forEach((segment) => {\n            const dist = sim.euclidianDistance(coord, segment.tsneCoord);\n            if (dist < minDist) {\n                minDist = dist;\n                closestSegment = segment;\n            }\n        });\n        return closestSegment;\n    }\n\n    placeMarker(time) {\n        log.debug(\"Placemarker\", time);\n        // Delete marker if it exists at that time\n        const alreadyPlacedMarkerIndex = this.markers.findIndex((marker) => Math.abs(marker.time - time) < 1);\n        if (alreadyPlacedMarkerIndex >= 0) {\n            this.markers.splice(alreadyPlacedMarkerIndex, 1);\n            return;\n        }\n\n        const color = d3.color(vis.goldenRatioCategoricalColor(this.markersCreated, 0)).formatHex();\n        const label = String.fromCharCode(97 + this.markersCreated).toUpperCase();\n        this.markers.push({ time, color, label });\n        this.markersCreated++;\n    }\n\n    static createWithAnalysis(trackData, analysisData) {\n        const track = new Track(trackData);\n        track.setAnalysis(analysisData);\n        return track;\n    }\n\n    static fromJSON(json) {\n        return this.createWithAnalysis(json.trackData, json.analysisData);\n    }\n\n    // Works with JSON.stringify!\n    toJSON() {\n        return {\n            trackData: this.trackData,\n            analysisData: this.analysisData,\n        };\n    }\n\n    getID() {\n        return this.trackData.id;\n    }\n    hasAnalysis() {\n        return this.analysisData !== null && this.features.segments.length > 0;\n    }\n    hasVisualization() {\n        return this.matrixes.length > 0;\n    }\n    getAnalysis() {\n        return this.analysisData;\n    }\n    reload() {\n        log.debug(\"Reloading track\");\n        if (this.hasVisualization()) {\n            window.setTimeout(() => window.eventBus.$emit(\"readyForPrototypeVis\"), 0);\n        }\n    }\n    setAnalysis(analysis) {\n        if (!this.processed && !this.processing) {\n            this.analysisData = analysis;\n            this.process();\n        }\n    }\n    getDuration() {\n        return this.features.duration;\n    }\n    getName() {\n        return this.trackData.name;\n    }\n    getArtist() {\n        return this.trackData.artist;\n    }\n    getURI() {\n        return this.trackData.uri;\n    }\n    getSegments() {\n        return this.features.segments;\n    }\n    getSegment(i) {\n        return this.features.segments[i];\n    }\n    getSegmentStartDuration() {\n        if (useSampled) {\n            return this.features.sampleStartDuration;\n        } else {\n            return this.features.segmentStartDuration;\n        }\n    }\n    getSSM() {\n        return this.matrixes.transpositionInvariantSSM;\n    }\n    getBars() {\n        return this.analysisData.bars;\n    }\n    getBeats() {\n        return this.analysisData.beats;\n    }\n    getTatums() {\n        return this.analysisData.tatums;\n    }\n    getProcessedPitch(i) {\n        return this.features.processed.pitches[i];\n    }\n    getProcessedPitches() {\n        return this.features.processed.pitches;\n    }\n    getProcessedTimbre(i) {\n        return this.features.processed.timbres[i];\n    }\n    getProcessedTimbres() {\n        return this.features.processed.timbres;\n    }\n    getAnalysisDuration() {\n        return this.analysisData.track.duration;\n    }\n}\n","import * as log from \"../dev/log\";\n\nimport Isophonics_1 from \"../data/testing/Isophonics/Isophonics_1.json\";\nimport Isophonics_01 from \"../data/testing/Isophonics/Isophonics_01.json\";\nimport Isophonics_2 from \"../data/testing/Isophonics/Isophonics_2.json\";\nimport Isophonics_02 from \"../data/testing/Isophonics/Isophonics_02.json\";\nimport Isophonics_03 from \"../data/testing/Isophonics/Isophonics_03.json\";\nimport Isophonics_04 from \"../data/testing/Isophonics/Isophonics_04.json\";\nimport Isophonics_05 from \"../data/testing/Isophonics/Isophonics_05.json\";\nimport Isophonics_06 from \"../data/testing/Isophonics/Isophonics_06.json\";\nimport Isophonics_07 from \"../data/testing/Isophonics/Isophonics_07.json\";\nimport Isophonics_08 from \"../data/testing/Isophonics/Isophonics_08.json\";\nimport Isophonics_09 from \"../data/testing/Isophonics/Isophonics_09.json\";\nimport Isophonics_10 from \"../data/testing/Isophonics/Isophonics_10.json\";\nimport Isophonics_11 from \"../data/testing/Isophonics/Isophonics_11.json\";\nimport Isophonics_12 from \"../data/testing/Isophonics/Isophonics_12.json\";\nimport Isophonics_13 from \"../data/testing/Isophonics/Isophonics_13.json\";\nimport Isophonics_14 from \"../data/testing/Isophonics/Isophonics_14.json\";\nimport Isophonics_15 from \"../data/testing/Isophonics/Isophonics_15.json\";\nimport Isophonics_16 from \"../data/testing/Isophonics/Isophonics_16.json\";\nimport Isophonics_17 from \"../data/testing/Isophonics/Isophonics_17.json\";\nimport Isophonics_18 from \"../data/testing/Isophonics/Isophonics_18.json\";\nimport Isophonics_CD1 from \"../data/testing/Isophonics/Isophonics_CD1.json\";\nimport Isophonics_CD2 from \"../data/testing/Isophonics/Isophonics_CD2.json\";\n\nconst dataPath = \"../data/testing/\";\n\nexport const namespaces = {\n    coarse: [\"segment_open\", \"segment_salami_upper\"],\n    function: [\"segment_open\", \"segment_salami_function\"],\n    fine: [\"chord\", \"segment_salami_lower\"],\n    chord: [\"chord\"],\n    key: [\"key_mode\"],\n    beat: [\"beat\"],\n};\n\nexport function getAllTestSets() {\n    return Object.keys(sets);\n}\n\nexport function getTracks(setKey) {\n    const set = sets[setKey].data;\n    let tracks = [];\n    for (const track of set) {\n        track.query = getQuery(track);\n        tracks.push(track);\n    }\n    return tracks;\n}\n\nfunction getQuery(track) {\n    let query = track.file_metadata.artist + track.file_metadata.title;\n    query = query.replace(/_/g, \" \");\n    query = query.replace(/\\d/g, \"\");\n    query = query.replace(/-/g, \"\");\n    return query;\n}\n\nexport function getSpotifySearch(set) {}\n\nfunction readTextFile(file) {\n    var rawFile = new XMLHttpRequest();\n    rawFile.open(\"GET\", file, false);\n    rawFile.onreadystatechange = function() {\n        if (rawFile.readyState === 4) {\n            if (rawFile.status === 200 || rawFile.status == 0) {\n                var allText = rawFile.responseText;\n                alert(allText);\n            }\n        }\n    };\n    rawFile.send(null);\n}\n\nexport const sets = {\n    \"Isophonics 1a\": { folder: \"Isophonics\", prefix: \"Isophonics_1\", data: Isophonics_1 },\n    \"Isophonics 1b\": { folder: \"Isophonics\", prefix: \"Isophonics_01\", data: Isophonics_01 },\n    \"Isophonics 2a\": { folder: \"Isophonics\", prefix: \"Isophonics_2\", data: Isophonics_2 },\n    \"Isophonics 2b\": { folder: \"Isophonics\", prefix: \"Isophonics_02\", data: Isophonics_02 },\n    \"Isophonics 3\": { folder: \"Isophonics\", prefix: \"Isophonics_03\", data: Isophonics_03 },\n    \"Isophonics 4\": { folder: \"Isophonics\", prefix: \"Isophonics_04\", data: Isophonics_04 },\n    \"Isophonics 5\": { folder: \"Isophonics\", prefix: \"Isophonics_05\", data: Isophonics_05 },\n    \"Isophonics 6\": { folder: \"Isophonics\", prefix: \"Isophonics_06\", data: Isophonics_06 },\n    \"Isophonics 7\": { folder: \"Isophonics\", prefix: \"Isophonics_07\", data: Isophonics_07 },\n    \"Isophonics 8\": { folder: \"Isophonics\", prefix: \"Isophonics_08\", data: Isophonics_08 },\n    \"Isophonics 9\": { folder: \"Isophonics\", prefix: \"Isophonics_09\", data: Isophonics_09 },\n    \"Isophonics 10\": { folder: \"Isophonics\", prefix: \"Isophonics_10\", data: Isophonics_10 },\n    \"Isophonics 11\": { folder: \"Isophonics\", prefix: \"Isophonics_11\", data: Isophonics_11 },\n    \"Isophonics 12\": { folder: \"Isophonics\", prefix: \"Isophonics_12\", data: Isophonics_12 },\n    \"Isophonics 13\": { folder: \"Isophonics\", prefix: \"Isophonics_13\", data: Isophonics_13 },\n    \"Isophonics 14\": { folder: \"Isophonics\", prefix: \"Isophonics_14\", data: Isophonics_14 },\n    \"Isophonics 15\": { folder: \"Isophonics\", prefix: \"Isophonics_15\", data: Isophonics_15 },\n    \"Isophonics 16\": { folder: \"Isophonics\", prefix: \"Isophonics_16\", data: Isophonics_16 },\n    \"Isophonics 17\": { folder: \"Isophonics\", prefix: \"Isophonics_17\", data: Isophonics_17 },\n    \"Isophonics 18\": { folder: \"Isophonics\", prefix: \"Isophonics_18\", data: Isophonics_18 },\n    \"Isophonics CD1\": { folder: \"Isophonics\", prefix: \"Isophonics_CD1\", data: Isophonics_CD1 },\n    \"Isophonics CD2\": { folder: \"Isophonics\", prefix: \"Isophonics_CD2\", data: Isophonics_CD2 },\n};\n","import { same } from \"numeric\";\nimport HalfMatrix from \"./dataStructures/HalfMatrix\";\nimport { NumberType } from \"./dataStructures/NumberType\";\nimport Track from \"./Track\";\nimport * as log from \"../dev/log\";\nimport Features from \"./Features\";\nimport * as workers from \"./workers/workers\";\n\nconst preset1 = \"AABB\";\nconst sampleAmount = 250;\nconst sampleDuration = 1;\nconst templateSegment = {\n    start: 0,\n    duration: 1,\n    pitches: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    timbre: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n    loudness_start: 0,\n    loudness_max: 1,\n    loudness_max_time: 0.5,\n    loudness_end: 0,\n};\nconst templateElement = {\n    start: 0,\n    duration: 1,\n    confidence: 1,\n};\nexport default class SynthesizedTrack extends Track {\n    synthesizerString;\n    constructor(trackData, synthesizerString) {\n        trackData.name = synthesizerString;\n        trackData.artist = \"synthesizer\";\n        super(trackData);\n\n        this.synthesizerString = synthesizerString;\n\n        const track = {\n            duration: sampleAmount,\n        };\n        this.analysisData = {\n            track,\n            segments: [templateSegment],\n            beats: [templateElement],\n            tatums: [templateElement],\n            bars: [templateElement],\n            sections: [templateElement],\n        };\n\n        this.features = new Features(this.analysisData, {\n            samples: sampleAmount,\n            sampleBlur: Track.sampleBlur,\n            downsampleAmount: Track.maxTimbreDownSamples,\n        });\n        this.process();\n    }\n\n    process() {\n        log.debug(\"Processing synthesized track\");\n        const pitchSSM = synthesizeSSMPitch(sampleAmount, this.synthesizerString);\n        const timbreSSM = synthesizeSSMTimbre(sampleAmount, this.synthesizerString);\n\n        workers\n            .startSSM(\n                this.getID(),\n                null,\n                null,\n                new Float32Array(sampleAmount).fill(1),\n                sampleDuration,\n                null,\n                this.features.beatsStartDuration,\n                {\n                    sampleAmount: sampleAmount,\n                    blurTime: Track.blurTime,\n                    enhanceBlurLength: Track.enhanceBlurLength,\n                    threshold: Track.threshold,\n                    thresholdPercentage: Track.thresholdPercentage,\n                    tempoRatios: Track.tempoRatios,\n                    allPitches: false,\n                    SPminSize: Track.SPminSize,\n                    SPstepSize: Track.SPstepSize,\n                    createScapePlot: Track.createScapePlot,\n                    synthesized: true,\n                    synthesizedSSMPitch: pitchSSM.getBuffer(),\n                    synthesizedSSMTimbre: timbreSSM.getBuffer(),\n                }\n            )\n            .then((result) => {\n                log.debug(\"Done processing\");\n                this.matrixes = result.matrixes;\n                this.graphFeatures = result.graphs;\n                this.scapePlot = result.scapePlot;\n                this.scapePlotAnchorColor = result.scapePlotAnchorColor;\n                this.structureSections = result.structureSections;\n                this.optimalStructure = result.optimalStructure;\n                this.structures = result.structures;\n                window.eventBus.$emit(\"readyForPrototypeVis\");\n            });\n    }\n    hasAnalysis() {\n        return true;\n    }\n}\n\nexport function synthesizeSSMPitch(sampleAmount, preset) {\n    const ssm = new HalfMatrix({\n        size: sampleAmount,\n        numberType: HalfMatrix.NumberType.UINT8,\n        sampleDuration: 1,\n        featureAmount: 1,\n    });\n\n    const sections = preset.split(\"\");\n    const sectionLength = Math.floor(sampleAmount / sections.length);\n    sections.forEach((ySection, yIndex) => {\n        const yOffset = yIndex * sectionLength;\n        sections.forEach((xSection, xIndex) => {\n            if (ySection === xSection) {\n                const xOffset = xIndex * sectionLength;\n                for (let i = 0; i < sectionLength; i++) {\n                    ssm.setValueNormalizedMirrored(xOffset + i, yOffset + i, 1);\n                }\n            }\n        });\n    });\n    return ssm;\n}\nexport function synthesizeSSMTimbre(sampleAmount, preset) {\n    const ssm = new HalfMatrix({\n        size: sampleAmount,\n        numberType: HalfMatrix.NumberType.UINT8,\n        sampleDuration: 1,\n        featureAmount: 1,\n    });\n\n    const sections = preset.split(\"\");\n    const sectionLength = Math.floor(sampleAmount / sections.length);\n    sections.forEach((ySection, yIndex) => {\n        const yOffset = yIndex * sectionLength;\n        sections.forEach((xSection, xIndex) => {\n            if (ySection === xSection) {\n                const xOffset = xIndex * sectionLength;\n                for (let y = 0; y < sectionLength; y++) {\n                    for (let x = 0; x <= y; x++) {\n                        ssm.setValueNormalizedMirrored(xOffset + x, yOffset + y, 1);\n                    }\n                }\n            }\n        });\n    });\n    return ssm;\n}\n","import * as SpotifyWebApi from \"spotify-web-api-js\";\nimport * as auth from \"./authentication\";\nimport Track from \"./Track\";\nimport store from \"./../store\"; // path to your Vuex store\nimport router from \"../router\";\nimport * as workers from \"./workers/workers\";\nimport * as log from \"../dev/log\";\nimport * as testing from \"./testing\";\nimport SynthesizedTrack from \"./synthesizer\";\n\nexport const spotify = new SpotifyWebApi();\n\nconst allTracks = new Map();\n\n// Initialize spotify access, load tracks from local storage, get user data\nexport async function initialize() {\n    log.info(\"Initializing App\");\n\n    workers.init().then(() => log.info(\"Initialized Workers!\"));\n\n    //loadAllTracks();\n\n    spotify.setAccessToken(auth.token);\n    spotify\n        .getMe()\n        .then((data) => {\n            store.commit(\"setUser\", data);\n        })\n        .catch((err) => {\n            router.push(\"/login\");\n        });\n\n    let firstTrack;\n    const localTrackId = window.localStorage.getItem(\"trackId\");\n    if (localTrackId && localTrackId !== \"-1\") {\n        firstTrack = (await spotify.getTracks([localTrackId])).tracks[0];\n    }\n    if (!firstTrack) {\n        firstTrack = (await spotify.getPlaylistTracks(\"34wIIW2zm3vw5ZRqO8dHi0\")).items[0].track;\n    }\n    spotify.getMyTopTracks({ limit: 50, offset: 0 }).then((topTracks) => {\n        loadTracksFromSpotify([firstTrack, ...topTracks.items], false);\n    });\n}\n\nexport async function selectTrackAtIndex(index) {\n    store.commit(\"loadingTrack\", true);\n    const selectedTrack = store.getters.selectedTrack;\n    const newTrack = store.getters.trackList[index];\n    if (selectedTrack && selectedTrack !== newTrack) selectedTrack.deselect();\n    return getAnalysis(newTrack).then(() => {\n        store.commit(\"setSelectedIndex\", index);\n\n        store.commit(\"loadingTrack\", false);\n\n        //const query = { ...this.$route.query, trackID: newTrack.getID() };\n        //router.replace({ query });\n        router.push(`/track/${newTrack.getID()}`);\n    });\n}\nexport async function getAnalysis(track) {\n    if (track.hasAnalysis()) {\n        track.reload();\n        return track.getAnalysis();\n    }\n    return spotify\n        .getAudioAnalysisForTrack(track.getID())\n        .then((analysis) => {\n            track.setAnalysis(analysis);\n        })\n        .catch((err) => {\n            log.error(err);\n        });\n}\n\n// Save tracks to local storage\nexport function saveAllTracks() {\n    localStorage.allTracks = JSON.stringify(Array.from(allTracks.entries()));\n}\n\n// Save tracks to local storage\nexport function loadAllTracks() {\n    if (localStorage.allTracks) {\n        const allTracksArray = JSON.parse(localStorage.allTracks);\n        allTracksArray.forEach((trackArray) => {\n            const track = Track.createWithAnalysis(trackArray[1].trackData, trackArray[1].analysisData);\n            allTracks.set(trackArray[0], track);\n        });\n    }\n}\n\n/**\n * Load tracks from spotify api result\n */\n\nfunction loadTracksFromSpotify(tracks, keepCurrentTrack = true) {\n    const selectedTrack = store.getters.selectedTrack;\n    store.commit(\"clearTrackList\");\n    tracks.forEach((trackData) => {\n        if (allTracks.has(trackData.id)) {\n            if (trackData.groundTruth) {\n                allTracks.get(trackData.id).groundTruth = trackData.groundTruth;\n            }\n            store.commit(\"addToTrackList\", allTracks.get(trackData.id));\n        } else {\n            const track = new Track(trackData);\n            allTracks.set(trackData.id, track);\n            store.commit(\"addToTrackList\", track);\n        }\n    });\n    if (keepCurrentTrack) {\n        store.commit(\"addToTrackListFront\", selectedTrack);\n        store.commit(\"setSelectedIndex\", 0);\n    } else {\n        selectTrackAtIndex(0);\n    }\n}\n\nexport async function search(query) {\n    spotify\n        .search(query, [\"track\"])\n        .then((results) => {\n            loadTracksFromSpotify(results.tracks.items, true);\n        })\n        .catch((err) => {\n            log.error(err);\n        });\n}\n\nexport async function loadArtistTopTracks(artistID) {\n    spotify.getArtistTopTracks(artistID, \"from_token\").then((result) => {\n        loadTracksFromSpotify(result.tracks);\n    });\n}\n\nexport async function loadTestSet(testSetKey) {\n    log.debug(\"loading test set with key\", testSetKey);\n    const testSetTracks = testing.getTracks(testSetKey);\n    const spotifyTracks = [];\n    for (const track of testSetTracks) {\n        const spotifySearches = [];\n        spotifySearches.push(\n            spotify\n                .search(track.query, [\"track\"])\n                .then((results) => {\n                    if (results.tracks.items.length > 0) {\n                        let spotifyTrack = results.tracks.items[0];\n                        log.debug(track.query, track);\n                        spotifyTrack.groundTruth = track;\n                        spotifyTracks.push(spotifyTrack);\n                    }\n                })\n                .catch((err) => {\n                    log.error(err);\n                })\n        );\n        await Promise.all(spotifySearches);\n    }\n    loadTracksFromSpotify(spotifyTracks, true);\n}\n\nexport async function synthesize(synthesizerString) {\n    let trackData = {};\n    trackData.id = \"0000\";\n    const track = new SynthesizedTrack(trackData, synthesizerString);\n    allTracks.set(trackData.id, track);\n    store.commit(\"clearTrackList\");\n    store.commit(\"addToTrackList\", track);\n\n    //selectTrackAtIndex(0);\n}\n","<template>\n  <div>\n    <v-slide-group\n      v-model=\"selected\"\n      center-active\n      class=\"pt-2\"\n      v-on:scroll.native=\"onScroll\"\n      mandatory\n    >\n      <v-slide-item\n        v-for=\"(track, index) in tracks\"\n        :key=\"index\"\n        v-slot:default=\"{ active, toggle }\"\n        class=\"mx-2 my-1\"\n      >\n        <Album\n          :album=\"track.trackData\"\n          :imgSize=\"active ? albumSize * 1.5 : albumSize\"\n          :active=\"active\"\n          @clicked=\"toggle\"\n          @clickedArtist=\"clickedArtist(track)\"\n        />\n      </v-slide-item>\n    </v-slide-group>\n  </div>\n</template>\n\n<script>\nimport Album from \"../components/Album\";\nimport * as app from \"../app/app\";\nimport * as log from \"../dev/log\";\n\nexport default {\n  name: \"TrackSelector\",\n  props: [\"tracks\", \"albumSize\"],\n  components: {\n    Album,\n  },\n  data() {\n    return {\n      selected: 0,\n    };\n  },\n  computed: {\n    selectedFromStore() {\n      return this.$store.getters.selectedIndex;\n    },\n  },\n  watch: {\n    selected: \"selectedChanged\",\n    selectedFromStore: \"selectedFromStoreChanged\",\n  },\n  mounted() {},\n  methods: {\n    selectedChanged(newIndex, oldIndex) {\n      app.selectTrackAtIndex(newIndex);\n    },\n    selectedFromStoreChanged(newIndex, oldIndex) {\n      this.selected = newIndex;\n    },\n    clickedArtist(track) {\n      log.debug(\"Clicked Artist\", track);\n      app.loadArtistTopTracks(track.trackData.artists[0].id);\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackSelector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TrackSelector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TrackSelector.vue?vue&type=template&id=1044ee30&\"\nimport script from \"./TrackSelector.vue?vue&type=script&lang=js&\"\nexport * from \"./TrackSelector.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VSlideGroup } from 'vuetify/lib/components/VSlideGroup';\nimport { VSlideItem } from 'vuetify/lib/components/VSlideGroup';\ninstallComponents(component, {VSlideGroup,VSlideItem})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"visualization\"},[_c('div',[_c('v-row',{staticClass:\"d-flex justify-center py-2\"}),(_vm.showPrototype)?_c('div',[_c('GroundTruth',{attrs:{\"width\":_vm.width}}),_c('Graphs',{attrs:{\"width\":_vm.width}}),_c('PitchTimbre',{attrs:{\"width\":_vm.width}})],1):_vm._e(),(!_vm.showPrototype)?_c('div',[_c('div',{staticStyle:{\"height\":\"5px\"}}),(!_vm.loadingTrack && _vm.tsneReady)?_c('svg',{staticClass:\"tsneContainer\",style:((\"height: \" + (_vm.tsneSize + 5 * 20) + \"px; width: \" + _vm.width + \"px; left: \" + (10)))},[_vm._l((_vm.tsneCoords.length - 2),function(index){return _c('line',{key:index + 'clusterline',staticStyle:{\"stroke-opacity\":\".1\"},attrs:{\"x1\":_vm.tsneCoordX(_vm.tsneCoords[index][0]),\"y1\":_vm.tsneCoordY(_vm.tsneCoords[index][1]),\"x2\":_vm.tsneCoordX(_vm.tsneCoords[index + 1][0]),\"y2\":_vm.tsneCoordY(_vm.tsneCoords[index + 1][1]),\"stroke\":_vm.clusterColor(_vm.clusters[index]),\"stroke-width\":\"2\"}})}),_vm._l((_vm.tsneCoords),function(coord,index){return _c('circle',{key:index + 'clustercircle',class:_vm.isPlayingSample(index) ? 'segmentCirclePlaying' : 'segmentCircle',attrs:{\"r\":_vm.isPlayingSample(index) ? 5 + _vm.tsneDynamics(index) * 10 : 3 + _vm.tsneDynamics(index) * 5,\"cx\":_vm.tsneCoordX(coord[0]) -\n                            (_vm.isPlayingSample(index) ? 5 + _vm.tsneDynamics(index) * 10 : 3 + _vm.tsneDynamics(index) * 5) /\n                                2,\"cy\":_vm.tsneCoordY(coord[1]) -\n                            (_vm.isPlayingSample(index) ? 5 + _vm.tsneDynamics(index) * 10 : 3 + _vm.tsneDynamics(index) * 5) /\n                                2,\"fill\":_vm.isPlayingSample(index) ? 'white' : _vm.clusterColor(_vm.clusters[index])}})}),_c('circle',{class:'playingSegmentCircle',style:((\"transition:  cx \" + (_vm.track.features.sampleDuration) + \"s linear, cy \" + (_vm.track.features.sampleDuration) + \"s linear;\")),attrs:{\"r\":5 + _vm.tsneDynamics(_vm.playingSample) * 10,\"cx\":_vm.tsneCoordX(_vm.tsneCoords[_vm.playingSample][0]) - (5 + _vm.tsneDynamics(_vm.playingSample) * 10) / 2,\"cy\":_vm.tsneCoordY(_vm.tsneCoords[_vm.playingSample][1]) - (5 + _vm.tsneDynamics(_vm.playingSample) * 10) / 2,\"fill\":'white'}}),_vm._l((_vm.clusterSections),function(clusterSection,index){return _c('rect',{key:index + 'clustersection',staticClass:\"clusterRect\",attrs:{\"fill\":_vm.clusterColor(clusterSection.cluster),\"x\":_vm.samplePosNormalized(clusterSection.start) * _vm.width,\"y\":_vm.tsneSize + 20 * clusterSection.cluster,\"width\":_vm.samplePosNormalized(clusterSection.end - clusterSection.start) * _vm.width,\"height\":20}})}),_c('rect',{staticClass:\"seekerRect\",attrs:{\"x\":_vm.seekerNormalized * _vm.width - 1.25,\"y\":_vm.tsneSize,\"width\":2.5,\"height\":20 * 6,\"fill\":\"rgb(255,255,255,0.3)\"}})],2):_vm._e(),_c('HolisticStructure',{attrs:{\"width\":_vm.width}}),_c('TimbreSegmentedGraph',{attrs:{\"width\":_vm.width}}),_c('Chords',{attrs:{\"width\":_vm.width}}),_c('div',{staticStyle:{\"height\":\"50px\"}}),_c('Tonality',{attrs:{\"width\":_vm.width}}),_c('div',{staticStyle:{\"height\":\"400px\"}})],1):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-card',{attrs:{\"width\":_vm.width}},[(_vm.trackVisready)?_c('v-tabs',{attrs:{\"dark\":\"\",\"center-active\":\"\",\"show-arrows\":\"\"},model:{value:(_vm.selectedTab),callback:function ($$v) {_vm.selectedTab=$$v},expression:\"selectedTab\"}},_vm._l((this.track.matrixes),function(matrix){return _c('v-tab',{key:matrix.name},[_vm._v(_vm._s(matrix.name))])}),1):_vm._e()],1),_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.width}}),_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.width,\"vertical\":true}}),(_vm.hasStructures)?_c('svg',{staticClass:\"annotations\",attrs:{\"height\":_vm.width,\"width\":_vm.width}},_vm._l((_vm.selectedStructure.data),function(section,index){return _c('g',{key:index},[(_vm.showPathStart)?_c('rect',{attrs:{\"x\":section.start * _vm.secondsToXPosition - 1,\"y\":0,\"width\":2,\"height\":_vm.width,\"fill\":_vm.getCategoryColor(section.label),\"opacity\":0.8}}):_vm._e(),(_vm.fillSections)?_c('rect',{attrs:{\"x\":section.start * _vm.secondsToXPosition,\"y\":0,\"width\":section.duration * _vm.secondsToXPosition,\"height\":_vm.width,\"fill\":_vm.getCategoryColor(section.label),\"opacity\":0.3}}):_vm._e(),(section.pathFamily && _vm.showPaths)?_c('g',_vm._l((section.pathFamily),function(path,pathIndex){return _c('g',{key:pathIndex},[_c('path',{staticClass:\"path\",attrs:{\"fill\":\"none\",\"stroke\":\"black\",\"stroke-width\":\"8\",\"d\":_vm.generateLine(path),\"stroke-linejoin\":\"round\"}}),_c('path',{staticClass:\"path\",attrs:{\"fill\":\"none\",\"stroke\":_vm.getCategoryColor(section.label),\"stroke-width\":\"4\",\"d\":_vm.generateLine(path),\"stroke-linejoin\":\"round\"}})])}),0):_vm._e()])}),0):_vm._e(),_c('canvas',{staticClass:\"glCanvas pa-0 ma-0\",attrs:{\"id\":\"gl-canvas\",\"height\":_vm.width,\"width\":_vm.width}}),(_vm.hasStructures)?_c('v-row',{staticClass:\"options-row\",style:((\"width: \" + _vm.width + \"px\"))},[_c('v-select',{attrs:{\"items\":_vm.track.structures,\"item-text\":\"name\",\"return-object\":\"\",\"label\":\"Structure\",\"solo\":\"\"},model:{value:(_vm.selectedStructure),callback:function ($$v) {_vm.selectedStructure=$$v},expression:\"selectedStructure\"}}),_c('v-spacer'),_c('v-switch',{attrs:{\"label\":\"Show Path Start\",\"hide-details\":\"\"},model:{value:(_vm.showPathStart),callback:function ($$v) {_vm.showPathStart=$$v},expression:\"showPathStart\"}}),_c('v-switch',{attrs:{\"label\":\"Fill Sections\",\"hide-details\":\"\"},model:{value:(_vm.fillSections),callback:function ($$v) {_vm.fillSections=$$v},expression:\"fillSections\"}}),_c('v-switch',{attrs:{\"label\":\"Show Paths\",\"hide-details\":\"\"},model:{value:(_vm.showPaths),callback:function ($$v) {_vm.showPaths=$$v},expression:\"showPaths\"}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { buffer } from \"d3\";\nimport * as log from \"../../dev/log\";\nimport Matrix from \"../dataStructures/Matrix\";\n\nexport default class webGLCanvas {\n    gl;\n    program;\n\n    bufferSize = 0;\n\n    translateLoc;\n    scaleLoc;\n\n    useColor;\n\n    constructor(canvas, useColor = false) {\n        this.useColor = useColor;\n        if (!canvas) {\n            log.warn(\"canvas not ready\");\n            return;\n        }\n\n        this.gl = canvas.getContext(\"webgl2\");\n\n        if (!this.gl) {\n            log.warn(\"WebGL not supported, falling back on experimental WebGL\");\n            this.gl = canvas.getContext(\"experimental-webgl2\");\n            if (!this.gl) alert(\"Your browser does not support WebGL\");\n        }\n\n        this.gl.clearColor(0, 0, 0, 0);\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n\n        let vertexShader = this.gl.createShader(this.gl.VERTEX_SHADER);\n        let fragmentShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\n\n        if (useColor) {\n            this.gl.shaderSource(vertexShader, this.vertexShaderTextColor);\n            this.gl.shaderSource(fragmentShader, this.fragmentShaderTextColor);\n        } else {\n            this.gl.shaderSource(vertexShader, this.vertexShaderTextGreyscale);\n            this.gl.shaderSource(fragmentShader, this.fragmentShaderTextGreyscale);\n        }\n\n        this.gl.compileShader(vertexShader);\n        if (!this.gl.getShaderParameter(vertexShader, this.gl.COMPILE_STATUS)) {\n            log.error(\"ERROR compiling vertex shader!\", this.gl.getShaderInfoLog(vertexShader));\n            return;\n        }\n        this.gl.compileShader(fragmentShader);\n        if (!this.gl.getShaderParameter(fragmentShader, this.gl.COMPILE_STATUS)) {\n            log.error(\"ERROR compiling fragment shader!\", this.gl.getShaderInfoLog(fragmentShader));\n            return;\n        }\n\n        this.program = this.gl.createProgram();\n        this.gl.attachShader(this.program, vertexShader);\n        this.gl.attachShader(this.program, fragmentShader);\n        this.gl.linkProgram(this.program);\n        if (!this.gl.getProgramParameter(this.program, this.gl.LINK_STATUS)) {\n            console.error(\"ERROR linking program!\", this.gl.getProgramInfoLof(this.program));\n            return;\n        }\n\n        this.gl.validateProgram(this.program);\n        if (!this.gl.getProgramParameter(this.program, this.gl.VALIDATE_STATUS)) {\n            console.error(\"ERROR validating program!\", this.gl.getProgramInfoLog(this.program));\n            return;\n        }\n\n        this.translateLoc = this.gl.getUniformLocation(this.program, \"translate\");\n        this.scaleLoc = this.gl.getUniformLocation(this.program, \"scale\");\n    }\n\n    setHeight(height) {\n        this.gl.canvas.height = height;\n        this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n    }\n\n    clear() {\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n    }\n\n    setBufferData(bufferData) {\n        this.bufferSize = bufferData.verts.length / 2;\n\n        // Vertex buffer\n        // Create an empty buffer object to store the vertex buffer\n        const rectangleVertexBufferObject = this.gl.createBuffer();\n\n        //Bind appropriate array buffer to it\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, rectangleVertexBufferObject);\n\n        // Pass the vertex data to the buffer\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, bufferData.verts, this.gl.STATIC_DRAW);\n\n        // Unbind the buffer\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, null);\n\n        // Color buffer\n        const colorBufferObject = this.gl.createBuffer();\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, colorBufferObject);\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, bufferData.colors, this.gl.STATIC_DRAW);\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, null);\n\n        // Bind vertex buffer object\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, rectangleVertexBufferObject);\n\n        // Get the attribute location\n        const vertAttribLocation = this.gl.getAttribLocation(this.program, \"vert\");\n\n        // Point an attribute to the currently bound VBO\n        this.gl.vertexAttribPointer(\n            vertAttribLocation,\n            2, // Number of elements per attribute (x, y)\n            this.gl.FLOAT, // Type of element\n            this.gl.FALSE, // data normalized\n            2 * Float32Array.BYTES_PER_ELEMENT, // Size of one vertex\n            0 // Offset from beginning of single vertex\n        );\n\n        // Enable the attribute\n        this.gl.enableVertexAttribArray(vertAttribLocation);\n\n        // bind the color buffer\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, colorBufferObject);\n\n        // get the attribute location\n        const colorAttribLocation = this.gl.getAttribLocation(this.program, \"vertColor\");\n\n        // point attribute to the color buffer object\n        this.gl.vertexAttribPointer(\n            colorAttribLocation,\n            3, // Number of elements per attribute (r, g, b)\n            this.gl.FLOAT, // Type of element\n            this.gl.FALSE, // data normalized\n            3 * Float32Array.BYTES_PER_ELEMENT, // Size of one vertex\n            0 // Offset from beginning of single vertex\n        );\n        // enable the color attribute\n        this.gl.enableVertexAttribArray(colorAttribLocation);\n    }\n\n    draw(translateX, translateY, scaleX, scaleY) {\n        //Main render loop\n        this.gl.useProgram(this.program);\n        this.gl.uniform2f(this.translateLoc, translateX, translateY);\n        this.gl.uniform2f(this.scaleLoc, scaleX, scaleY);\n        this.gl.drawArrays(this.gl.TRIANGLES, 0, this.bufferSize);\n    }\n\n    vertexShaderTextGreyscale = [\n        \"#version 300 es\",\n        \"precision mediump float;\",\n        \"uniform vec2 translate;\",\n        \"uniform vec2 scale;\",\n        \"in vec2 vert;\",\n        \"in vec3 vertColor;\",\n        \"flat out vec3 color;\",\n        \"\",\n        \"void main()\",\n        \"{\",\n        \" gl_Position = vec4((vert.x*scale.x + translate.x), (vert.y*scale.y+translate.y), 0.0, 1.0);\",\n        \" color = vertColor;\",\n        \"}\",\n    ].join(\"\\n\");\n\n    vertexShaderTextColor = [\n        \"#version 300 es\",\n        \"precision mediump float;\",\n        \"uniform vec2 translate;\",\n        \"uniform vec2 scale;\",\n        \"in vec2 vert;\",\n        \"in vec3 vertColor;\",\n        \"flat out vec3 color;\",\n        \"\",\n        \"void main()\",\n        \"{\",\n        \" gl_Position = vec4((vert.x*scale.x + translate.x), (vert.y*scale.y+translate.y), 0.0, 1.0);\",\n        \" color = vertColor;\",\n        \"}\",\n    ].join(\"\\n\");\n\n    fragmentShaderTextGreyscale = [\n        \"#version 300 es\",\n        \"precision mediump float;\",\n        \"\",\n        \"flat in vec3 color;\",\n        \"out vec4 fragColor;\",\n        \"void main()\",\n        \"{\",\n        \" fragColor = vec4(color, 1.0);\",\n        \"}\",\n    ].join(\"\\n\");\n\n    fragmentShaderTextColor = [\n        \"#version 300 es\",\n        \"precision mediump float;\",\n        \"\",\n        \"flat in vec3 color;\",\n        \"out vec4 fragColor;\",\n        \"void main()\",\n        \"{\",\n        \" fragColor = vec4(color, 1.0);\",\n        \"}\",\n    ].join(\"\\n\");\n}\n","import WebGL from \"./WebGL\";\nimport assert from \"assert\";\nimport * as log from \"../../dev/log\";\nimport Matrix from \"../dataStructures/Matrix\";\nimport store from \"../../store\";\n\nexport default class WebGLMatrixPool extends WebGL {\n    matrixBufferPool;\n\n    constructor(...args) {\n        super(...args);\n    }\n\n    fillMatrixBufferPool(track, selectedIndex) {\n        assert(track.matrixes, \"track does not have matrixes\");\n        this.matrixBufferPool = new Array(track.matrixes.length);\n        track.matrixes.forEach((matrix, index) => {\n            if (index === selectedIndex) {\n                this.matrixBufferPool[index] = this.createDataArray(track, matrix.matrix);\n            } else {\n                setTimeout(() => (this.matrixBufferPool[index] = this.createDataArray(track, matrix.matrix)), 0);\n            }\n        });\n    }\n\n    select(index) {\n        assert(this.matrixBufferPool);\n        this.setBufferData(this.matrixBufferPool[index]);\n    }\n\n    draw(xCenterPositionNormalized, scaleX, scaleY) {\n        super.draw((1 - xCenterPositionNormalized * 2) * scaleX, 0, scaleX, scaleY);\n    }\n\n    createDataArray(track, ssm) {\n        const segmentStartDuration = track.getSegmentStartDuration();\n        const size = segmentStartDuration.length;\n\n        this.bufferSize = size * size * 6;\n        if (this.bufferSize > 22e6) {\n            log.error(\"Buffer OVERFLOW with size\", this.bufferSize);\n        }\n\n        const halfDuration = track.getAnalysisDuration() / 2;\n        function st(pos) {\n            return pos / halfDuration - 1;\n        } // Scale and translate\n\n        const ssmVertices = [];\n        const colors = [];\n        const isMatrix = ssm instanceof Matrix;\n\n        for (let y = 0; y < size; y++) {\n            for (let x = 0; x < size; x++) {\n                let v;\n                if (isMatrix) {\n                    v = ssm.getValueNormalized(x, y);\n                } else {\n                    v = ssm.getValueNormalizedMirrored(x, y);\n                }\n                const left = st(segmentStartDuration[x][0]);\n                const top = -st(segmentStartDuration[y][0]);\n                const right = st(segmentStartDuration[x][0] + segmentStartDuration[x][1]);\n                const bottom = -st(segmentStartDuration[y][0] + segmentStartDuration[y][1]);\n                ssmVertices.push(left, top, left, bottom, right, top, right, top, left, bottom, right, bottom);\n                colors.push(v, v, v, v, v, v, v, v, v, v, v, v, v, v, v, v, v, v);\n            }\n        }\n\n        return { verts: new Float32Array(ssmVertices), colors: new Float32Array(colors) };\n    }\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (!_vm.loadingTrack)?_c('svg',{staticClass:\"seekerSVG\",style:((\"transform: translate(\" + (0) + \"px, 0px);\")),attrs:{\"height\":_vm.height,\"width\":_vm.width},on:{\"click\":_vm.clickedSVG,\"contextmenu\":[function($event){return _vm.rightClick($event)},function($event){$event.preventDefault();}]}},[_c('rect',{staticClass:\"seekerRect\",attrs:{\"x\":!_vm.isVertical * ((_vm.useZoom && _vm.isZoomed ? 0.5 : _vm.seekerNormalized) * _vm.width - 1.25),\"y\":_vm.isVertical * ((_vm.useZoom && _vm.isZoomed ? 0.5 : _vm.seekerNormalized) * _vm.height - 1.25) + _vm.showMarkerLabel ? 15 : 0,\"width\":_vm.isVertical ? _vm.width * 2 : 2.5,\"height\":(_vm.isVertical ? 2.5 : _vm.height * 2) - (_vm.showMarkerLabel ? 15 : 0),\"fill\":_vm.seekerColor}}),_c('Markers',{ref:'markers',attrs:{\"v-if\":_vm.drawMarkers,\"width\":_vm.width,\"height\":_vm.height,\"opacity\":_vm.markerOpacity || 0.3,\"showMarkerLabel\":_vm.showMarkerLabel}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as log from \"../dev/log\";\nimport { spotify } from \"./app\";\nimport store from \"../store\";\n\nexport const autoConnect = true;\nexport let active = false;\nexport let deviceId = null;\nlet player = null;\n\nlet playedTrackBefore = false;\nlet trackURI = null;\n\nexport async function loadTrack(track) {\n    if (!active) return;\n\n    if (!store.state.playerReady) {\n        log.warn(\"Trying to load track while player not ready\");\n        return;\n    }\n    pause();\n    seekMS(0);\n    pause();\n    trackURI = track.getURI();\n    playedTrackBefore = false;\n    store.commit(\"setSeeker\", 0);\n    store.commit(\"setPlaying\", false);\n}\n\nasync function play() {\n    if (!active) return;\n\n    spotify.play({ uris: [trackURI], position_ms: store.state.seeker }, (err, result) => {\n        playedTrackBefore = true;\n        log.debug(\"Playing from\", store.state.seeker);\n        store.commit(\"setPlaying\", true);\n    });\n}\n\n/**\n * Resume playback,\n * If track is loaded, starts playback from time 0\n */\nlet locallyResumed = false;\nexport async function resume() {\n    if (!active) return;\n\n    if (playedTrackBefore) {\n        player.resume().then(() => {\n            locallyResumed = true;\n            store.commit(\"setPlaying\", true);\n        });\n    } else {\n        play();\n    }\n}\n\nlet locallyPaused = false;\nexport async function pause() {\n    if (!active) return;\n\n    if (playedTrackBefore) {\n        player.pause().then(() => {\n            locallyPaused = true;\n            store.commit(\"setPlaying\", false);\n        });\n    }\n}\n/**\n * Go to a specific time in the track\n * Playing state will not be affected\n * @param {*} time_ms in ms\n */\nexport async function seekMS(time_ms) {\n    if (!active) return;\n\n    // Seek\n    player.seek(time_ms);\n    store.commit(\"setSeeker\", time_ms);\n}\nexport async function seekS(time_seconds) {\n    if (!active) return;\n\n    return seekMS(time_seconds * 1000);\n}\n\nlet playingSegment = null;\nexport async function playSegment(segment) {\n    if (!active) return;\n    store.commit(\"setSeeker\", segment.start * 1000);\n    resume().then(() => {\n        playingSegment = segment;\n        window.setTimeout(() => {\n            if (playingSegment === segment) {\n                pause();\n            }\n        }, segment.duration * 1000);\n    });\n}\n\nexport function setVolume(volume) {\n    if (!active) return;\n\n    if (player) {\n        player.setVolume(volume);\n    }\n}\n\nasync function stateChangedCallback(newState) {\n    if (!active) return;\n\n    if (!playedTrackBefore) return;\n    const { current_track, position, duration } = newState;\n    store.commit(\"setSeeker\", position);\n\n    const time = performance.now();\n    spotify.getMyCurrentPlaybackState().then((result) => {\n        if (locallyPaused || locallyResumed) {\n            if (locallyPaused && !result.is_playing) {\n                locallyPaused = false;\n            }\n            if (locallyResumed && result.is_playing) {\n                locallyResumed = false;\n            }\n        } else {\n            store.commit(\"setPlaying\", result.is_playing);\n        }\n    });\n}\n\nstore.watch(\n    (state) => state.seeker,\n    (newSeeker, oldSeeker) => {\n        //log.debug(\"Vuex Seeker: \", newSeeker);\n    }\n);\n\nstore.watch(\n    (state) => state.playing,\n    (newPlaying, oldPlaying) => {\n        //log.debug(\"Vuex Playing: \", newPlaying);\n    }\n);\n\nfunction startSeekerInterval() {\n    lastSeekerIntervalPoll = new Date();\n    setInterval(() => incrementSeeker(33), 33);\n}\nlet lastSeekerIntervalPoll;\nfunction incrementSeeker() {\n    if (store.state.playing) {\n        const now = new Date();\n        const elapsed = now - lastSeekerIntervalPoll;\n        lastSeekerIntervalPoll = now;\n        store.commit(\"incrementSeeker\", elapsed);\n    } else {\n        lastSeekerIntervalPoll = new Date();\n    }\n}\n\nexport async function initialize(token) {\n    waitForSpotifyWebPlaybackSDKToLoad().then(() => {\n        player = new window.Spotify.Player({\n            name: \"Music Structure Visualizer\",\n            getOAuthToken: (cb) => {\n                cb(token);\n            },\n            volume: 0.5,\n        });\n\n        // Error handling\n        player.addListener(\"initialization_error\", ({ message }) => {\n            log.error(message);\n        });\n        player.addListener(\"authentication_error\", ({ message }) => {\n            log.error(message);\n        });\n        player.addListener(\"account_error\", ({ message }) => {\n            log.error(message);\n        });\n        player.addListener(\"playback_error\", ({ message }) => {\n            log.error(message);\n        });\n        // Playback status updates\n        player.addListener(\"player_state_changed\", ({ position, duration, track_window: { current_track } }) => {\n            stateChangedCallback({ current_track, position, duration });\n        });\n\n        // Ready\n        player.addListener(\"ready\", ({ device_id }) => {\n            deviceId = device_id;\n            log.info(\"Ready with Device ID\", device_id);\n            const deviceIdArray = [deviceId];\n            if (autoConnect) {\n                spotify.transferMyPlayback(deviceIdArray).then((err, result) => {\n                    window.setTimeout(store.commit(\"playerReady\", true), 1);\n                    startSeekerInterval();\n                    active = true;\n                    store.commit(\"setPlayerActive\", active);\n                });\n            } else {\n                window.setTimeout(store.commit(\"playerReady\", true), 1);\n                startSeekerInterval();\n            }\n        });\n\n        // Not Ready\n        player.addListener(\"not_ready\", ({ device_id }) => {\n            log.warn(\"Device ID has gone offline\", device_id);\n        });\n\n        // Connect to the player!\n        player\n            .connect()\n            .then(() => {\n                log.info(\"Connected succesfully!!!\");\n            })\n            .catch((err) => {\n                log.error(\"Could not connect\");\n            });\n    });\n}\n\nexport function transferPlayback() {\n    if (!active) {\n        log.debug(\"Transfering playback\");\n        const deviceIdArray = [deviceId];\n        spotify.transferMyPlayback(deviceIdArray).then((result) => {});\n        active = true;\n        store.commit(\"setPlayerActive\", active);\n\n        loadTrack(store.getters.selectedTrack);\n    }\n}\n\nexport function releasePlayback() {\n    if (!active) return;\n    spotify.getMyDevices().then((result) => {\n        result.devices.forEach((device) => {\n            if (!device.is_active) {\n                spotify.transferMyPlayback([device.id]);\n                active = false;\n                store.commit(\"setPlayerActive\", active);\n                return true;\n            }\n        });\n    });\n    return false;\n}\n\nasync function waitForSpotifyWebPlaybackSDKToLoad() {\n    return new Promise((resolve) => {\n        if (window.Spotify) {\n            resolve(window.Spotify);\n        } else {\n            window.onSpotifyWebPlaybackSDKReady = () => {\n                resolve(window.Spotify);\n            };\n        }\n    });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',_vm._l((_vm.markers),function(marker){return _c('g',{key:marker.time},[_c('rect',{staticClass:\"marker\",style:((\"opacity: \" + _vm.opacity)),attrs:{\"x\":_vm.normalizeTime(marker.time) * _vm.width - 1.25,\"y\":_vm.showMarkerLabel ? _vm.markerLabelHeight : 0,\"width\":2.5,\"height\":_vm.height - (_vm.showMarkerLabel ? _vm.markerLabelHeight : 0),\"fill\":marker.color || 'grey'},on:{\"click\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"])){ return null; }if('button' in $event && $event.button !== 0){ return null; }return _vm.clickedMarker(marker)},\"dblclick\":function($event){return _vm.doubleClickMarker(marker)}}}),(_vm.showMarkerLabel)?_c('foreignObject',{attrs:{\"x\":_vm.normalizeTime(marker.time) * _vm.width - 1.25 - 3,\"y\":-_vm.markerLabelHeight / 2,\"width\":100,\"height\":_vm.markerLabelHeight * 2}},[_c('span',{staticClass:\"markerLabel\",style:((\"color: \" + (marker.color)))},[_vm._v(\" \"+_vm._s(marker.label)+\" \")])]):_vm._e(),(_vm.isShowingEdit(marker))?_c('g',[_c('foreignObject',{staticClass:\"editObject\",attrs:{\"x\":Math.min(_vm.width - 180, _vm.normalizeTime(marker.time) * _vm.width - 1.25 + 10),\"y\":0,\"width\":180,\"height\":_vm.height}},[_c('div',{staticClass:\"markerEditDiv\",attrs:{\"height\":_vm.height / 2},on:{\"blur\":function($event){return _vm.blur(marker)}}},[_c('v-text-field',{staticClass:\"px-5 pb-0\",on:{\"focus\":function($event){return _vm.$store.commit('setInputFocus', true)},\"blur\":function($event){return _vm.blur(marker)}},model:{value:(marker.label),callback:function ($$v) {_vm.$set(marker, \"label\", $$v)},expression:\"marker.label\"}}),_c('v-color-picker',{attrs:{\"hide-inputs\":\"\",\"hide-canvas\":\"\",\"height\":_vm.height / 2},model:{value:(marker.color),callback:function ($$v) {_vm.$set(marker, \"color\", $$v)},expression:\"marker.color\"}})],1)])],1):_vm._e()],1)}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <g>\n        <g v-for=\"marker in markers\" :key=\"marker.time\">\n            <rect\n                class=\"marker\"\n                :x=\"normalizeTime(marker.time) * width - 1.25\"\n                :y=\"showMarkerLabel ? markerLabelHeight : 0\"\n                :width=\"2.5\"\n                :height=\"height - (showMarkerLabel ? markerLabelHeight : 0)\"\n                :fill=\"marker.color || 'grey'\"\n                :style=\"`opacity: ${opacity}`\"\n                @click.left=\"clickedMarker(marker)\"\n                @dblclick=\"doubleClickMarker(marker)\"\n            ></rect>\n            <foreignObject\n                v-if=\"showMarkerLabel\"\n                :x=\"normalizeTime(marker.time) * width - 1.25 - 3\"\n                :y=\"-markerLabelHeight / 2\"\n                :width=\"100\"\n                :height=\"markerLabelHeight * 2\"\n            >\n                <span class=\"markerLabel\" :style=\"`color: ${marker.color}`\">\n                    {{ marker.label }}\n                </span>\n            </foreignObject>\n\n            <g v-if=\"isShowingEdit(marker)\">\n                <foreignObject\n                    :x=\"Math.min(width - 180, normalizeTime(marker.time) * width - 1.25 + 10)\"\n                    :y=\"0\"\n                    :width=\"180\"\n                    :height=\"height\"\n                    class=\"editObject\"\n                >\n                    <div class=\"markerEditDiv\" :height=\"height / 2\" @blur=\"blur(marker)\">\n                        <v-text-field\n                            class=\"px-5 pb-0\"\n                            v-model=\"marker.label\"\n                            @focus=\"$store.commit('setInputFocus', true)\"\n                            @blur=\"blur(marker)\"\n                        ></v-text-field>\n\n                        <v-color-picker\n                            v-model=\"marker.color\"\n                            hide-inputs\n                            hide-canvas\n                            :height=\"height / 2\"\n                        ></v-color-picker>\n                    </div>\n                </foreignObject>\n            </g>\n        </g>\n    </g>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport * as log from \"../../dev/log\";\nimport * as player from \"../../app/player\";\n\nexport default {\n    props: {\n        width: Number,\n        height: Number,\n        opacity: Number,\n        showMarkerLabel: Boolean,\n    },\n    data() {\n        return {\n            showingMarkerEdit: null,\n            markerLabelHeight: 15,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        loadingTrack() {\n            return this.$store.state.loadingTrack;\n        },\n        seekerNormalized() {\n            return this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000);\n        },\n        isZoomed() {\n            return this.$store.state.isZoomed;\n        },\n        zoomScale() {\n            return this.$store.getters.zoomScale;\n        },\n        markers() {\n            return this.track.markers;\n        },\n        inputFocus() {\n            return this.$store.state.inputFocus;\n        },\n    },\n    mounted() {\n        this._keyListener = function(e) {\n            if (event.keyCode === 13 && this.showingMarkerEdit) {\n                e.preventDefault();\n                this.showingMarkerEdit = null;\n            }\n        };\n        document.addEventListener(\"keydown\", this._keyListener.bind(this));\n    },\n    beforeDestroy() {\n        document.removeEventListener(\"keydown\", this._keyListener);\n    },\n    watch: {\n        inputFocus() {\n            log.debug(this.inputFocus);\n            if (!this.inputFocus) {\n                this.showingMarkerEdit = null;\n            }\n        },\n    },\n    methods: {\n        normalizeTime(time) {\n            return time / this.track.getAnalysisDuration();\n        },\n        clickedMarker(marker) {\n            player.seekS(marker.time);\n        },\n        doubleClickMarker(marker) {\n            log.debug(\"dblckick\");\n            this.showEdit(marker);\n        },\n        rightClick(event) {\n            let xNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n            } else {\n                xNormalized = event.offsetX / this.width;\n            }\n            this.track.placeMarker(xNormalized * this.track.getAnalysisDuration());\n        },\n        showEdit(marker) {\n            if (!this.isShowingEdit(marker)) {\n                this.showingMarkerEdit = marker;\n                this.$store.commit(\"setInputFocus\", true);\n            }\n        },\n        isShowingEdit(marker) {\n            return this.showingMarkerEdit === marker;\n        },\n        blur(marker) {\n            log.debug(\"blur\");\n            this.showingMarkerEdit = null;\n            this.$store.commit(\"setInputFocus\", false);\n        },\n    },\n};\n</script>\n\n<style>\n.marker {\n    z-index: -100;\n}\n.marker:hover {\n    fill: white !important;\n    opacity: 0.7 !important;\n    cursor: pointer;\n}\n.markerEditDiv {\n    background-color: rgba(50, 50, 50, 1);\n    border-radius: 5px;\n    z-index: 20;\n}\n.markerLabel {\n    font: 13px Roboto;\n}\n.editObject {\n    transform-style: preserve-3d;\n    z-index: 10;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Markers.vue?vue&type=template&id=2e6dff50&\"\nimport script from \"./Markers.vue?vue&type=script&lang=js&\"\nexport * from \"./Markers.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Markers.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VColorPicker } from 'vuetify/lib/components/VColorPicker';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VColorPicker,VTextField})\n","<template>\n    <svg\n        v-if=\"!loadingTrack\"\n        :height=\"height\"\n        :width=\"width\"\n        class=\"seekerSVG\"\n        :style=\"`transform: translate(${0}px, 0px);`\"\n        @click=\"clickedSVG\"\n        @click.right=\"rightClick\"\n        @contextmenu.prevent\n    >\n        <rect\n            class=\"seekerRect\"\n            :x=\"!isVertical * ((useZoom && isZoomed ? 0.5 : seekerNormalized) * width - 1.25)\"\n            :y=\"\n                isVertical * ((useZoom && isZoomed ? 0.5 : seekerNormalized) * height - 1.25) + showMarkerLabel ? 15 : 0\n            \"\n            :width=\"isVertical ? width * 2 : 2.5\"\n            :height=\"(isVertical ? 2.5 : height * 2) - (showMarkerLabel ? 15 : 0)\"\n            :fill=\"seekerColor\"\n        ></rect>\n        <Markers\n            :ref=\"'markers'\"\n            :v-if=\"drawMarkers\"\n            :width=\"width\"\n            :height=\"height\"\n            :opacity=\"markerOpacity || 0.3\"\n            :showMarkerLabel=\"showMarkerLabel\"\n        ></Markers>\n    </svg>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport * as log from \"../../dev/log\";\nimport * as player from \"../../app/player\";\nimport Markers from \"./Markers\";\n\nexport default {\n    props: [\"width\", \"height\", \"useZoom\", \"vertical\", \"color\", \"drawMarkers\", \"markerOpacity\", \"showMarkerLabel\"],\n    components: {\n        Markers,\n    },\n    data() {\n        return {};\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        loadingTrack() {\n            return this.$store.state.loadingTrack;\n        },\n        seekerNormalized() {\n            return this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000);\n        },\n        isZoomed() {\n            return this.$store.state.isZoomed;\n        },\n        zoomScale() {\n            return this.$store.getters.zoomScale;\n        },\n        isVertical() {\n            if (this.vertical) {\n                return 1;\n            } else {\n                return 0;\n            }\n        },\n        seekerColor() {\n            if (this.color) return this.color;\n            return this.isVertical ? \"#1D4924\" : \"#1DB954\";\n        },\n    },\n    mounted() {},\n    methods: {\n        clicked(event) {\n            this.clickedSVG(event);\n        },\n        clickedSVG(event) {\n            log.debug(\"CLickedseeker\");\n\n            this.$store.commit(\"setInputFocus\", false);\n            let xNormalized = 0;\n            let yNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n                yNormalized = event.layerY / this.height;\n            } else {\n                xNormalized = event.offsetX / this.width;\n                yNormalized = event.layerY / this.height;\n            }\n\n            if (this.useZoom && this.isZoomed) {\n                const xFromMiddle = xNormalized * 2 - 1;\n                const seekerPos = Math.min(1, Math.max(0, this.seekerNormalized + xFromMiddle / (2 * this.zoomScale)));\n                player.seekS(seekerPos * this.track.getAnalysisDuration());\n            } else {\n                player.seekS(xNormalized * this.track.getAnalysisDuration());\n            }\n        },\n        rightClick(event) {\n            this.$store.commit(\"setInputFocus\", false);\n            log.debug(this.$refs);\n            this.$refs.markers.rightClick(event);\n        },\n    },\n};\n</script>\n\n<style>\n.seekerSVG {\n    position: absolute;\n    z-index: 50;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Seeker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Seeker.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Seeker.vue?vue&type=template&id=50443007&\"\nimport script from \"./Seeker.vue?vue&type=script&lang=js&\"\nexport * from \"./Seeker.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Seeker.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div>\n        <v-card :width=\"width\">\n            <v-tabs v-if=\"trackVisready\" v-model=\"selectedTab\" dark center-active show-arrows>\n                <v-tab v-for=\"matrix in this.track.matrixes\" :key=\"matrix.name\">{{ matrix.name }}</v-tab>\n            </v-tabs>\n        </v-card>\n        <Seeker :width=\"width\" :height=\"width\" />\n        <Seeker :width=\"width\" :height=\"width\" :vertical=\"true\" />\n        <svg v-if=\"hasStructures\" class=\"annotations\" :height=\"width\" :width=\"width\">\n            <g v-for=\"(section, index) in selectedStructure.data\" :key=\"index\">\n                <rect\n                    v-if=\"showPathStart\"\n                    :x=\"section.start * secondsToXPosition - 1\"\n                    :y=\"0\"\n                    :width=\"2\"\n                    :height=\"width\"\n                    :fill=\"getCategoryColor(section.label)\"\n                    :opacity=\"0.8\"\n                ></rect>\n                <rect\n                    v-if=\"fillSections\"\n                    :x=\"section.start * secondsToXPosition\"\n                    :y=\"0\"\n                    :width=\"section.duration * secondsToXPosition\"\n                    :height=\"width\"\n                    :fill=\"getCategoryColor(section.label)\"\n                    :opacity=\"0.3\"\n                ></rect>\n                <g v-if=\"section.pathFamily && showPaths\">\n                    <g v-for=\"(path, pathIndex) in section.pathFamily\" :key=\"pathIndex\">\n                        <path\n                            fill=\"none\"\n                            stroke=\"black\"\n                            stroke-width=\"8\"\n                            :d=\"generateLine(path)\"\n                            class=\"path\"\n                            stroke-linejoin=\"round\"\n                        />\n                        <path\n                            fill=\"none\"\n                            :stroke=\"getCategoryColor(section.label)\"\n                            stroke-width=\"4\"\n                            :d=\"generateLine(path)\"\n                            class=\"path\"\n                            stroke-linejoin=\"round\"\n                        />\n                    </g>\n                </g>\n            </g>\n        </svg>\n        <canvas id=\"gl-canvas\" :height=\"width\" :width=\"width\" class=\"glCanvas pa-0 ma-0\"></canvas>\n        <v-row class=\"options-row\" v-if=\"hasStructures\" :style=\"`width: ${width}px`\">\n            <v-select\n                v-model=\"selectedStructure\"\n                :items=\"track.structures\"\n                item-text=\"name\"\n                return-object\n                label=\"Structure\"\n                solo\n            ></v-select>\n            <v-spacer></v-spacer>\n            <v-switch v-model=\"showPathStart\" label=\"Show Path Start\" hide-details></v-switch>\n            <v-switch v-model=\"fillSections\" label=\"Fill Sections\" hide-details></v-switch>\n            <v-switch v-model=\"showPaths\" label=\"Show Paths\" hide-details></v-switch>\n        </v-row>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport WebGLMatrixPool from \"../../app/webgl/WebGLMatrixPool\";\nimport * as d3 from \"d3\";\n\nimport Seeker from \"./Seeker\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            selectedStructure: { name: \"undefined\", data: [] },\n            fillSections: false,\n            showPathStart: false,\n            showPaths: false,\n            selectedTab: 0,\n            drawLoop: null,\n            webGLMatrixPool: null,\n        };\n    },\n    watch: {\n        zoomed() {\n            this.applyRenderMode();\n        },\n        selectedTab() {\n            this.setSelected();\n            this.draw();\n        },\n        track() {\n            this.webGLMatrixPool.clear();\n        },\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        hasStructures() {\n            return this.track && this.track.structures && this.track.structures.length > 0;\n        },\n        zoomed() {\n            return this.$store.getters.isZoomed;\n        },\n        zoomScale() {\n            return this.$store.getters.zoomScale;\n        },\n        seekerNormalized() {\n            return this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000);\n        },\n        secondsToXPosition() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        xCenterPositionNormalized() {\n            if (this.zoomed) {\n                return this.seekerNormalized;\n            } else {\n                return 0.5;\n            }\n        },\n        trackVisready() {\n            return this.track && this.track.matrixes.length > 0;\n        },\n        lineGenerator() {\n            return d3\n                .line()\n                .x((v) => {\n                    return (this.width / this.track.features.sampleAmount) * v[0];\n                })\n                .y((v) => {\n                    return (this.width / this.track.features.sampleAmount) * v[1];\n                });\n        },\n    },\n    mounted() {\n        this.webGLMatrixPool = new WebGLMatrixPool(document.getElementById(\"gl-canvas\"));\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            if (!this.track) log.error(\"SSM done but track does not exist\");\n            clearInterval(this.drawLoop);\n            this.selectedStructure = this.track.structures[this.track.structures.length - 1];\n\n            this.webGLMatrixPool.fillMatrixBufferPool(this.track, this.selectedTab);\n\n            this.setSelected();\n            this.applyRenderMode();\n        });\n        this._keyListener = function(e) {\n            if (e.key === \"p\" && (e.ctrlKey || e.metaKey)) {\n                e.preventDefault(); // present \"Save Page\" from getting triggered.\n                this.showPaths = !this.showPaths;\n            }\n        };\n        document.addEventListener(\"keydown\", this._keyListener.bind(this));\n    },\n    beforeDestroy() {\n        document.removeEventListener(\"keydown\", this._keyListener);\n    },\n    methods: {\n        setSelected() {\n            this.webGLMatrixPool.select(this.selectedTab);\n        },\n        draw() {\n            this.webGLMatrixPool.clear();\n            this.webGLMatrixPool.draw(0.5, 1, 1);\n            // no zoom pls  this.zoomed ? this.zoomScale : 1\n        },\n        applyRenderMode() {\n            clearInterval(this.drawLoop);\n            if (this.zoomed) {\n                this.drawLoop = setInterval(this.draw, this.$store.getters.seekerUpdateSpeed);\n            } else {\n                this.draw();\n            }\n        },\n        getCategoryColor(index) {\n            return vis.categoryColor(index);\n        },\n        generateLine(path) {\n            return this.lineGenerator(path);\n        },\n    },\n};\n</script>\n\n<style>\n.SPcanvas {\n    background-color: \"white\";\n    width: 100%;\n    height: 100%;\n}\n.annotations {\n    position: absolute;\n    z-index: 5;\n}\n.options-row {\n    z-index: 20;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Matrixes.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Matrixes.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Matrixes.vue?vue&type=template&id=49ca4c1a&\"\nimport script from \"./Matrixes.vue?vue&type=script&lang=js&\"\nexport * from \"./Matrixes.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Matrixes.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTab } from 'vuetify/lib/components/VTabs';\nimport { VTabs } from 'vuetify/lib/components/VTabs';\ninstallComponents(component, {VCard,VRow,VSelect,VSpacer,VSwitch,VTab,VTabs})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('p',{staticClass:\"pa-0 ma-0\"},[_vm._v(\"Spotify Sections\")]),_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.height,\"useZoom\":\"true\"}}),_c('canvas',{ref:\"GTcanvas\",staticClass:\"GTcanvas pa-0 ma-0\",attrs:{\"id\":\"GTcanvas\",\"height\":_vm.height,\"width\":_vm.width}}),(_vm.track)?_c('div',[(_vm.trackHasGroundTruth)?_c('p',{staticClass:\"pa-0 ma-0\",style:((\"transform: translate(0px, \" + (-_vm.height + 15) + \"px);\"))},[_vm._v(\" Ground Truth \")]):_vm._e()]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as log from \"../../dev/log\";\nimport * as d3 from \"d3\";\nimport store from \"../../store\";\n\nexport default class ZoomCanvas {\n    drawLoop = null;\n    canvas = null;\n    ctx = null;\n    trackDuration = 0;\n    width = 0;\n    height = 0;\n    zoomed = false;\n    zoomScale = 1;\n    drawFunction = null;\n\n    constructor(canvas, type = \"2d\") {\n        this.canvas = canvas;\n        if (!canvas) {\n            log.error(\"canvas not ready\");\n            return;\n        }\n        this.ctx = canvas.getContext(type);\n        this.width = this.canvas.width;\n        this.height = this.canvas.height;\n        this.clear();\n    }\n\n    clear() {\n        this.ctx.clearRect(0, 0, this.width, this.height);\n    }\n\n    setTrackDuration(track) {\n        this.trackDuration = track.getAnalysisDuration();\n    }\n\n    setZoomed(zoomed) {\n        this.zoomed = zoomed;\n        this.zoomScale = store.state.zoomScale;\n        this.applyRenderMode();\n    }\n\n    setWidth(width) {\n        this.width = width;\n        this.canvas.width = width;\n        setTimeout(() => this.applyRenderMode(), 0);\n    }\n\n    setHeight(height) {\n        this.height = height;\n        this.canvas.height = height;\n        setTimeout(() => this.applyRenderMode(), 0);\n    }\n\n    setDrawFunction(drawFunction) {\n        this.drawFunction = drawFunction;\n        this.applyRenderMode();\n    }\n\n    applyRenderMode() {\n        clearInterval(this.drawLoop);\n        if (this.zoomed) {\n            this.drawLoop = setInterval(() => this.clearAndDraw(), store.state.seekerUpdateSpeed);\n        } else {\n            this.clearAndDraw();\n        }\n    }\n\n    clearAndDraw() {\n        this.clear();\n        this.drawFunction();\n    }\n\n    getSeekerNormalized() {\n        return store.state.seeker / (this.trackDuration * 1000);\n    }\n\n    getOffsetXNormalized() {\n        return this.zoomed ? 0.5 - this.getSeekerNormalized() * this.zoomScale : 0;\n    }\n\n    drawRect(start, y, duration, height, color) {\n        let startNormalized = start / this.trackDuration;\n        if (this.zoomed) startNormalized *= this.zoomScale;\n\n        const x = (startNormalized + this.getOffsetXNormalized()) * this.width;\n        const width = (duration / this.trackDuration) * (this.zoomed ? this.zoomScale : 1) * this.width;\n        this.ctx.fillStyle = color;\n        this.ctx.fillRect(x, y, width, height);\n    }\n\n    drawRectWithBorder(start, y, duration, height, color, borderSize, borderColor) {\n        let startNormalized = start / this.trackDuration;\n        if (this.zoomed) startNormalized *= this.zoomScale;\n\n        const x = (startNormalized + this.getOffsetXNormalized()) * this.width;\n        const width = (duration / this.trackDuration) * (this.zoomed ? this.zoomScale : 1) * this.width;\n        if (borderColor !== null) {\n            this.ctx.fillStyle = borderColor;\n            this.ctx.fillRect(x, y, width, height);\n        }\n        this.ctx.fillStyle = color;\n        this.ctx.fillRect(x + borderSize, y + borderSize, width - borderSize * 2, height - borderSize * 2);\n    }\n\n    drawVerticalLine(start, y, width, height, color) {\n        let startNormalized = start / this.trackDuration;\n        if (this.zoomed) startNormalized *= this.zoomScale;\n\n        const x = (startNormalized + this.getOffsetXNormalized()) * this.width;\n        this.ctx.fillStyle = color;\n        this.ctx.fillRect(x, y, width, height);\n    }\n\n    drawText(start, y, text, color = \"white\", font = \"12px Roboto\") {\n        let startNormalized = start / this.trackDuration;\n        if (this.zoomed) startNormalized *= this.zoomScale;\n\n        const x = (startNormalized + this.getOffsetXNormalized()) * this.width;\n\n        this.ctx.fillStyle = color;\n        this.ctx.font = font;\n        this.ctx.fillText(text, x, y);\n    }\n\n    drawTitle(y, text, color = \"white\", font = \"16px Roboto\") {\n        const x = 0;\n\n        this.ctx.fillStyle = color;\n        this.ctx.font = font;\n        this.ctx.fillText(text, x, y);\n    }\n}\n","<template>\n    <div>\n        <p class=\"pa-0 ma-0\">Spotify Sections</p>\n\n        <Seeker :width=\"width\" :height=\"height\" useZoom=\"true\" />\n        <canvas id=\"GTcanvas\" ref=\"GTcanvas\" class=\"GTcanvas pa-0 ma-0\" :height=\"height\" :width=\"width\"></canvas>\n        <div v-if=\"track\">\n            <p v-if=\"trackHasGroundTruth\" class=\"pa-0 ma-0\" :style=\"`transform: translate(0px, ${-height + 15}px);`\">\n                Ground Truth\n            </p>\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            allowedNamespaces: [testing.namespaces.coarse, testing.namespaces.fine],\n            blockHeight: 20,\n            innerSpacing: 3,\n            zoomCanvas: null,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        trackHasGroundTruth() {\n            log.debug(\"TESTING IF IT HAS GROUND TRUTH\", this.track.groundTruth);\n            return this.track && this.track.groundTruth !== null;\n        },\n        height() {\n            return (\n                (1 + (this.trackHasGroundTruth ? this.allowedNamespaces.length + 1 : 0)) *\n                (this.blockHeight + this.innerSpacing)\n            );\n        },\n        zoomed() {\n            return this.$store.getters.isZoomed;\n        },\n    },\n    watch: {\n        width() {\n            this.zoomCanvas.setWidth(this.width);\n        },\n        zoomed() {\n            this.zoomCanvas.setZoomed(this.zoomed);\n        },\n    },\n    mounted() {\n        this.zoomCanvas = new ZoomCanvas(document.getElementById(\"GTcanvas\"));\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            this.zoomCanvas.setTrackDuration(this.track);\n            this.zoomCanvas.setDrawFunction(this.drawGT);\n        });\n        this.zoomCanvas.setTrackDuration(this.track);\n        this.zoomCanvas.setDrawFunction(this.drawGT);\n    },\n    methods: {\n        drawGT() {\n            const allAllowedNamespaces = [].concat.apply([], this.allowedNamespaces);\n            const trackDuration = this.track.getAnalysisDuration();\n\n            let y = 0;\n            const height = this.blockHeight + this.innerSpacing;\n\n            this.track.getAnalysis().sections.forEach((section, index) => {\n                this.zoomCanvas.drawRectWithBorder(\n                    section.start,\n                    y,\n                    section.duration,\n                    height,\n                    vis.categoryColor(index),\n                    1,\n                    null\n                );\n            });\n            y += height;\n\n            if (!this.track.groundTruth) return;\n            const annotations = this.track.groundTruth.annotations;\n\n            allAllowedNamespaces.forEach((allowedNamespace) => {\n                const annotation = annotations.find((a) => allowedNamespace.includes(a.namespace));\n                if (!annotation) return;\n                y += height;\n                const uniqueValues = [];\n                annotation.data.forEach((segment) => {\n                    const confidence = segment.confidence;\n                    const duration = segment.duration;\n                    const time = segment.time;\n                    const value = segment.value;\n                    if (!uniqueValues.includes(value)) {\n                        uniqueValues.push(value);\n                    }\n\n                    this.zoomCanvas.drawRectWithBorder(\n                        time,\n                        y + this.innerSpacing,\n                        duration,\n                        this.blockHeight,\n                        vis.categoryColor(uniqueValues.indexOf(value)),\n                        1,\n                        null\n                    );\n                    //this.zoomCanvas.drawText(time + 0.5, y + this.innerSpacing + this.blockHeight * 0.75, value);\n                });\n            });\n        },\n    },\n};\n</script>\n\n<style>\n.GTcanvas {\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GroundTruth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GroundTruth.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GroundTruth.vue?vue&type=template&id=473e38b8&\"\nimport script from \"./GroundTruth.vue?vue&type=script&lang=js&\"\nexport * from \"./GroundTruth.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GroundTruth.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.track)?_c('div',_vm._l((_vm.features),function(feature,index){return _c('div',{key:feature.name},[_c('Graph',{attrs:{\"width\":_vm.width,\"height\":_vm.height,\"featureIndex\":index}})],1)}),0):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.track && _vm.hasFeatures)?_c('div',[_c('v-row',[_c('v-btn',{staticClass:\"pa-0 ma-0\",attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.expanded = !_vm.expanded}}},[_c('v-icon',[_vm._v(_vm._s(_vm.expanded ? \"mdi-chevron-up\" : \"mdi-chevron-down\"))])],1),_c('p',{staticClass:\"pa-0 ma-0\",on:{\"click\":function($event){_vm.expanded = !_vm.expanded}}},[_vm._v(_vm._s(_vm.feature.name))])],1),_c('v-expand-transition',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.expanded),expression:\"expanded\"}]},[_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.height}}),_c('svg',{attrs:{\"width\":_vm.width + 25,\"height\":_vm.height}},[_c('path',{staticClass:\"graphPath\",attrs:{\"fill\":\"none\",\"stroke\":\"white\",\"stroke-width\":\"2\",\"d\":_vm.d}}),_c('rect',{staticStyle:{\"fill\":\"none\",\"stroke\":\"grey\",\"stroke-width\":\"1\",\"fill-opacity\":\"0\",\"stroke-opacity\":\"1\"},attrs:{\"x\":\"0\",\"y\":\"0\",\"width\":_vm.width,\"height\":_vm.height}}),_c('text',{attrs:{\"x\":_vm.width + 2,\"y\":\"7\",\"font-size\":\"10\",\"fill\":\"white\"}},[_vm._v(_vm._s(parseFloat(_vm.max).toFixed(2)))]),_c('text',{attrs:{\"x\":_vm.width + 2,\"y\":_vm.height,\"font-size\":\"10\",\"fill\":\"white\"}},[_vm._v(\" \"+_vm._s(parseFloat(_vm.min).toFixed(2))+\" \")])])],1)])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div v-if=\"track && hasFeatures\">\n        <v-row>\n            <v-btn icon small class=\"pa-0 ma-0\" @click=\"expanded = !expanded\"\n                ><v-icon>{{ expanded ? \"mdi-chevron-up\" : \"mdi-chevron-down\" }}</v-icon>\n            </v-btn>\n            <p @click=\"expanded = !expanded\" class=\"pa-0 ma-0\">{{ feature.name }}</p>\n        </v-row>\n        <v-expand-transition>\n            <div v-show=\"expanded\">\n                <Seeker :width=\"width\" :height=\"height\" />\n                <svg :width=\"width + 25\" :height=\"height\">\n                    <path fill=\"none\" stroke=\"white\" stroke-width=\"2\" :d=\"d\" class=\"graphPath\" />\n                    <rect\n                        x=\"0\"\n                        y=\"0\"\n                        :width=\"width\"\n                        :height=\"height\"\n                        style=\"fill:none; stroke:grey; stroke-width:1; fill-opacity:0; stroke-opacity:1;\"\n                    />\n                    <text :x=\"width + 2\" y=\"7\" font-size=\"10\" fill=\"white\">{{ parseFloat(max).toFixed(2) }}</text>\n                    <text :x=\"width + 2\" :y=\"height\" font-size=\"10\" fill=\"white\">\n                        {{ parseFloat(min).toFixed(2) }}\n                    </text>\n                </svg>\n            </div>\n        </v-expand-transition>\n    </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport * as log from \"../../dev/log\";\nimport Seeker from \"./Seeker\";\n\nexport default {\n    props: [\"width\", \"height\", \"featureIndex\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            expanded: true,\n            max: 0,\n            min: 0,\n            d: null,\n        };\n    },\n    watch: {\n        width() {\n            this.generateLine();\n        },\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        hasFeatures() {\n            return this.track.graphFeatures.length > 0;\n        },\n        feature() {\n            return this.track.graphFeatures[this.featureIndex];\n        },\n        step() {\n            return this.width / (this.feature.data.length - 1);\n        },\n        lineGenerator() {\n            return d3\n                .line()\n                .x((v, i) => {\n                    return this.step * i;\n                })\n                .y((v) => {\n                    return this.height - this.lmap(v, this.min, this.max) * this.height;\n                });\n        },\n    },\n    mounted() {\n        this.generateLine();\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            this.generateLine();\n        });\n    },\n    methods: {\n        lmap(val, min, max) {\n            return (val - min) / (max - min);\n        },\n        generateLine() {\n            if (this.feature.min !== undefined) {\n                this.min = this.feature.min;\n            } else {\n                this.min = Math.min(...this.feature.data);\n            }\n            if (this.feature.max !== undefined) {\n                this.max = this.feature.max;\n            } else {\n                this.max = Math.max(...this.feature.data);\n            }\n            this.d = this.lineGenerator(this.feature.data);\n        },\n    },\n};\n</script>\n\n<style>\n.graphTitle {\n    color: white;\n}\n.icon__flip {\n    -moz-transform: scaleX(-1);\n    -o-transform: scaleX(-1);\n    -webkit-transform: scaleX(-1);\n    transform: scaleX(-1);\n    filter: FlipH;\n    -ms-filter: \"FlipH\";\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Graph.vue?vue&type=template&id=06906b43&\"\nimport script from \"./Graph.vue?vue&type=script&lang=js&\"\nexport * from \"./Graph.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Graph.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VExpandTransition } from 'vuetify/lib/components/transitions';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VExpandTransition,VIcon,VRow})\n","<template>\n    <div v-if=\"track\">\n        <div v-for=\"(feature, index) in features\" :key=\"feature.name\">\n            <Graph :width=\"width\" :height=\"height\" :featureIndex=\"index\" />\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport * as log from \"../../dev/log\";\nimport Graph from \"./Graph\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Graph,\n    },\n    data() {\n        return {\n            height: 60,\n            features: [],\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n    },\n    mounted() {\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            if (this.features.length <= 0) {\n                this.track.graphFeatures.forEach((feature, index) => {\n                    this.features.push(feature.name);\n                });\n            }\n        });\n    },\n};\n</script>\n\n<style>\n.graphTitle {\n    color: white;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graphs.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graphs.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Graphs.vue?vue&type=template&id=094df5e2&\"\nimport script from \"./Graphs.vue?vue&type=script&lang=js&\"\nexport * from \"./Graphs.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Graphs.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.track && _vm.createScapePlot)?_c('canvas',{ref:\"SPcanvas\",staticClass:\"SPcanvas pa-0 ma-0\",attrs:{\"id\":\"SPcanvas\",\"height\":_vm.width,\"width\":_vm.width}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <canvas\n        v-if=\"track && createScapePlot\"\n        id=\"SPcanvas\"\n        ref=\"SPcanvas\"\n        class=\"SPcanvas pa-0 ma-0\"\n        :height=\"width\"\n        :width=\"width\"\n    ></canvas>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport * as Track from \"../../app/Track\";\nexport default {\n    props: [\"width\"],\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        createScapePlot() {\n            return Track.createScapePlot;\n        },\n    },\n    mounted() {\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            if (this.createScapePlot) {\n                this.drawSP();\n            }\n        });\n    },\n    methods: {\n        drawSP() {\n            if (!this.createScapePlot) return;\n            const canvas = document.getElementById(\"SPcanvas\");\n            if (!canvas) {\n                log.error(\"canvas not ready\");\n                return;\n            }\n            const ctx = canvas.getContext(\"2d\");\n\n            //vis.drawScapePlot(this.track, ctx, this.width);\n            vis.drawScapePlot(this.track, ctx, this.width, false);\n        },\n    },\n};\n</script>\n\n<style>\n.SPcanvas {\n    background-color: \"white\";\n    width: 100%;\n    height: 100%;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ScapePlot.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ScapePlot.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ScapePlot.vue?vue&type=template&id=c594d928&\"\nimport script from \"./ScapePlot.vue?vue&type=script&lang=js&\"\nexport * from \"./ScapePlot.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ScapePlot.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.height,\"useZoom\":true}}),_c('canvas',{ref:\"Beatcanvas\",staticClass:\"Beatcanvas pa-0 ma-0\",attrs:{\"id\":\"Beatcanvas\",\"height\":_vm.height,\"width\":_vm.width}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <Seeker :width=\"width\" :height=\"height\" :useZoom=\"true\" />\n        <canvas id=\"Beatcanvas\" ref=\"Beatcanvas\" class=\"Beatcanvas pa-0 ma-0\" :height=\"height\" :width=\"width\"></canvas>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            // possible elements: bars, beats, tatums\n            elements: [\"bars\", \"beats\", \"tatums\"],\n            elementHeight: 10,\n            elementWidth: 1,\n            zoomCanvas: null,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        height() {\n            return this.elements.length * this.elementHeight;\n        },\n        scale() {\n            return this.width;\n        },\n        zoomed() {\n            return this.$store.getters.isZoomed;\n        },\n    },\n    watch: {\n        width() {\n            this.zoomCanvas.setWidth(this.width);\n        },\n        zoomed() {\n            this.zoomCanvas.setZoomed(this.zoomed);\n        },\n    },\n    mounted() {\n        this.zoomCanvas = new ZoomCanvas(document.getElementById(\"Beatcanvas\"));\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            this.zoomCanvas.setTrackDuration(this.track);\n            this.zoomCanvas.setDrawFunction(this.draw);\n        });\n    },\n    methods: {\n        draw() {\n            let y = 0;\n            this.drawElements(this.track.getBars(), y);\n            y += this.elementHeight;\n\n            this.drawElements(this.track.getBeats(), y);\n            y += this.elementHeight;\n\n            this.drawElements(this.track.getTatums(), y);\n        },\n        drawElements(elements, y) {\n            elements.forEach((element) => {\n                this.zoomCanvas.drawVerticalLine(\n                    element.start,\n                    y,\n                    this.elementWidth,\n                    this.elementHeight,\n                    vis.zeroOneColor(element.confidence)\n                );\n            });\n        },\n    },\n};\n</script>\n\n<style>\n.GTcanvas {\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Beats.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Beats.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Beats.vue?vue&type=template&id=3d30a96c&\"\nimport script from \"./Beats.vue?vue&type=script&lang=js&\"\nexport * from \"./Beats.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Beats.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.height,\"useZoom\":true}}),_c('canvas',{ref:\"PTcanvas\",staticClass:\"PTcanvas pa-0 ma-0\",attrs:{\"id\":\"PTcanvas\",\"height\":_vm.height,\"width\":_vm.width}}),(_vm.selectedFeatures)?_c('div',_vm._l((_vm.selectedFeatures),function(feature,index){return _c('p',{key:feature.name,style:((\"transform: translate(0px, \" + (-_vm.height - 10 + index * (_vm.featureHeight - 40)) + \"px);\"))},[_vm._v(\" \"+_vm._s(feature.name)+\" \")])}),0):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import WebGL from \"./WebGL\";\nimport assert from \"assert\";\nimport * as log from \"../../dev/log\";\nimport Matrix from \"../dataStructures/Matrix\";\nimport * as vis from \"../vis\";\nimport * as d3 from \"d3\";\n\nexport default class WebGLPitchTimbre extends WebGL {\n    pitchTimbreBufferPool;\n    inverseBufferPoolLength = 0;\n    bufferPoolLength = 0;\n\n    marginPercentage = 0.8;\n\n    constructor(canvas) {\n        const useColor = true;\n        super(canvas, useColor); // colored\n    }\n\n    fillpitchTimbreBufferPool(track, featureSelection) {\n        assert(track.matrixes, \"track does not have matrixes\");\n        this.pitchTimbreBufferPool = new Array(featureSelection.length);\n        this.inverseBufferPoolLength = 1 / featureSelection.length;\n        this.bufferPoolLength = featureSelection.length;\n\n        featureSelection.forEach((featureObject, index) => {\n            this.pitchTimbreBufferPool[index] = this.createSegmentFeatureDataArray(\n                track,\n                featureObject.data,\n                featureObject.sampled,\n                featureObject.range,\n                featureObject.featureAmount,\n            );\n        });\n    }\n\n    inverseBufferPoolLength() {\n        return 1 / this.pitchTimbreBufferPool;\n    }\n\n    draw(xCenterPositionNormalized, scaleX, scaleY) {\n        for (let i = 0; i < this.bufferPoolLength; i++) {\n            this.setBufferData(this.pitchTimbreBufferPool[i]);\n            const scale = this.inverseBufferPoolLength * this.marginPercentage;\n            super.draw(\n                (1 - xCenterPositionNormalized * 2) * scaleX,\n                1 - this.inverseBufferPoolLength - i * 2 * this.inverseBufferPoolLength,\n                scaleX,\n                scale\n            );\n        }\n    }\n\n    createSegmentFeatureDataArray(track, feature, sampled, range, featureAmount) {\n        const startDuration = sampled ? track.features.sampleStartDuration : track.features.segmentStartDuration;\n        const segmentAmount = startDuration.length;\n        const vectorSize = featureAmount || feature[0].length || 1;\n        const inverseVectorSize = 1 / vectorSize;\n        range = range || [0, 1];\n        const centeredRange = range[0] === -range[1];\n\n        this.bufferSize = segmentAmount * vectorSize * 6;\n        if (this.bufferSize > 22e6) {\n            log.error(\"Buffer OVERFLOW with size\", this.bufferSize);\n        }\n\n        const halfDuration = track.getAnalysisDuration() / 2;\n        function st(pos) {\n            return pos / halfDuration - 1;\n        } // Scale and translate\n\n        const featureVertices = [];\n        const colors = [];\n        for (let s = 0; s < segmentAmount; s++) {\n            if(vectorSize === 1){\n                const y = .8;\n                const left = st(startDuration[s][0]);\n                const top = y;\n                const right = st(startDuration[s][0] + startDuration[s][1]);\n                const bottom = .3;\n                let value, color;\n                value = feature[s];\n                if (centeredRange) {\n                    color = d3.rgb(vis.divergingColor(value / range[1]));\n                } else {\n                    color = d3.rgb(vis.pitchColor(value));\n                }\n                const r = color.r / 255;\n                const g = color.g / 255;\n                const b = color.b / 255;\n                featureVertices.push(left, top, left, bottom, right, top, right, top, left, bottom, right, bottom);\n                colors.push(r, g, b, r, g, b, r, g, b, r, g, b, r, g, b, r, g, b);\n            }\n            for (let i = 0; i < vectorSize; i++) {\n                const y = -1 + 2 * i * inverseVectorSize;\n                const left = st(startDuration[s][0]);\n                const top = y;\n                const right = st(startDuration[s][0] + startDuration[s][1]);\n                const bottom = y - 2 * inverseVectorSize;\n                let value, color;\n                value = feature[s][i];\n                if (centeredRange) {\n                    color = d3.rgb(vis.divergingColor(value / range[1]));\n                } else {\n                    color = d3.rgb(vis.pitchColor(value));\n                }\n                const r = color.r / 255;\n                const g = color.g / 255;\n                const b = color.b / 255;\n                featureVertices.push(left, top, left, bottom, right, top, right, top, left, bottom, right, bottom);\n                colors.push(r, g, b, r, g, b, r, g, b, r, g, b, r, g, b, r, g, b);\n            }\n        }\n\n        return { verts: new Float32Array(featureVertices), colors: new Float32Array(colors) };\n    }\n}\n","<template>\n    <div>\n        <Seeker :width=\"width\" :height=\"height\" :useZoom=\"true\" />\n        <canvas id=\"PTcanvas\" ref=\"PTcanvas\" class=\"PTcanvas pa-0 ma-0\" :height=\"height\" :width=\"width\"></canvas>\n        <div v-if=\"selectedFeatures\">\n            <p\n                v-for=\"(feature, index) in selectedFeatures\"\n                :key=\"feature.name\"\n                :style=\"`transform: translate(0px, ${-height - 10 + index * (featureHeight - 40)}px);`\"\n            >\n                {{ feature.name }}\n            </p>\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport * as filter from \"../../app/filter\";\n\nimport Seeker from \"./Seeker\";\nimport WebGLPitchTimbre from \"../../app/webgl/WebGLPitchTimbre\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            webGLPitchTimbre: null,\n            selectedFeatures: null,\n            featureHeight: 200,\n        };\n    },\n    watch: {\n        zoomed() {\n            this.applyRenderMode();\n        },\n        track() {\n            this.webGLPitchTimbre.clear();\n        },\n        seekerNormalized() {\n            this.draw();\n        },\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        zoomed() {\n            return this.$store.getters.isZoomed;\n        },\n        zoomScale() {\n            return this.$store.getters.zoomScale;\n        },\n        seekerNormalized() {\n            return this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000);\n        },\n        xCenterPositionNormalized() {\n            if (this.zoomed) {\n                return this.seekerNormalized;\n            } else {\n                return 0.5;\n            }\n        },\n        height() {\n            if (!this.selectedFeatures) return 100;\n            return this.selectedFeatures.length * this.featureHeight;\n        },\n    },\n    mounted() {\n        this.webGLPitchTimbre = new WebGLPitchTimbre(document.getElementById(\"PTcanvas\"));\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            if (!this.track) log.error(\"Processing done but track does not exist\");\n\n            this.selectedFeatures = [\n                { name: \"Pitch raw\", data: this.track.features.raw.pitches, sampled: false, featureAmount: 12 },\n                { name: \"Pitch Noise\", data: this.track.features.processed.noise, sampled: false, featureAmount: 12 },\n\n                {\n                    name: \"Pitch processed\",\n                    data: this.track.features.processed.pitches,\n                    sampled: false,\n                    featureAmount: 12,\n                },\n                { name: \"Pitch sampled\", data: this.track.features.sampled.pitches, sampled: true, featureAmount: 12 },\n                {\n                    name: \"Major / Minor\",\n                    data: this.track.features.sampled.majorminor,\n                    sampled: true,\n                    featureAmount: 1,\n                    range: [-1, 1],\n                },\n                {\n                    name: \"Chords\",\n                    data: this.track.chordsVector,\n                    sampled: true,\n                    featureAmount: 24,\n                    range: [0, 1],\n                },\n                {\n                    name: \"Timbre raw\",\n                    data: this.track.features.raw.timbres,\n                    sampled: false,\n                    range: [-300, 300],\n                    featureAmount: 12,\n                },\n                {\n                    name: \"Timbre processed\",\n                    data: this.track.features.processed.timbres,\n                    sampled: false,\n                    range: [-1, 1],\n                    featureAmount: 12,\n                },\n                {\n                    name: \"Timbre Sampled\",\n                    data: this.track.features.sampled.timbres,\n                    sampled: true,\n                    range: [-1, 1],\n                    featureAmount: 12,\n                },\n                {\n                    name: \"Timbre Sampled Averaged\",\n                    data: filter.gaussianBlurFeatures(this.track.features.sampled.timbres, 5),\n                    sampled: true,\n                    range: [-1, 1],\n                    featureAmount: 12,\n                },\n                {\n                    name: \"Frankenfeatures Sampled\",\n                    data: this.track.features.sampled.frankenFeatures,\n                    sampled: true,\n                    range: [-1, 1],\n                    featureAmount: 12,\n                },\n                {\n                    name: \"smoothed Sampled\",\n                    data: this.track.features.sampled.smoothedTimbre,\n                    sampled: true,\n                    range: [-1, 1],\n                    featureAmount: 12,\n                },\n            ];\n            this.webGLPitchTimbre.setHeight(this.height);\n            this.webGLPitchTimbre.fillpitchTimbreBufferPool(this.track, this.selectedFeatures);\n            this.applyRenderMode();\n        });\n    },\n    methods: {\n        draw() {\n            log.debug(\"Redraw\");\n            this.webGLPitchTimbre.clear();\n            this.webGLPitchTimbre.draw(this.xCenterPositionNormalized, this.zoomed ? this.zoomScale : 1, 1);\n        },\n        applyRenderMode() {\n            clearInterval(this.drawLoop);\n            if (this.zoomed) {\n                this.draw();\n                //this.drawLoop = setInterval(this.draw, this.$store.getters.seekerUpdateSpeed*5);\n            } else {\n                this.draw();\n            }\n        },\n    },\n};\n</script>\n\n<style>\n.GTcanvas {\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PitchTimbre.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PitchTimbre.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PitchTimbre.vue?vue&type=template&id=3cb7f9b6&\"\nimport script from \"./PitchTimbre.vue?vue&type=script&lang=js&\"\nexport * from \"./PitchTimbre.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PitchTimbre.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.hasStructure)?_c('div',[_vm._l((_vm.track.structures),function(structure){return _c('div',{key:structure.name,staticClass:\"structure\"},[_c('v-row',{staticClass:\"mb-0 pt-2\"},[(!structure.separateByGroup)?_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){return _vm.clickStructureUnfold(structure)}}},[_c('v-icon',[_vm._v(\" \"+_vm._s(structure.verticalPosition ? \"mdi-unfold-less-horizontal\" : \"mdi-unfold-more-horizontal\")+\" \")])],1):_vm._e(),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\",\"color\":structure.showLoudness ? 'white' : 'dimgrey'},on:{\"click\":function($event){return _vm.clickStructureshowLoudness(structure)}}},[_c('v-icon',[_vm._v(\"mdi-equalizer\")])],1),_c('p',[_vm._v(_vm._s(structure.name))]),_c('v-spacer'),_c('div',{staticStyle:{\"width\":\"6em\"}},[_c('v-btn',{attrs:{\"small\":\"\",\"icon\":\"\"},on:{\"click\":function($event){return _vm.clickStructureChangeVertical(structure)}}},[_c('v-icon',{attrs:{\"dark\":\"\"}},[_vm._v(\"mdi-format-line-spacing\")])],1),_c('span',{staticStyle:{\"color\":\"grey\"}},[_vm._v(\" \"+_vm._s(structure.vertLayout || _vm.layouts[0])+\" \")])],1),_c('div',{staticStyle:{\"width\":\"6em\"}},[_c('v-btn',{attrs:{\"small\":\"\",\"icon\":\"\"},on:{\"click\":function($event){return _vm.clickStructureChangeColor(structure)}}},[_c('v-icon',{attrs:{\"dark\":\"\"}},[_vm._v(\"mdi-palette\")])],1),_c('span',{staticStyle:{\"color\":\"grey\"}},[_vm._v(\" \"+_vm._s(structure.colorLayout || _vm.layouts[0])+\" \")])],1),_c('div',{staticStyle:{\"width\":\"2.5em\"}})],1),_c('Seeker',{ref:'seeker' + structure.name,refInFor:true,staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.heightOfStructure(structure)}}),_c('svg',{staticClass:\"structureSVG\",attrs:{\"width\":_vm.width,\"height\":_vm.heightOfStructure(structure)},on:{\"mouseout\":function($event){return _vm.unhover()}}},[_c('rect',{staticClass:\"structureBackground\",attrs:{\"x\":\"0\",\"y\":\"0\",\"width\":_vm.width,\"height\":_vm.heightOfStructure(structure),\"fill\":\"#1a1a1a\"},on:{\"click\":function($event){return _vm.clickBackground($event, structure)},\"mouseover\":function($event){return _vm.unhover()},\"mouseout\":function($event){return _vm.unhover()}}}),_vm._l((structure.data),function(section,index){return _c('g',{key:index},[(!structure.showLoudness)?_c('rect',{staticClass:\"section\",attrs:{\"stroke\":\"none\",\"stroke-width\":\".5\",\"rx\":\"5\",\"x\":section.start * _vm.scale,\"y\":_vm.sectionVerticalPosition(structure, section),\"width\":(section.end - section.start) * _vm.scale,\"height\":_vm.blockHeight,\"fill\":_vm.sectionColor(structure, section)},on:{\"mouseover\":function($event){return _vm.hoverSection($event, section, structure)},\"mouseout\":function($event){return _vm.unhoverSection(section)},\"click\":function($event){return _vm.clickSection($event, section)}}}):_vm._e(),(structure.showLoudness)?_c('path',{staticClass:\"shapedSection\",attrs:{\"d\":_vm.generatePointsForShapedSection(structure, section),\"fill\":_vm.sectionColor(structure, section)},on:{\"mouseover\":function($event){return _vm.hoverSection($event, section, structure)},\"mouseout\":function($event){return _vm.unhoverSection(section)},\"click\":function($event){return _vm.clickSection($event, section)}}}):_vm._e()])})],2),(_vm.hasStructure)?_c('MDS',{attrs:{\"size\":_vm.width / 3,\"sections\":structure.data}}):_vm._e()],1)}),_c('v-tooltip',{staticClass:\"tooltip\",attrs:{\"id\":\"tooltip\",\"bottom\":\"\"},model:{value:(_vm.showTooltip),callback:function ($$v) {_vm.showTooltip=$$v},expression:\"showTooltip\"}},[_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.toolTipText)}})])],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"mdsSVG\",staticStyle:{\"background\":\"#222222\"},attrs:{\"width\":_vm.size * 2,\"height\":_vm.size}},[_vm._l((_vm.sections),function(section,index){return _c('circle',{key:index + 'mdsCourse' + section.length,attrs:{\"cx\":_vm.size / 2 + (_vm.size / 2) * section.colorRadius * Math.cos(section.colorAngle * 2 * Math.PI),\"cy\":_vm.size / 2 + (_vm.size / 2) * section.colorRadius * Math.sin(section.colorAngle * 2 * Math.PI),\"r\":\"4\",\"fill\":_vm.sectionColor(section)}})}),_vm._l((_vm.sections),function(section,index){return _c('circle',{key:index + 'mdsCourseLin' + section.length,attrs:{\"cx\":_vm.size + _vm.size / 2 + (_vm.size / 2) * section.mdsFeature,\"cy\":_vm.size / 2,\"r\":\"4\",\"fill\":_vm.sectionColor(section)}})})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <svg class=\"mdsSVG\" :width=\"size * 2\" :height=\"size\" style=\"background: #222222\">\n        <circle\n            v-for=\"(section, index) in sections\"\n            :key=\"index + 'mdsCourse' + section.length\"\n            :cx=\"size / 2 + (size / 2) * section.colorRadius * Math.cos(section.colorAngle * 2 * Math.PI)\"\n            :cy=\"size / 2 + (size / 2) * section.colorRadius * Math.sin(section.colorAngle * 2 * Math.PI)\"\n            r=\"4\"\n            :fill=\"sectionColor(section)\"\n        ></circle>\n        <circle\n            v-for=\"(section, index) in sections\"\n            :key=\"index + 'mdsCourseLin' + section.length\"\n            :cx=\"size + size / 2 + (size / 2) * section.mdsFeature\"\n            :cy=\"size / 2\"\n            r=\"4\"\n            :fill=\"sectionColor(section)\"\n        ></circle>\n    </svg>\n</template>\n\n<script>\nimport * as vis from \"../../app/vis\";\nimport * as log from \"../../dev/log\";\n\nexport default {\n    props: [\"sections\", \"size\"],\n    components: {},\n    data() {\n        return {};\n    },\n    computed: {},\n    watch: {},\n    mounted() {},\n    methods: {\n        sectionColor(section) {\n            return vis.sinebowColorNormalizedRadius(section.colorAngle, section.colorRadius, 1);\n        },\n    },\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MDS.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MDS.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MDS.vue?vue&type=template&id=9217583a&scoped=true&\"\nimport script from \"./MDS.vue?vue&type=script&lang=js&\"\nexport * from \"./MDS.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9217583a\",\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div>\n        <div v-if=\"hasStructure\">\n            <div class=\"structure\" v-for=\"structure in track.structures\" :key=\"structure.name\">\n                <v-row class=\"mb-0 pt-2\">\n                    <v-btn v-if=\"!structure.separateByGroup\" icon small @click=\"clickStructureUnfold(structure)\">\n                        <v-icon>\n                            {{\n                                structure.verticalPosition ? \"mdi-unfold-less-horizontal\" : \"mdi-unfold-more-horizontal\"\n                            }}\n                        </v-icon>\n                    </v-btn>\n                    <v-btn\n                        icon\n                        small\n                        @click=\"clickStructureshowLoudness(structure)\"\n                        :color=\"structure.showLoudness ? 'white' : 'dimgrey'\"\n                    >\n                        <v-icon>mdi-equalizer</v-icon>\n                    </v-btn>\n                    <p>{{ structure.name }}</p>\n                    <v-spacer></v-spacer>\n                    <div style=\"width: 6em\">\n                        <v-btn small icon @click=\"clickStructureChangeVertical(structure)\">\n                            <v-icon dark>mdi-format-line-spacing</v-icon>\n                        </v-btn>\n                        <span style=\"color: grey\">\n                            {{ structure.vertLayout || layouts[0] }}\n                        </span>\n                    </div>\n                    <div style=\"width: 6em\">\n                        <v-btn small icon @click=\"clickStructureChangeColor(structure)\">\n                            <v-icon dark>mdi-palette</v-icon>\n                        </v-btn>\n                        <span style=\"color: grey\">\n                            {{ structure.colorLayout || layouts[0] }}\n                        </span>\n                    </div>\n                    <div style=\"width: 2.5em\"></div>\n                </v-row>\n\n                <Seeker\n                    class=\"seeker\"\n                    :ref=\"'seeker' + structure.name\"\n                    :width=\"width\"\n                    :height=\"heightOfStructure(structure)\"\n                />\n                <svg class=\"structureSVG\" :width=\"width\" :height=\"heightOfStructure(structure)\" @mouseout=\"unhover()\">\n                    <rect\n                        class=\"structureBackground\"\n                        x=\"0\"\n                        y=\"0\"\n                        :width=\"width\"\n                        :height=\"heightOfStructure(structure)\"\n                        @click=\"clickBackground($event, structure)\"\n                        @mouseover=\"unhover()\"\n                        @mouseout=\"unhover()\"\n                        fill=\"#1a1a1a\"\n                    ></rect>\n                    <g v-for=\"(section, index) in structure.data\" :key=\"index\">\n                        <rect\n                            v-if=\"!structure.showLoudness\"\n                            class=\"section\"\n                            stroke=\"none\"\n                            stroke-width=\".5\"\n                            rx=\"5\"\n                            @mouseover=\"hoverSection($event, section, structure)\"\n                            @mouseout=\"unhoverSection(section)\"\n                            @click=\"clickSection($event, section)\"\n                            :x=\"section.start * scale\"\n                            :y=\"sectionVerticalPosition(structure, section)\"\n                            :width=\"(section.end - section.start) * scale\"\n                            :height=\"blockHeight\"\n                            :fill=\"sectionColor(structure, section)\"\n                        ></rect>\n                        <path\n                            v-if=\"structure.showLoudness\"\n                            class=\"shapedSection\"\n                            :d=\"generatePointsForShapedSection(structure, section)\"\n                            @mouseover=\"hoverSection($event, section, structure)\"\n                            @mouseout=\"unhoverSection(section)\"\n                            @click=\"clickSection($event, section)\"\n                            :fill=\"sectionColor(structure, section)\"\n                        ></path>\n                    </g>\n                </svg>\n                <MDS v-if=\"hasStructure\" :size=\"width / 3\" :sections=\"structure.data\"></MDS>\n            </div>\n\n            <v-tooltip id=\"tooltip\" class=\"tooltip\" v-model=\"showTooltip\" bottom\n                ><div v-html=\"toolTipText\"></div\n            ></v-tooltip>\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\nimport MDS from \"./MDS\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n        MDS,\n    },\n    data() {\n        return {\n            titleHeight: 16,\n            blockHeight: 20,\n            showTooltip: false,\n            tooltipTimeout: null,\n            toolTipText: \"\",\n            tooltipTime: 200,\n            verticalPositionScale: 4.5,\n            layouts: [\"circular\", \"linear\", \"cluster\"],\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        zoomed() {\n            return this.$store.getters.isZoomed;\n        },\n        hasStructure() {\n            return this.track && this.track.structures.length > 0;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        averageLoudness() {\n            return this.track && this.track.features.sampled.smoothedAvgLoudness;\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        getAmountOfUniqueLabels(structure) {\n            if (structure.groupAmount) return structure.groupAmount;\n            const groupIDs = [];\n            structure.data.forEach((section, index) => {\n                if (!groupIDs.includes(section.groupID)) {\n                    groupIDs.push(section.groupID);\n                }\n            });\n            structure.groupAmount = groupIDs.length;\n            return structure.groupAmount;\n        },\n        heightOfStructure(structure) {\n            if (structure.verticalPosition && structure.vertLayout === \"cluster\") {\n                return this.getAmountOfUniqueLabels(structure) * this.blockHeight;\n            }\n            return (\n                (structure.verticalPosition\n                    ? this.verticalPositionScale + 1\n                    : structure.separateByGroup\n                    ? this.getAmountOfUniqueLabels(structure)\n                    : 1) * this.blockHeight\n            );\n        },\n        sectionColor(structure, section) {\n            if (\n                section.groupID !== undefined &&\n                section.mdsFeature === undefined &&\n                section.colorRadius === undefined\n            ) {\n                structure.colorLayout = \"cluster\";\n            }\n            switch (structure.colorLayout) {\n                case \"cluster\":\n                    return vis.categoryColorWithOpacity(\n                        section.groupID,\n                        Math.sqrt(section.confidence !== undefined ? section.confidence : 1)\n                    );\n                case \"linear\":\n                    return vis.zeroOneColorWarm(section.mdsFeature);\n                default:\n                case \"circular\":\n                    return vis.sinebowColorNormalizedRadius(section.colorAngle, section.colorRadius, 1);\n            }\n        },\n        sectionVerticalPosition(structure, section) {\n            if (\n                section.groupID !== undefined &&\n                section.mdsFeature === undefined &&\n                section.colorRadius === undefined\n            ) {\n                structure.vertLayout = \"cluster\";\n            }\n            if (structure.verticalPosition) {\n                switch (structure.vertLayout) {\n                    case \"cluster\":\n                        return section.groupID * this.blockHeight;\n                    case \"linear\":\n                        return section.mdsFeature * this.blockHeight * this.verticalPositionScale;\n                    default:\n                    case \"circular\":\n                        return section.colorAngle * this.blockHeight * this.verticalPositionScale;\n                }\n            } else if (structure.separateByGroup) {\n                return section.groupID * this.blockHeight;\n            } else {\n                return 0;\n            }\n        },\n        sectionBorderColor(section) {\n            return vis.categoryColorWithOpacity(\n                section.groupID,\n                Math.max(0, Math.sqrt(section.confidence !== undefined ? section.confidence : 1) - 0.5)\n            );\n        },\n        hoverSection(event, section, structure) {\n            this.tooltipTimeout = setTimeout(() => {\n                this.toolTipText = `\n                Label: ${section.groupID} <br /> \n                Confidence: ${parseFloat(section.confidence).toFixed(2)} <br /> \n                [${parseFloat(section.start).toFixed(2)}, ${parseFloat(section.end).toFixed(2)}] <br /> \n                Duration: ${parseFloat(section.end - section.start).toFixed(2)} <br /> \n                ColorAngle: ${parseFloat(section.colorAngle).toFixed(2)} <br />\n                MDSFeature: ${parseFloat(section.mdsFeature).toFixed(2)} <br />\n                NormScore: ${parseFloat(section.normalizedScore).toFixed(2)} <br /> \n                NormCoverage: ${parseFloat(section.normalizedCoverage).toFixed(2)} <br /> \n                Fitness: ${parseFloat(section.fitness).toFixed(2)}\n                `;\n                setTimeout(() => {\n                    let tooltips = document.getElementsByClassName(\"v-tooltip__content\");\n                    tooltips.forEach((tool) => {\n                        tool.style.left = event.pageX - event.offsetX + section.start * this.scale + \"px\";\n                        tool.style.top =\n                            event.pageY -\n                            event.offsetY +\n                            (structure.separateByGroup ? section.groupID + 1 : 1) * this.blockHeight +\n                            \"px\";\n                    });\n                }, 0);\n                this.showTooltip = true;\n            }, this.tooltipTime);\n        },\n        unhoverSection(section) {\n            this.unhover();\n        },\n        unhover() {\n            this.showTooltip = false;\n            clearTimeout(this.tooltipTimeout);\n        },\n        clickSection(event, section) {\n            if (event.shiftKey) {\n                const startInSamples = section.start / this.track.features.sampleDuration;\n                const endInSamples = section.end / this.track.features.sampleDuration;\n                this.track.updateDTW(startInSamples, endInSamples);\n            } else {\n                player.seekS(section.start);\n            }\n        },\n        clickBackground(event, structure) {\n            this.$refs[\"seeker\" + structure.name][0].clickedSVG(event);\n        },\n        clickStructureUnfold(structure) {\n            if (structure.verticalPosition === undefined) {\n                // To make object reactive\n                Vue.set(structure, \"verticalPosition\", true);\n            } else {\n                structure.verticalPosition = !structure.verticalPosition;\n            }\n        },\n        clickStructureshowLoudness(structure) {\n            if (structure.showLoudness === undefined) {\n                // To make object reactive\n                Vue.set(structure, \"showLoudness\", true);\n            } else {\n                structure.showLoudness = !structure.showLoudness;\n            }\n        },\n        clickStructureChangeColor(structure) {\n            if (structure.colorLayout === undefined) {\n                Vue.set(structure, \"colorLayout\", this.layouts[1]);\n            } else {\n                const currentIndex = this.layouts.indexOf(structure.colorLayout);\n                let nextIndex = (currentIndex + 1) % this.layouts.length;\n                if (\n                    this.layouts[nextIndex] === \"cluster\" &&\n                    this.getAmountOfUniqueLabels(structure) === structure.data.length\n                ) {\n                    nextIndex = (nextIndex + 1) % this.layouts.length;\n                }\n                structure.colorLayout = this.layouts[nextIndex];\n            }\n        },\n        clickStructureChangeVertical(structure) {\n            if (structure.vertLayout === undefined) {\n                Vue.set(structure, \"vertLayout\", this.layouts[1]);\n            } else {\n                const currentIndex = this.layouts.indexOf(structure.vertLayout);\n                let nextIndex = (currentIndex + 1) % this.layouts.length;\n                if (\n                    this.layouts[nextIndex] === \"cluster\" &&\n                    this.getAmountOfUniqueLabels(structure) === structure.data.length\n                ) {\n                    nextIndex = (nextIndex + 1) % this.layouts.length;\n                }\n                structure.vertLayout = this.layouts[nextIndex];\n            }\n        },\n        generatePointsForShapedSection(structure, section) {\n            const x = Math.round(section.start * this.scale);\n            const y = this.sectionVerticalPosition(structure, section);\n            const width = Math.round((section.end - section.start) * this.scale);\n            const halfHeight = this.blockHeight / 2;\n            const yMid = y + halfHeight;\n            const heightFactor = 1 / this.track.features.maxLoudness;\n\n            const startInSamples = Math.floor(section.start / this.track.features.sampleDuration);\n            const endInSamples = Math.floor(section.end / this.track.features.sampleDuration);\n            const durationInSamples = endInSamples - startInSamples;\n\n            const sampleSkip = 3;\n            let rx = 1; // in pixels\n            if (width < rx * 2 + sampleSkip) {\n                rx = Math.max(0, Math.floor((width - sampleSkip) / 2));\n            }\n            const sampleAmount = this.track.features.sampleAmount;\n            const endOffsetInSamples = Math.round((rx / this.width) * sampleAmount); // scale with sampleamount\n            const endOffsetAbsolute = rx;\n\n            const startYHalfNeg = Math.round(\n                yMid - 0.8 * this.averageLoudness[endOffsetInSamples] * halfHeight * heightFactor\n            );\n            const startYPNeg = Math.round(yMid - this.averageLoudness[endOffsetInSamples] * halfHeight * heightFactor);\n            let points = `M ${x} ${Math.round(yMid)} L ${x} ${startYHalfNeg} Q ${x} ${startYPNeg}`;\n\n            for (let i = startInSamples; i < endInSamples; i++) {\n                if (i === startInSamples + endOffsetInSamples) {\n                    const pointX = Math.round(x + ((i - startInSamples) / durationInSamples) * width);\n                    const pointY = Math.round(yMid - this.averageLoudness[i] * halfHeight * heightFactor);\n                    points = points.concat(\", \", pointX, \" \", pointY);\n                } else if (i === endInSamples - 1 - endOffsetInSamples) {\n                    const pointX = Math.round(x + ((i - startInSamples) / durationInSamples) * width);\n                    const pointY = Math.round(yMid - this.averageLoudness[i] * halfHeight * heightFactor);\n                    points = points.concat(\" L \", pointX, \" \", pointY);\n                    points = points.concat(\n                        \" Q \",\n                        Math.round(x + width - 1),\n                        \" \",\n                        pointY,\n                        \",\",\n                        Math.round(x + width - 1),\n                        \" \",\n                        yMid\n                    );\n                } else if (\n                    i > startInSamples + endOffsetInSamples &&\n                    i < endInSamples - 1 - endOffsetInSamples &&\n                    i % sampleSkip === 0\n                ) {\n                    const pointX = Math.round(x + ((i - startInSamples) / durationInSamples) * width);\n                    const pointY = Math.round(yMid - this.averageLoudness[i] * halfHeight * heightFactor);\n                    points = points.concat(\" L \", pointX, \" \", pointY);\n                }\n            }\n            for (let i = endInSamples - 1; i >= startInSamples; i--) {\n                if (i === endInSamples - 1 - endOffsetInSamples) {\n                    const pointX = Math.round(x + ((i - startInSamples) / durationInSamples) * width);\n                    const pointY = Math.round(yMid + this.averageLoudness[i] * halfHeight * heightFactor);\n                    points = points.concat(\" Q \", Math.round(x + width - 1), \" \", pointY, \",\", pointX, \" \", pointY);\n                } else if (i === startInSamples + endOffsetInSamples) {\n                    const pointX = Math.round(x + ((i - startInSamples) / durationInSamples) * width);\n                    const pointY = Math.round(yMid + this.averageLoudness[i] * halfHeight * heightFactor);\n                    points = points.concat(\" L \", pointX, \" \", pointY);\n                } else if (\n                    i > startInSamples + endOffsetInSamples &&\n                    i < endInSamples - 1 - endOffsetInSamples &&\n                    i % sampleSkip === 0\n                ) {\n                    const pointX = Math.round(x + ((i - startInSamples) / durationInSamples) * width);\n                    const pointY = Math.round(yMid + this.averageLoudness[i] * halfHeight * heightFactor);\n                    points = points.concat(\" L \", pointX, \" \", pointY);\n                }\n            }\n\n            const startYHalfPos = Math.round(\n                yMid + 0.8 * this.averageLoudness[endOffsetInSamples] * halfHeight * heightFactor\n            );\n            const startYPos = Math.round(yMid + this.averageLoudness[endOffsetInSamples] * halfHeight * heightFactor);\n            points = points.concat(` Q ${x} ${startYPos}, ${x} ${startYHalfPos} Z`);\n            return points;\n        },\n    },\n};\n</script>\n\n<style scoped>\n.seeker {\n    pointer-events: none;\n}\n.structureSVG {\n    pointer-events: all;\n    transition: height 0.4s;\n}\n.structureBackground {\n    transition: height 0.4s;\n}\n.section {\n    pointer-events: all;\n    transition: fill 0.3s, y 0.4s;\n}\n.shapedSection {\n    pointer-events: all;\n    transition: 0.3s;\n    stroke-linejoin: round;\n}\n.shapedSection:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n.section:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n.tooltip {\n    white-space: pre-line !important;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Structure.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Structure.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Structure.vue?vue&type=template&id=74fb22c3&scoped=true&\"\nimport script from \"./Structure.vue?vue&type=script&lang=js&\"\nexport * from \"./Structure.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Structure.vue?vue&type=style&index=0&id=74fb22c3&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"74fb22c3\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VBtn,VIcon,VRow,VSpacer,VTooltip})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pt-5\"},[_c('v-row',[_c('v-col',[_vm._v(\"Repetition \")]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\",\"color\":_vm.showLoudness ? 'white' : 'dimgrey'},on:{\"click\":function($event){_vm.showLoudness = !_vm.showLoudness}}},[_c('v-icon',[_vm._v(\"mdi-equalizer\")])],1),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\",\"color\":_vm.catColoring ? 'white' : 'dimgrey'},on:{\"click\":function($event){_vm.catColoring = !_vm.catColoring}}},[_c('v-icon',{attrs:{\"dark\":\"\"}},[_vm._v(\"mdi-palette\")])],1),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.showHelp = !_vm.showHelp}}},[_c('v-icon',{attrs:{\"color\":\"#ccc\",\"dark\":\"\"}},[_vm._v(\"mdi-help-box\")])],1),_c('Tooltip',{attrs:{\"show\":_vm.showHelp}},[_vm._v(\" This visualization shows section blocks, where each row/group of blocks represent repeating harmonic sequences. For example, in many songs, a section block will represent a repeated chord progression. The \"),_c('v-icon',{attrs:{\"dark\":\"\",\"small\":\"\",\"color\":\"#ccc\"}},[_vm._v(\"mdi-palette\")]),_vm._v(\" button switches colours to show either the harmonic sequential similarity within a group, or between groups. The \"),_c('v-icon',{attrs:{\"dark\":\"\",\"small\":\"\",\"color\":\"#ccc\"}},[_vm._v(\"mdi-equalizer\")]),_vm._v(\" button toggles the embedding of loudnenss in the visualization. \")],1)],1),(_vm.hasStructure)?_c('Seeker',{ref:'holisticSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"color\":'rgb(255,255,255,0.3)',\"drawMarkers\":false}}):_vm._e(),(_vm.hasStructure)?_c('svg',{staticClass:\"structureSVG\",attrs:{\"width\":_vm.width,\"height\":_vm.height},on:{\"contextmenu\":function($event){$event.preventDefault();return _vm.rightClick($event)}}},[_c('SeparatorBackground',{attrs:{\"width\":_vm.width,\"height\":_vm.height,\"scale\":_vm.scale}}),_c('rect',{staticClass:\"clickRect\",attrs:{\"id\":\"clickRect\",\"width\":_vm.width,\"height\":_vm.height},on:{\"click\":_vm.clicked}}),_c('rect',{staticClass:\"glowRect\"}),_vm._l((_vm.courseStructure),function(section,index){return _c('Section',{key:index + 'course',staticClass:\"structureSection\",attrs:{\"section\":section,\"height\":_vm.sectionHeight,\"scale\":_vm.scale,\"showLoudness\":_vm.showLoudness,\"coloring\":_vm.catColoring ? 'categoricalMDS' : 'circular',\"verticalOffset\":_vm.paddingTop,\"loop\":false}})}),(_vm.showFineStructure)?_c('g',_vm._l((_vm.fineStructure),function(section,index){return _c('Section',{key:index + 'fine',attrs:{\"section\":section,\"height\":_vm.sectionHeight,\"scale\":_vm.scale,\"verticalOffset\":_vm.paddingTop + _vm.spaceBetweenCourseFine + _vm.sectionHeight * _vm.groupAmount(_vm.courseStructure),\"showLoudness\":_vm.showLoudness,\"coloring\":'circular',\"loop\":false}})}),1):_vm._e(),_c('Markers',{ref:'markers',attrs:{\"width\":_vm.width,\"height\":_vm.height,\"opacity\":0.3}})],2):_vm._e(),(!_vm.hasStructure)?_c('v-skeleton-loader',{attrs:{\"width\":_vm.width,\"height\":_vm.sectionHeight * 3,\"type\":\"image\"}}):_vm._e(),(_vm.showMDS && _vm.hasStructure)?_c('MDS',{attrs:{\"size\":_vm.width / 3,\"sections\":_vm.courseStructure}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',[_c('defs',[_c('linearGradient',{attrs:{\"id\":(\"glowRectGradient\" + (_vm.section.start) + (_vm.section.end)),\"x1\":\"0\",\"x2\":\"0\",\"y1\":\"0\",\"y2\":\"1\"}},[_c('stop',{style:((\"stop-color:\" + _vm.color + \";stop-opacity:0\")),attrs:{\"offset\":\"0\"}}),_c('stop',{style:((\"stop-color:\" + _vm.color + \";stop-opacity:\" + _vm.glowOpacity)),attrs:{\"offset\":\"0.5\"}}),_c('stop',{style:((\"stop-color:\" + _vm.color + \";stop-opacity:0\")),attrs:{\"offset\":\"1\"}})],1)],1),_c('rect',{staticClass:\"glowRect\",attrs:{\"fill\":(\"url(#glowRectGradient\" + (_vm.section.start) + (_vm.section.end) + \")\"),\"x\":_vm.x,\"y\":_vm.y + _vm.height / 2 - (_vm.seekerIsInSection ? _vm.glowRectSize() / 2 : 0),\"width\":_vm.width,\"height\":_vm.seekerIsInSection ? _vm.glowRectSize() : 0,\"opacity\":_vm.seekerIsInSection ? '1' : '0'}}),_c('path',{staticClass:\"shapedSection\",attrs:{\"d\":_vm.shapedSectionPath,\"fill\":_vm.color},on:{\"mouseover\":function($event){return _vm.hover($event)},\"mouseout\":function($event){return _vm.unhover()},\"click\":function($event){return _vm.click($event)}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <g>\n        <defs>\n            <linearGradient :id=\"`glowRectGradient${section.start}${section.end}`\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\n                <stop offset=\"0\" :style=\"`stop-color:${color};stop-opacity:0`\" />\n                <stop offset=\"0.5\" :style=\"`stop-color:${color};stop-opacity:${glowOpacity}`\" />\n                <stop offset=\"1\" :style=\"`stop-color:${color};stop-opacity:0`\" />\n            </linearGradient>\n        </defs>\n        <rect\n            class=\"glowRect\"\n            :fill=\"`url(#glowRectGradient${section.start}${section.end})`\"\n            :x=\"x\"\n            :y=\"y + height / 2 - (seekerIsInSection ? glowRectSize() / 2 : 0)\"\n            :width=\"width\"\n            :height=\"seekerIsInSection ? glowRectSize() : 0\"\n            :opacity=\"seekerIsInSection ? '1' : '0'\"\n        >\n        </rect>\n        <path\n            class=\"shapedSection\"\n            :d=\"shapedSectionPath\"\n            :fill=\"color\"\n            @mouseover=\"hover($event)\"\n            @mouseout=\"unhover()\"\n            @click=\"click($event)\"\n        ></path>\n    </g>\n</template>\n\n<script>\nimport * as vis from \"../../app/vis\";\nimport * as log from \"../../dev/log\";\nimport * as player from \"../../app/player\";\nimport { sampleDuration } from \"../../app/Track\";\nimport * as audioUtil from \"../../app/audioUtil\";\nimport * as svgVariableWidthLine from \"svg-variable-width-line\";\nimport * as d3 from \"d3\";\n\nexport default {\n    props: [\n        \"section\",\n        \"height\",\n        \"scale\",\n        \"verticalOffset\",\n        \"containerHeight\",\n        \"showLoudness\",\n        \"coloring\",\n        \"positioning\",\n        \"loop\",\n    ],\n    components: {},\n    data() {\n        return {\n            glowOpacity: 0.4,\n            glowSize: 6,\n            seekerWasInSection: false,\n            noLoudness: 0.8,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n\n        verticalPosition() {\n            switch (this.positioning) {\n                default:\n                case \"cluster\" || \"group\":\n                    return this.section.groupID * this.height + this.verticalOffset;\n                case \"circular\":\n                    return this.section.colorAngle * (this.containerHeight - this.height);\n                case \"linear\":\n                    return this.section.mdsFeature * (this.containerHeight - this.height);\n            }\n        },\n        color() {\n            switch (this.coloring) {\n                default:\n                case \"cluster\" || \"group\":\n                    return vis.goldenRatioCategoricalColor(this.section.groupID, 0, 1);\n                case \"circular\":\n                    return vis.sinebowColorNormalizedRadius(this.section.colorAngle, this.section.colorRadius, 1);\n                case \"categoricalMDS\":\n                    return vis.sinebowColorNormalizedRadius(this.section.catColorAngle, this.section.catColorRadius, 1);\n\n                case \"linear\":\n                    return vis.zeroOneColorWarm(this.section.mdsFeature);\n            }\n        },\n        seekerIsInSection() {\n            const isSeekerInSection =\n                this.$store.getters.seeker / 1000 >= this.section.start &&\n                this.$store.getters.seeker / 1000 < this.section.end;\n            return isSeekerInSection;\n        },\n\n        x() {\n            return this.section.start * this.scale;\n        },\n        y() {\n            return this.verticalOffset + this.verticalPosition;\n        },\n        width() {\n            return Math.max(1, (this.section.end - this.section.start) * this.scale - 2);\n        },\n        directLoudness() {\n            return this.track && this.track.features.directLoudness;\n        },\n        shapedSectionPath() {\n            const halfHeight = this.height / 2;\n            let roundoff = 4;\n            let step = 4 / this.width;\n            step = Math.max(0.001, step);\n\n            const yMid = (time) => {\n                if (this.section.graph === undefined) return this.y + halfHeight;\n                const factorOfWidth = (time - this.section.start) / (this.section.end - this.section.start);\n                const sampleInSection = Math.min(\n                    Math.floor(factorOfWidth * this.section.graph.length),\n                    this.section.graph.length - 1\n                );\n                const mdsValue = this.section.graph[sampleInSection];\n                return mdsValue * (this.containerHeight - this.height) + halfHeight;\n            };\n\n            const tooSmall = this.width <= roundoff * 2;\n            if (tooSmall) {\n                roundoff = this.width / 2;\n            }\n\n            const firstSample = Math.round((this.x + roundoff) / this.scale / this.track.features.sampleDuration);\n            const firstLoudness = this.showLoudness ? this.dynamics(firstSample) : this.noLoudness;\n            const firstYMid = yMid(this.section.start);\n\n            let lastSample = Math.floor(\n                (this.x + this.width - roundoff) / this.scale / this.track.features.sampleDuration\n            );\n\n            const lastLoudness = this.showLoudness ? this.dynamics(lastSample) : this.noLoudness;\n            const lastYMid = yMid(this.section.end);\n\n            let path = `M ${this.x} ${Math.round(firstYMid)} L ${this.x} ${firstYMid -\n                Math.max(0, halfHeight * firstLoudness - roundoff)} Q ${this.x} ${firstYMid -\n                halfHeight * firstLoudness}, ${this.x + roundoff} ${firstYMid - halfHeight * firstLoudness}`;\n\n            const startFraction = roundoff / this.width;\n            const endFraction = 1 - roundoff / this.width;\n\n            // Top\n            const pointXSet = [];\n            for (let i = startFraction + step; i < endFraction - step; i += step) {\n                const pointX = this.x + i * this.width;\n                pointXSet.push(pointX);\n                const sample = Math.round(pointX / this.scale / this.track.features.sampleDuration);\n                const loudness = this.showLoudness ? this.dynamics(sample) : this.noLoudness;\n                const pointY = yMid(pointX / this.scale) - halfHeight * loudness;\n                path = path.concat(\" L \", pointX, \" \", pointY);\n            }\n\n            // Turnaround on the right\n            path = path.concat(\" L \", this.x + this.width - roundoff, \" \", lastYMid - halfHeight * lastLoudness);\n            path = path.concat(\n                ` Q ${this.x + this.width} ${lastYMid - halfHeight * lastLoudness}, ${this.x + this.width} ${lastYMid -\n                    Math.max(0, halfHeight * lastLoudness - roundoff)} L ${this.x + this.width} ${lastYMid +\n                    Math.max(0, halfHeight * lastLoudness - roundoff)} Q ${this.x + this.width} ${lastYMid +\n                    halfHeight * lastLoudness}, ${this.x + this.width - roundoff} ${lastYMid +\n                    halfHeight * lastLoudness}`\n            );\n\n            // Bottom\n            pointXSet.reverse();\n            for (const pointX of pointXSet) {\n                const sample = Math.round(pointX / this.scale / this.track.features.sampleDuration);\n                const loudness = this.showLoudness ? this.dynamics(sample) : this.noLoudness;\n                const pointY = yMid(pointX / this.scale) + halfHeight * loudness;\n                path = path.concat(\" L \", pointX, \" \", pointY);\n            }\n\n            // close of path with last sample\n            path = path.concat(\n                ` L ${this.x + roundoff} ${firstYMid + halfHeight * firstLoudness} Q ${this.x} ${firstYMid +\n                    halfHeight * firstLoudness}, ${this.x} ${firstYMid +\n                    Math.max(0, halfHeight * firstLoudness - roundoff)} Z `\n            );\n\n            return path;\n        },\n    },\n    watch: {\n        seekerIsInSection() {\n            if (\n                this.loop &&\n                !this.seekerIsInSection &&\n                this.$store.getters.seeker / 1000 >= this.section.end &&\n                this.$store.getters.seeker / 1000 < this.section.end + 0.1\n            ) {\n                const offset = 0;\n                const timeExtra = this.$store.getters.seeker / 1000 - this.section.end;\n                setTimeout(() => {\n                    player.seekS(this.section.start + timeExtra);\n                }, offset * 1000);\n            }\n        },\n    },\n    mounted() {},\n    methods: {\n        dynamics(sample) {\n            return this.track.features.sampled.dynamics[sample];\n        },\n        loudnessTime(time) {\n            const sample = Math.floor(time / this.track.features.sampleDuration);\n            return this.dynamics(sample);\n        },\n        directLoudnessTime(time) {\n            const sample = Math.floor(time / this.track.features.directLoudnessSampleDuration);\n            return this.directLoudness[sample] / this.track.features.maxLoudness || 0;\n        },\n        hover(event) {},\n        unhover() {},\n        click(event) {\n            this.$store.commit(\"setInputFocus\", false);\n\n            log.debug(\"clicked\", audioUtil.keyNames[this.section.key]);\n            if (event.shiftKey) {\n                const startInSamples = this.section.start / this.track.features.sampleDuration;\n                const endInSamples = this.section.end / this.track.features.sampleDuration;\n                this.track.updateDTW(startInSamples, endInSamples);\n            } else {\n                player.seekS(this.section.start);\n            }\n        },\n        glowRectSize() {\n            return (\n                this.glowSize *\n                this.height *\n                (0.15 +\n                    this.directLoudnessTime(this.$store.getters.seeker / 1000) / 4 +\n                    Math.pow(this.loudnessTime(this.$store.getters.seeker / 1000), 1.5))\n            );\n        },\n    },\n};\n</script>\n\n<style scoped>\n.shapedSection {\n    z-index: 10;\n    pointer-events: all;\n    transition: 0.25s;\n    stroke-linejoin: round;\n}\n.glowRect {\n    z-index: -1;\n    pointer-events: none;\n    transition-timing-function: linear;\n    transition: 0.5s;\n}\n.shapedSection:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Section.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Section.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Section.vue?vue&type=template&id=6ffe24a8&scoped=true&\"\nimport script from \"./Section.vue?vue&type=script&lang=js&\"\nexport * from \"./Section.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Section.vue?vue&type=style&index=0&id=6ffe24a8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6ffe24a8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',_vm._l((_vm.separators),function(separator,index){return _c('g',{key:separator.start},[_c('defs',[_c('linearGradient',{attrs:{\"id\":(\"backgroundGradient\" + index),\"x1\":\"0\",\"x2\":\"0\",\"y1\":\"0\",\"y2\":\"1\"}},[_c('stop',{style:((\"stop-color:\" + (_vm.backgroundColor(separator)) + \";stop-opacity:1\")),attrs:{\"offset\":\"0%\"}}),_c('stop',{style:((\"stop-color:\" + (_vm.backgroundColor(separator)) + \";stop-opacity:1\")),attrs:{\"offset\":\"100%\"}})],1)],1),(_vm.showBackground)?_c('rect',{key:separator.start + 'bg',staticClass:\"background\",attrs:{\"x\":separator.start * _vm.scale - 1,\"y\":0,\"width\":(separator.end - separator.start) * _vm.scale,\"height\":_vm.height,\"fill\":(\"url(#backgroundGradient\" + index + \")\")},on:{\"click\":function($event){return _vm.click($event)}}}):_vm._e(),(_vm.showSeparators)?_c('rect',{staticClass:\"separator\",attrs:{\"x\":separator.start * _vm.scale - 1,\"y\":0,\"width\":3,\"height\":_vm.height,\"fill\":_vm.separatorColor(separator)}}):_vm._e()])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <g>\n        <g v-for=\"(separator, index) in separators\" :key=\"separator.start\">\n            <defs>\n                <linearGradient :id=\"`backgroundGradient${index}`\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\n                    <stop offset=\"0%\" :style=\"`stop-color:${backgroundColor(separator)};stop-opacity:1`\" />\n                    <stop offset=\"100%\" :style=\"`stop-color:${backgroundColor(separator)};stop-opacity:1`\" />\n                </linearGradient>\n            </defs>\n            <rect\n                v-if=\"showBackground\"\n                class=\"background\"\n                :key=\"separator.start + 'bg'\"\n                :x=\"separator.start * scale - 1\"\n                :y=\"0\"\n                :width=\"(separator.end - separator.start) * scale\"\n                :height=\"height\"\n                :fill=\"`url(#backgroundGradient${index})`\"\n                @click=\"click($event)\"\n            >\n            </rect>\n            <rect\n                v-if=\"showSeparators\"\n                class=\"separator\"\n                :x=\"separator.start * scale - 1\"\n                :y=\"0\"\n                :width=\"3\"\n                :height=\"height\"\n                :fill=\"separatorColor(separator)\"\n            ></rect>\n        </g>\n    </g>\n</template>\n\n<script>\nimport * as vis from \"../../app/vis\";\nimport * as player from \"../../app/player\";\n\nexport default {\n    props: [\"width\", \"height\", \"scale\"],\n    components: {},\n    data() {\n        return {\n            showSeparators: false,\n            showBackground: false,\n            backgroundOpacity: 0.2,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        separators() {\n            return this.track.separatorGenerator();\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        backgroundColor(separator) {\n            return vis.goldenRatioCategoricalColor(separator.groupID, 0, 0.2);\n        },\n        separatorColor(separator) {\n            return vis.goldenRatioCategoricalColor(separator.groupID, 0, 0.5);\n        },\n        click(event) {\n            console.log(\"clicked\", event);\n            let xNormalized = 0;\n            let yNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n                yNormalized = event.layerY / this.height;\n            } else {\n                xNormalized = event.offsetX / this.width;\n                yNormalized = event.layerY / this.height;\n            }\n\n            if (this.useZoom && this.isZoomed) {\n                const xFromMiddle = xNormalized * 2 - 1;\n                const seekerPos = Math.min(\n                    1,\n                    Math.max(\n                        0,\n                        this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000) +\n                            xFromMiddle / (2 * this.zoomScale)\n                    )\n                );\n                player.seekS(seekerPos * this.track.getAnalysisDuration());\n            } else {\n                player.seekS(xNormalized * this.track.getAnalysisDuration());\n            }\n            this.$store.commit(\"setInputFocus\", false);\n        },\n    },\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorBackground.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SeparatorBackground.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SeparatorBackground.vue?vue&type=template&id=7a51a490&scoped=true&\"\nimport script from \"./SeparatorBackground.vue?vue&type=script&lang=js&\"\nexport * from \"./SeparatorBackground.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7a51a490\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.show)?_c('div',{staticClass:\"tooltip\"},[_c('span',[_vm._t(\"default\")],2)]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div v-if=\"show\" class=\"tooltip\">\n        <span>\n            <slot></slot>\n        </span>\n    </div>\n</template>\n\n<script>\nexport default {\n    props: [\"show\"],\n    components: {},\n    data() {\n        return {\n            showHelp: false,\n        };\n    },\n    computed: {},\n    watch: {},\n    mounted() {},\n    methods: {},\n};\n</script>\n\n<style scoped>\n.tooltip {\n    color: #ccc;\n    position: relative;\n    transition: 0.5s;\n    margin-left: 10px;\n    margin-right: 10px;\n    margin-bottom: 5px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tooltip.vue?vue&type=template&id=e00e0bc0&scoped=true&\"\nimport script from \"./Tooltip.vue?vue&type=script&lang=js&\"\nexport * from \"./Tooltip.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Tooltip.vue?vue&type=style&index=0&id=e00e0bc0&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e00e0bc0\",\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div class=\"pt-5\">\n        <v-row>\n            <v-col>Repetition </v-col>\n\n            <v-spacer></v-spacer>\n            <v-btn icon small @click=\"showLoudness = !showLoudness\" :color=\"showLoudness ? 'white' : 'dimgrey'\">\n                <v-icon>mdi-equalizer</v-icon>\n            </v-btn>\n            <v-btn icon small @click=\"catColoring = !catColoring\" :color=\"catColoring ? 'white' : 'dimgrey'\">\n                <v-icon dark>mdi-palette</v-icon>\n            </v-btn>\n            <v-btn icon small @click=\"showHelp = !showHelp\"> <v-icon color=\"#ccc\" dark>mdi-help-box</v-icon> </v-btn>\n            <Tooltip :show=\"showHelp\">\n                This visualization shows section blocks, where each row/group of blocks represent repeating harmonic\n                sequences. For example, in many songs, a section block will represent a repeated chord progression. The\n                <v-icon dark small color=\"#ccc\">mdi-palette</v-icon> button switches colours to show either the harmonic\n                sequential similarity within a group, or between groups. The\n                <v-icon dark small color=\"#ccc\">mdi-equalizer</v-icon> button toggles the embedding of loudnenss in the\n                visualization.\n            </Tooltip>\n        </v-row>\n        <Seeker\n            v-if=\"hasStructure\"\n            class=\"seeker\"\n            :ref=\"'holisticSeeker'\"\n            :width=\"width\"\n            :height=\"height\"\n            :color=\"'rgb(255,255,255,0.3)'\"\n            :drawMarkers=\"false\"\n        />\n        <svg v-if=\"hasStructure\" class=\"structureSVG\" :width=\"width\" :height=\"height\" @contextmenu.prevent=\"rightClick\">\n            <SeparatorBackground :width=\"width\" :height=\"height\" :scale=\"scale\" />\n            <rect class=\"clickRect\" id=\"clickRect\" :width=\"width\" :height=\"height\" @click=\"clicked\"></rect>\n\n            <rect class=\"glowRect\"></rect>\n            <Section\n                class=\"structureSection\"\n                v-for=\"(section, index) in courseStructure\"\n                :key=\"index + 'course'\"\n                :section=\"section\"\n                :height=\"sectionHeight\"\n                :scale=\"scale\"\n                :showLoudness=\"showLoudness\"\n                :coloring=\"catColoring ? 'categoricalMDS' : 'circular'\"\n                :verticalOffset=\"paddingTop\"\n                :loop=\"false\"\n            />\n            <g v-if=\"showFineStructure\">\n                <Section\n                    v-for=\"(section, index) in fineStructure\"\n                    :key=\"index + 'fine'\"\n                    :section=\"section\"\n                    :height=\"sectionHeight\"\n                    :scale=\"scale\"\n                    :verticalOffset=\"paddingTop + spaceBetweenCourseFine + sectionHeight * groupAmount(courseStructure)\"\n                    :showLoudness=\"showLoudness\"\n                    :coloring=\"'circular'\"\n                    :loop=\"false\"\n                />\n            </g>\n            <Markers :ref=\"'markers'\" :width=\"width\" :height=\"height\" :opacity=\"0.3\"></Markers>\n        </svg>\n        <v-skeleton-loader\n            v-if=\"!hasStructure\"\n            :width=\"width\"\n            :height=\"sectionHeight * 3\"\n            type=\"image\"\n        ></v-skeleton-loader>\n        <MDS v-if=\"showMDS && hasStructure\" :size=\"width / 3\" :sections=\"courseStructure\"></MDS>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport Section from \"./Section\";\nimport Markers from \"./Markers\";\nimport MDS from \"./MDS\";\n\nimport SeparatorBackground from \"./SeparatorBackground\";\nimport Tooltip from \"./Tooltip.vue\";\n\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n        SeparatorBackground,\n        Section,\n        Markers,\n        MDS,\n        Tooltip,\n    },\n    data() {\n        return {\n            paddingTop: 10,\n            sectionHeight: 25,\n            spaceBetweenCourseFine: 50,\n            showFineStructure: false,\n            showLoudness: true,\n            showMDS: false,\n            catColoring: false,\n            showHelp: false,\n        };\n    },\n    computed: {\n        height() {\n            let height = 0;\n            height += this.paddingTop;\n            height += this.groupAmount(this.courseStructure) * this.sectionHeight;\n            height += this.spaceBetweenCourseFine;\n            if (this.showFineStructure) {\n                height += this.groupAmount(this.fineStructure) * this.sectionHeight;\n            }\n            return height;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        hasStructure() {\n            return this.track && this.track.harmonicStructureCourse && this.track.harmonicStructureCourse.length > 0;\n        },\n        courseStructure() {\n            return this.track.harmonicStructureCourse;\n        },\n        fineStructure() {\n            return this.track.harmonicStructureFine;\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        groupAmount(structure) {\n            let maxGroupID = 0;\n            for (let i = 0; i < structure.length; i++) {\n                if (structure[i].groupID > maxGroupID) {\n                    maxGroupID = structure[i].groupID;\n                }\n            }\n            return maxGroupID + 1;\n        },\n        rightClick(event) {\n            this.$refs[\"holisticSeeker\"].rightClick(event);\n        },\n        clicked(event) {\n            log.debug(\"Clicked\");\n            this.$refs[\"holisticSeeker\"].clicked(event);\n        },\n        clickedHelp(event) {},\n    },\n};\n</script>\n\n<style scoped>\n.structureSVG {\n    z-index: 100;\n}\n.seeker {\n    pointer-events: none;\n}\n.structureSection {\n    z-index: 100;\n}\n.clickRect {\n    opacity: 0;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HolisticStructure.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HolisticStructure.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HolisticStructure.vue?vue&type=template&id=3a5bf7e5&scoped=true&\"\nimport script from \"./HolisticStructure.vue?vue&type=script&lang=js&\"\nexport * from \"./HolisticStructure.vue?vue&type=script&lang=js&\"\nimport style0 from \"./HolisticStructure.vue?vue&type=style&index=0&id=3a5bf7e5&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a5bf7e5\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSkeletonLoader } from 'vuetify/lib/components/VSkeletonLoader';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VIcon,VRow,VSkeletonLoader,VSpacer})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.hasStructure)?_c('div',{staticClass:\"py-1\"},[_c('v-row',[_c('v-col',[_vm._v(\"Timbre Structure\")]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\",\"color\":_vm.showLoudness ? 'white' : 'dimgrey'},on:{\"click\":function($event){_vm.showLoudness = !_vm.showLoudness}}},[_c('v-icon',[_vm._v(\"mdi-equalizer\")])],1)],1),_c('Seeker',{ref:'timbreStructureSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"color\":'rgb(255,255,255,0.3)'}}),_c('svg',{staticClass:\"timbreStructureSVG\",attrs:{\"width\":_vm.width,\"height\":_vm.height}},[_c('StructureBackground',{attrs:{\"width\":_vm.width,\"height\":_vm.height,\"scale\":_vm.scale,\"structure\":_vm.timbreStructure}}),_vm._l((_vm.timbreStructure),function(section,index){return _c('Section',{key:index + 'course',attrs:{\"section\":section,\"height\":_vm.sectionHeight,\"scale\":_vm.scale,\"showLoudness\":_vm.showLoudness,\"coloring\":'circular',\"positioning\":'linear',\"verticalOffset\":_vm.paddingTop,\"containerHeight\":_vm.height - _vm.sectionHeight / 2,\"loop\":false}})})],2),_c('svg',{class:\"eventSVG\",style:((\"margin-left: -\" + _vm.eventSize)),attrs:{\"width\":_vm.width + _vm.eventSize * 2,\"height\":_vm.eventHeight}},_vm._l((_vm.events),function(event){return _c('circle',{key:event.time,staticClass:\"event\",attrs:{\"cx\":_vm.eventSize + event.time * _vm.scale,\"cy\":_vm.eventSize + event.mdsFeature * (_vm.eventHeight - _vm.eventSize * 2),\"r\":_vm.eventSize,\"fill\":_vm.color(event, event.confidence + 0.5)},on:{\"click\":function($event){return _vm.clickEvent(event)}}})}),0)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',_vm._l((_vm.structure),function(section,index){return _c('g',{key:section.start},[_c('defs',[_c('linearGradient',{attrs:{\"id\":(\"timbreBackgroundGradient\" + index),\"x1\":\"0\",\"x2\":\"0\",\"y1\":\"0\",\"y2\":\"1\"}},[_c('stop',{style:((\"stop-color:\" + (_vm.backgroundColor(section)) + \";stop-opacity:0\")),attrs:{\"offset\":(\"\" + (0))}}),_c('stop',{style:((\"stop-color:\" + (_vm.backgroundColor(section)) + \";stop-opacity:1\")),attrs:{\"offset\":(\"\" + (section.colorAngle))}}),_c('stop',{style:((\"stop-color:\" + (_vm.backgroundColor(section)) + \";stop-opacity:0\")),attrs:{\"offset\":(\"\" + (1))}})],1)],1),_c('rect',{key:section.start + 'bg',staticClass:\"background\",attrs:{\"x\":section.start * _vm.scale,\"y\":0,\"width\":(section.end - section.start) * _vm.scale,\"height\":_vm.height,\"fill\":(\"url(#timbreBackgroundGradient\" + index + \")\")},on:{\"click\":function($event){return _vm.click($event)}}}),_c('rect',{staticClass:\"separator\",attrs:{\"x\":section.start * _vm.scale - 1.5,\"y\":0,\"width\":3,\"height\":_vm.height,\"fill\":_vm.separatorColor(section)}})])}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <g>\n        <g v-for=\"(section, index) in structure\" :key=\"section.start\">\n            <defs>\n                <linearGradient :id=\"`timbreBackgroundGradient${index}`\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\n                    <stop :offset=\"`${0}`\" :style=\"`stop-color:${backgroundColor(section)};stop-opacity:0`\" />\n                    <stop\n                        :offset=\"`${section.colorAngle}`\"\n                        :style=\"`stop-color:${backgroundColor(section)};stop-opacity:1`\"\n                    />\n                    <stop :offset=\"`${1}`\" :style=\"`stop-color:${backgroundColor(section)};stop-opacity:0`\" />\n                </linearGradient>\n            </defs>\n            <rect\n                class=\"background\"\n                :key=\"section.start + 'bg'\"\n                :x=\"section.start * scale\"\n                :y=\"0\"\n                :width=\"(section.end - section.start) * scale\"\n                :height=\"height\"\n                :fill=\"`url(#timbreBackgroundGradient${index})`\"\n                @click=\"click($event)\"\n            >\n            </rect>\n            <rect\n                class=\"separator\"\n                :x=\"section.start * scale - 1.5\"\n                :y=\"0\"\n                :width=\"3\"\n                :height=\"height\"\n                :fill=\"separatorColor(section)\"\n            ></rect>\n        </g>\n    </g>\n</template>\n\n<script>\nimport * as vis from \"../../app/vis\";\nimport * as player from \"../../app/player\";\n\nexport default {\n    props: [\"width\", \"height\", \"scale\", \"structure\"],\n    components: {},\n    data() {\n        return {\n            showSeparators: true,\n            showBackground: true,\n            backgroundOpacity: 0.07,\n            separtorOpacity: 0.15,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        backgroundColor(section) {\n            return vis.sinebowColorNormalizedRadius(\n                section.colorAngle,\n                1,\n                this.backgroundOpacity * this.showBackground\n            );\n        },\n        separatorColor(section) {\n            return vis.sinebowColorNormalizedRadius(section.colorAngle, 1, this.separtorOpacity * this.showSeparators);\n        },\n        click(event) {\n            let xNormalized = 0;\n            let yNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n                yNormalized = event.layerY / this.height;\n            } else {\n                xNormalized = event.offsetX / this.width;\n                yNormalized = event.layerY / this.height;\n            }\n\n            if (this.useZoom && this.isZoomed) {\n                const xFromMiddle = xNormalized * 2 - 1;\n                const seekerPos = Math.min(\n                    1,\n                    Math.max(\n                        0,\n                        this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000) +\n                            xFromMiddle / (2 * this.zoomScale)\n                    )\n                );\n                player.seekS(seekerPos * this.track.getAnalysisDuration());\n            } else {\n                player.seekS(xNormalized * this.track.getAnalysisDuration());\n            }\n        },\n    },\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StructureBackground.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StructureBackground.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StructureBackground.vue?vue&type=template&id=c21f7d58&scoped=true&\"\nimport script from \"./StructureBackground.vue?vue&type=script&lang=js&\"\nexport * from \"./StructureBackground.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c21f7d58\",\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div class=\"py-1\" v-if=\"hasStructure\">\n        <v-row>\n            <v-col>Timbre Structure</v-col>\n            <v-spacer></v-spacer>\n            <v-btn icon small @click=\"showLoudness = !showLoudness\" :color=\"showLoudness ? 'white' : 'dimgrey'\">\n                <v-icon>mdi-equalizer</v-icon>\n            </v-btn>\n        </v-row>\n        <Seeker\n            class=\"seeker\"\n            :ref=\"'timbreStructureSeeker'\"\n            :width=\"width\"\n            :height=\"height\"\n            :color=\"'rgb(255,255,255,0.3)'\"\n        />\n        <svg class=\"timbreStructureSVG\" :width=\"width\" :height=\"height\">\n            <StructureBackground :width=\"width\" :height=\"height\" :scale=\"scale\" :structure=\"timbreStructure\" />\n            <Section\n                v-for=\"(section, index) in timbreStructure\"\n                :key=\"index + 'course'\"\n                :section=\"section\"\n                :height=\"sectionHeight\"\n                :scale=\"scale\"\n                :showLoudness=\"showLoudness\"\n                :coloring=\"'circular'\"\n                :positioning=\"'linear'\"\n                :verticalOffset=\"paddingTop\"\n                :containerHeight=\"height - sectionHeight / 2\"\n                :loop=\"false\"\n            />\n        </svg>\n        <svg\n            :class=\"`eventSVG`\"\n            :style=\"`margin-left: -${eventSize}`\"\n            :width=\"width + eventSize * 2\"\n            :height=\"eventHeight\"\n        >\n            <circle\n                v-for=\"event in events\"\n                :key=\"event.time\"\n                class=\"event\"\n                :cx=\"eventSize + event.time * scale\"\n                :cy=\"eventSize + event.mdsFeature * (eventHeight - eventSize * 2)\"\n                :r=\"eventSize\"\n                :fill=\"color(event, event.confidence + 0.5)\"\n                @click=\"clickEvent(event)\"\n            ></circle>\n        </svg>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport Section from \"./Section\";\n\nimport StructureBackground from \"./StructureBackground\";\n\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n        StructureBackground,\n        Section,\n    },\n    data() {\n        return {\n            paddingTop: 10,\n            sectionHeight: 25,\n            eventSize: 7,\n            eventHeight: 30,\n            showLoudness: true,\n        };\n    },\n    computed: {\n        height() {\n            return 150;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        hasStructure() {\n            return this.track && this.track.timbreStructure && this.track.timbreStructure.length > 0;\n        },\n        timbreStructure() {\n            return this.track.timbreStructure;\n        },\n        events() {\n            return this.track.events;\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        color(element, confidence = 1) {\n            return vis.sinebowColorNormalizedRadius(element.colorAngle, 1, confidence);\n        },\n        clickEvent(event) {\n            player.seekS(event.time);\n        },\n    },\n};\n</script>\n\n<style scoped>\n.seeker {\n    pointer-events: none;\n}\n.event {\n    transition: 0.3s;\n}\n.event:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreStructure.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreStructure.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TimbreStructure.vue?vue&type=template&id=0141a4f1&scoped=true&\"\nimport script from \"./TimbreStructure.vue?vue&type=script&lang=js&\"\nexport * from \"./TimbreStructure.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TimbreStructure.vue?vue&type=style&index=0&id=0141a4f1&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0141a4f1\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VIcon,VRow,VSpacer})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.hasStructure)?_c('div',{staticClass:\"py-1\"},[_c('v-row',[_c('v-col',[_vm._v(\"Timbre\")]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\",\"color\":_vm.showLoudness ? 'white' : 'dimgrey'},on:{\"click\":function($event){_vm.showLoudness = !_vm.showLoudness}}},[_c('v-icon',[_vm._v(\"mdi-equalizer\")])],1),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.showHelp = !_vm.showHelp}}},[_c('v-icon',{attrs:{\"color\":\"#ccc\",\"dark\":\"\"}},[_vm._v(\"mdi-help-box\")])],1),_c('Tooltip',{attrs:{\"show\":_vm.showHelp}},[_vm._v(\" This visualization shows timbre in the form of a segmented graph. The vertical axis, together with colour, denote similarity. Height in the graph will mostly correspond to energy and brightness. A sudden change in timbre will show up as a break in the graph. The \"),_c('v-icon',{attrs:{\"dark\":\"\",\"small\":\"\",\"color\":\"#ccc\"}},[_vm._v(\"mdi-equalizer\")]),_vm._v(\" button toggles the embedding of loudnenss in the visualization. \"),_c('br'),_vm._v(\" The dots shown below the graph are moments of timbral anomaly, points in the music where the timbre is unique and locally distinct. \")],1)],1),_c('Seeker',{ref:'timbreSegmentedGraphSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"color\":'rgb(255,255,255,0.3)'}}),_c('svg',{staticClass:\"timbreStructureSVG\",attrs:{\"width\":_vm.width,\"height\":_vm.height}},[_c('defs',[_c('linearGradient',{attrs:{\"id\":\"pathGradient\",\"x1\":\"0\",\"x2\":\"0\",\"y1\":\"0\",\"y2\":\"1\"}},_vm._l((_vm.gradientSteps),function(gradientStep){return _c('stop',{key:gradientStep,style:((\"stop-color:\" + (_vm.color(1 - gradientStep)) + \";stop-opacity:1\")),attrs:{\"offset\":(\"\" + gradientStep)}})}),1)],1),_c('ClickableBackground',{attrs:{\"width\":_vm.width,\"height\":_vm.height}}),_vm._l((_vm.segmentedTimbreGraph),function(section,index){return _c('GraphSection',{key:index + 'segmented',attrs:{\"section\":section,\"height\":_vm.sectionHeight,\"scale\":_vm.scale,\"showLoudness\":_vm.showLoudness,\"coloring\":'linear',\"positioning\":'linear',\"verticalOffset\":_vm.paddingTop,\"containerHeight\":_vm.height}})})],2),_c('hr',{staticClass:\"divider\"}),_c('Events',{attrs:{\"width\":_vm.width}})],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('g',[_c('defs',[_c('linearGradient',{attrs:{\"id\":(\"glowRectGradient\" + (_vm.section.start) + (_vm.section.end)),\"x1\":\"0\",\"x2\":\"0\",\"y1\":0,\"y2\":1}},[_c('stop',{style:((\"stop-color:\" + _vm.currentColor + \";stop-opacity:0\")),attrs:{\"offset\":\"0\"}}),_c('stop',{style:((\"stop-color:\" + _vm.currentColor + \";stop-opacity:\" + _vm.glowOpacity)),attrs:{\"offset\":\"0.5\"}}),_c('stop',{style:((\"stop-color:\" + _vm.currentColor + \";stop-opacity:0\")),attrs:{\"offset\":\"1\"}})],1),_c('linearGradient',{attrs:{\"id\":(\"sectionGradient\" + (_vm.section.start)),\"x1\":\"0\",\"x2\":\"0\",\"y1\":_vm.max / (_vm.max - _vm.min + 0.01),\"y2\":-(1 - _vm.max) / (_vm.max - _vm.min + 0.01)}},_vm._l((_vm.gradientSteps),function(gradientStep){return _c('stop',{key:gradientStep,style:((\"stop-color:\" + (_vm.colorGradient(gradientStep)) + \";stop-opacity:1\")),attrs:{\"offset\":(\"\" + gradientStep)}})}),1)],1),_c('rect',{staticClass:\"glowRect\",attrs:{\"fill\":(\"url(#glowRectGradient\" + (_vm.section.start) + (_vm.section.end) + \")\"),\"x\":_vm.x,\"y\":_vm.currentY - (_vm.seekerIsInSection ? _vm.glowRectSize() / 2 : 0),\"width\":_vm.width,\"height\":_vm.seekerIsInSection ? _vm.glowRectSize() : 0,\"opacity\":_vm.seekerIsInSection ? '1' : '0'}}),_c('path',{staticClass:\"shapedSection\",attrs:{\"d\":_vm.shapedSectionPath,\"shape-rendering\":\"geometricPrecision\",\"fill\":_vm.gradientColoring ? (\"url(#sectionGradient\" + (_vm.section.start) + \")\") : _vm.color},on:{\"mouseover\":function($event){return _vm.hover($event)},\"mouseout\":function($event){return _vm.unhover()},\"click\":function($event){return _vm.click($event)}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <g>\n        <defs>\n            <linearGradient :id=\"`glowRectGradient${section.start}${section.end}`\" x1=\"0\" x2=\"0\" :y1=\"0\" :y2=\"1\">\n                <stop offset=\"0\" :style=\"`stop-color:${currentColor};stop-opacity:0`\" />\n                <stop offset=\"0.5\" :style=\"`stop-color:${currentColor};stop-opacity:${glowOpacity}`\" />\n                <stop offset=\"1\" :style=\"`stop-color:${currentColor};stop-opacity:0`\" />\n            </linearGradient>\n            <linearGradient\n                :id=\"`sectionGradient${section.start}`\"\n                x1=\"0\"\n                x2=\"0\"\n                :y1=\"max / (max - min + 0.01)\"\n                :y2=\"-(1 - max) / (max - min + 0.01)\"\n            >\n                <stop\n                    v-for=\"gradientStep in gradientSteps\"\n                    :key=\"gradientStep\"\n                    :offset=\"`${gradientStep}`\"\n                    :style=\"`stop-color:${colorGradient(gradientStep)};stop-opacity:1`\"\n                />\n            </linearGradient>\n        </defs>\n        <rect\n            class=\"glowRect\"\n            :fill=\"`url(#glowRectGradient${section.start}${section.end})`\"\n            :x=\"x\"\n            :y=\"currentY - (seekerIsInSection ? glowRectSize() / 2 : 0)\"\n            :width=\"width\"\n            :height=\"seekerIsInSection ? glowRectSize() : 0\"\n            :opacity=\"seekerIsInSection ? '1' : '0'\"\n        >\n        </rect>\n        <path\n            class=\"shapedSection\"\n            :d=\"shapedSectionPath\"\n            shape-rendering=\"geometricPrecision\"\n            :fill=\"gradientColoring ? `url(#sectionGradient${section.start})` : color\"\n            @mouseover=\"hover($event)\"\n            @mouseout=\"unhover()\"\n            @click=\"click($event)\"\n        ></path>\n    </g>\n</template>\n\n<script>\nimport * as vis from \"../../app/vis\";\nimport * as log from \"../../dev/log\";\nimport * as player from \"../../app/player\";\nimport { sampleDuration } from \"../../app/Track\";\nimport * as audioUtil from \"../../app/audioUtil\";\nimport * as svgVariableWidthLine from \"svg-variable-width-line\";\nimport * as d3 from \"d3\";\n\nexport default {\n    props: [\n        \"section\",\n        \"height\",\n        \"scale\",\n        \"verticalOffset\",\n        \"containerHeight\",\n        \"showLoudness\",\n        \"coloring\",\n        \"positioning\",\n    ],\n    components: {},\n    data() {\n        return {\n            glowOpacity: 0.3,\n            glowSize: 6,\n            gradientColoring: true,\n            gradientStepAmount: 16,\n            strokeWidth: 0.5,\n            defaultLoudness: 0.7,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n\n        verticalPosition() {\n            switch (this.positioning) {\n                default:\n                case \"cluster\" || \"group\":\n                    return this.section.groupID * this.height + this.verticalOffset;\n                case \"circular\":\n                    return this.section.colorAngle * (this.containerHeight - this.height);\n                case \"linear\":\n                    return this.section.mdsFeature * (this.containerHeight - this.height);\n            }\n        },\n        color() {\n            switch (this.coloring) {\n                default:\n                case \"cluster\" || \"group\":\n                    return vis.goldenRatioCategoricalColor(this.section.groupID, 1);\n                case \"circular\":\n                    return vis.sinebowColorNormalizedRadius(this.section.colorAngle, this.section.colorRadius, 1);\n                case \"linear\":\n                    return vis.zeroOneColorWarm(this.section.mdsFeature);\n            }\n        },\n        seekerIsInSection() {\n            return (\n                this.$store.getters.seeker / 1000 >= this.section.start &&\n                this.$store.getters.seeker / 1000 < this.section.end\n            );\n        },\n        min() {\n            return Math.min(...this.section.graph);\n        },\n        max() {\n            return Math.max(...this.section.graph);\n        },\n        x() {\n            return this.section.start * this.scale;\n        },\n        y() {\n            return this.verticalOffset;\n        },\n        currentY() {\n            return (1 - this.currentSample) * (this.containerHeight - this.height) + this.height / 2;\n        },\n        currentColor() {\n            return this.colorGradient(this.currentSample);\n        },\n        sectionDuration() {\n            return this.section.end - this.section.start;\n        },\n        currentSample() {\n            if (!this.seekerIsInSection) return this.section.mdsFeature;\n            const timeFactor = (this.$store.getters.seeker / 1000 - this.section.start) / this.sectionDuration;\n            const sampleIndex = Math.floor(timeFactor * this.section.graph.length);\n            return this.section.graph[sampleIndex];\n        },\n        width() {\n            return Math.max(1, (this.section.end - this.section.start) * this.scale - 2);\n        },\n        dynamicsArray() {\n            return this.track && this.track.features.sampled.dynamics;\n        },\n        directLoudness() {\n            return this.track && this.track.features.directLoudness;\n        },\n        shapedSectionPath() {\n            const halfHeight = this.height / 2;\n\n            const points = [];\n\n            points.push({\n                x: this.section.start * this.scale,\n                y: (1 - this.section.graph[1]) * (this.containerHeight - this.height) + halfHeight,\n                w: 0,\n            });\n            this.section.graph.forEach((point, index) => {\n                if (\n                    (index > 0 && index < this.section.graph.length - 1 && (index + 1) % 3 !== 0) ||\n                    (index > 0 && this.section.graph.length < 3)\n                ) {\n                    const factorOfWidth = index / this.section.graph.length;\n                    const xTime = this.section.start + (this.section.end - this.section.start) * factorOfWidth;\n                    const xPos = xTime * this.scale;\n\n                    const y = (1 - point) * (this.containerHeight - this.height) + halfHeight;\n                    const w =\n                        (this.showLoudness\n                            ? this.dynamics(Math.round(xTime / this.track.features.sampleDuration))\n                            : this.defaultLoudness) *\n                        this.height *\n                        this.strokeWidth;\n                    points.push({ x: xPos, y, w });\n                }\n            });\n\n            points.push({\n                x: this.section.end * this.scale,\n                y:\n                    (1 - this.section.graph[this.section.graph.length - 2]) * (this.containerHeight - this.height) +\n                    halfHeight,\n                w: 0,\n            });\n\n            const { d } = svgVariableWidthLine.compute(...svgVariableWidthLine.smooth(points, 2));\n\n            return d;\n        },\n        gradientSteps() {\n            let steps = [];\n            for (let i = 0; i < this.gradientStepAmount; i++) {\n                steps.push(i / this.gradientStepAmount);\n            }\n            return steps;\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        dynamics(sample) {\n            return (this.dynamicsArray && this.dynamicsArray[sample]) || 0;\n        },\n        loudnessTime(time) {\n            const sample = Math.floor(time / this.track.features.sampleDuration);\n            return this.dynamicsArray[sample] / this.track.features.maxLoudness || 0;\n        },\n        directLoudnessTime(time) {\n            const sample = Math.floor(time / this.track.features.directLoudnessSampleDuration);\n            return this.directLoudness[sample] / this.track.features.maxLoudness || 0;\n        },\n        hover(event) {},\n        unhover() {},\n        click(event) {\n            this.$store.commit(\"setInputFocus\", false);\n\n            log.debug(\"clicked\", this.section.mdsFeature);\n            if (event.shiftKey) {\n                const startInSamples = this.section.start / this.track.features.sampleDuration;\n                const endInSamples = this.section.end / this.track.features.sampleDuration;\n                this.track.updateDTW(startInSamples, endInSamples);\n            } else {\n                player.seekS(this.section.start);\n            }\n        },\n        glowRectSize() {\n            return (\n                this.glowSize *\n                this.height *\n                (0.15 +\n                    this.directLoudnessTime(this.$store.getters.seeker / 1000) / 4 +\n                    Math.pow(this.loudnessTime(this.$store.getters.seeker / 1000), 1.5))\n            );\n        },\n        colorGradient(mdsFeature) {\n            return vis.sinebowColorNormalizedRadius((0.8 - mdsFeature * 0.9) % 1, 0.85, 0.95);\n        },\n    },\n};\n</script>\n\n<style scoped>\n.shapedSection {\n    z-index: 10;\n    pointer-events: all;\n    transition: 0.45s;\n    stroke-linejoin: round;\n}\n.glowRect {\n    z-index: -1;\n    pointer-events: none;\n    transition-timing-function: linear;\n    transition: 0.5s;\n}\n.shapedSection:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GraphSection.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GraphSection.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GraphSection.vue?vue&type=template&id=02a35072&scoped=true&\"\nimport script from \"./GraphSection.vue?vue&type=script&lang=js&\"\nexport * from \"./GraphSection.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GraphSection.vue?vue&type=style&index=0&id=02a35072&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"02a35072\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.hasStructure)?_c('div',[_c('div',{staticClass:\"events\"},[_c('Seeker',{ref:'eventseeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.eventHeight,\"color\":'rgb(255,255,255,0.3)'}}),_c('svg',{class:\"eventSVG\",style:((\"margin-left: -\" + _vm.eventSize)),attrs:{\"width\":_vm.width,\"height\":_vm.eventHeight * 2}},[_c('rect',{staticClass:\"timbreGraphBackground\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"opacity\":\"0\"},on:{\"click\":function($event){return _vm.clickBackground($event)}}}),_vm._l((_vm.events),function(event){return _c('circle',{key:event.time + 'eventcircle',ref:(\"event\" + (event.time)),refInFor:true,staticClass:\"event\",attrs:{\"cx\":_vm.eventSize + event.time * _vm.scale + _vm.eventSize / 2,\"cy\":_vm.eventSize + event.mdsFeature * (_vm.eventHeight - _vm.eventSize * 2),\"r\":_vm.seekerInEvent(event) ? _vm.eventSize * 1.3 : _vm.eventSize,\"fill\":_vm.seekerInEvent(event) ? 'white' : _vm.color(event, event.confidence + 0.5)},on:{\"click\":function($event){return _vm.clickEvent(event)}}})})],2)],1)]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div v-if=\"hasStructure\">\n        <div class=\"events\">\n            <Seeker\n                class=\"seeker\"\n                :ref=\"'eventseeker'\"\n                :width=\"width\"\n                :height=\"eventHeight\"\n                :color=\"'rgb(255,255,255,0.3)'\"\n            />\n\n            <svg :class=\"`eventSVG`\" :style=\"`margin-left: -${eventSize}`\" :width=\"width\" :height=\"eventHeight * 2\">\n                <rect\n                    class=\"timbreGraphBackground\"\n                    :width=\"width\"\n                    :height=\"height\"\n                    opacity=\"0\"\n                    @click=\"clickBackground($event)\"\n                ></rect>\n                <circle\n                    v-for=\"event in events\"\n                    :key=\"event.time + 'eventcircle'\"\n                    class=\"event\"\n                    :ref=\"`event${event.time}`\"\n                    :cx=\"eventSize + event.time * scale + eventSize / 2\"\n                    :cy=\"eventSize + event.mdsFeature * (eventHeight - eventSize * 2)\"\n                    :r=\"seekerInEvent(event) ? eventSize * 1.3 : eventSize\"\n                    :fill=\"seekerInEvent(event) ? 'white' : color(event, event.confidence + 0.5)\"\n                    @click=\"clickEvent(event)\"\n                ></circle>\n                <!--<rect\n                    v-for=\"event in events\"\n                    :key=\"event.time + 'eventrect'\"\n                    class=\"rectevent\"\n                    :ref=\"`rectevent${event.time}`\"\n                    :x=\"eventSize + event.time * scale + eventSize / 2 - 2\"\n                    :y=\"0\"\n                    :height=\"eventSize * 4\"\n                    :width=\"3\"\n                    rx=\"1\"\n                    :fill=\"seekerInEvent(event) ? 'white' : color(event, event.confidence + 0.5)\"\n                    @click=\"clickEvent(event)\"\n                ></rect>-->\n            </svg>\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport Section from \"./Section\";\n\nimport StructureBackground from \"./StructureBackground\";\n\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            paddingTop: 10,\n            sectionHeight: 25,\n            eventSize: 6,\n            eventHeight: 30,\n            showLoudness: true,\n        };\n    },\n    computed: {\n        height() {\n            return 150;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        hasStructure() {\n            return this.track && this.track.timbreStructure && this.track.timbreStructure.length > 0;\n        },\n        events() {\n            return this.track.events;\n        },\n        seeker() {\n            return this.$store.getters.seeker / 1000;\n        },\n    },\n    watch: {\n        seeker(newSeeker, oldSeeker) {\n            this.events.forEach((event) => {});\n        },\n    },\n    mounted() {},\n    methods: {\n        color(element, confidence = 1) {\n            return vis.sinebowColorNormalizedRadius(element.colorAngle, 1, confidence);\n        },\n        clickEvent(event) {\n            player.seekS(event.time - 0.2);\n            this.triggerEvent(event);\n        },\n        clickBackground(event) {\n            this.$refs[\"eventseeker\"].clickedSVG(event);\n        },\n        seekerInEvent(event) {\n            return this.seeker >= event.time && this.seeker < event.time + 1;\n        },\n    },\n};\n</script>\n\n<style scoped>\n.seeker {\n    pointer-events: none;\n}\n.eventSVG {\n}\n.event {\n    transition: 0.5s;\n}\n.event:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Events.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Events.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Events.vue?vue&type=template&id=e197b9bc&scoped=true&\"\nimport script from \"./Events.vue?vue&type=script&lang=js&\"\nexport * from \"./Events.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Events.vue?vue&type=style&index=0&id=e197b9bc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e197b9bc\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('rect',{staticClass:\"background\",attrs:{\"id\":\"background\",\"width\":_vm.width,\"height\":_vm.height},on:{\"click\":function($event){return _vm.click($event)}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <rect class=\"background\" id=\"background\" :width=\"width\" :height=\"height\" @click=\"click($event)\"></rect>\n</template>\n\n<script>\nimport * as player from \"../../app/player\";\n\nexport default {\n    props: {\n        width: { type: Number },\n        height: { type: Number },\n        useZoom: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    components: {},\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        zoomScale() {\n            return this.$store.getters.zoomScale;\n        },\n    },\n    methods: {\n        click(event) {\n            let xNormalized = 0;\n            let yNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n                yNormalized = event.layerY / this.height;\n            } else {\n                xNormalized = event.offsetX / this.width;\n                yNormalized = event.layerY / this.height;\n            }\n\n            if (this.useZoom && this.isZoomed) {\n                const xFromMiddle = xNormalized * 2 - 1;\n                const seekerPos = Math.min(\n                    1,\n                    Math.max(\n                        0,\n                        this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000) +\n                            xFromMiddle / (2 * this.zoomScale)\n                    )\n                );\n                player.seekS(seekerPos * this.track.getAnalysisDuration());\n            } else {\n                player.seekS(xNormalized * this.track.getAnalysisDuration());\n            }\n        },\n    },\n};\n</script>\n<style scoped>\n.background {\n    opacity: 0;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClickableBackground.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClickableBackground.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ClickableBackground.vue?vue&type=template&id=0b957349&scoped=true&\"\nimport script from \"./ClickableBackground.vue?vue&type=script&lang=js&\"\nexport * from \"./ClickableBackground.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ClickableBackground.vue?vue&type=style&index=0&id=0b957349&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0b957349\",\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div class=\"py-1\" v-if=\"hasStructure\">\n        <v-row>\n            <v-col>Timbre</v-col>\n            <v-spacer></v-spacer>\n            <v-btn icon small @click=\"showLoudness = !showLoudness\" :color=\"showLoudness ? 'white' : 'dimgrey'\">\n                <v-icon>mdi-equalizer</v-icon>\n            </v-btn>\n            <v-btn icon small @click=\"showHelp = !showHelp\"> <v-icon color=\"#ccc\" dark>mdi-help-box</v-icon> </v-btn>\n            <Tooltip :show=\"showHelp\">\n                This visualization shows timbre in the form of a segmented graph. The vertical axis, together with\n                colour, denote similarity. Height in the graph will mostly correspond to energy and brightness. A sudden\n                change in timbre will show up as a break in the graph. The\n                <v-icon dark small color=\"#ccc\">mdi-equalizer</v-icon> button toggles the embedding of loudnenss in the\n                visualization. <br />\n                The dots shown below the graph are moments of timbral anomaly, points in the music where the timbre is\n                unique and locally distinct.\n            </Tooltip>\n        </v-row>\n        <Seeker\n            class=\"seeker\"\n            :ref=\"'timbreSegmentedGraphSeeker'\"\n            :width=\"width\"\n            :height=\"height\"\n            :color=\"'rgb(255,255,255,0.3)'\"\n        />\n        <svg class=\"timbreStructureSVG\" :width=\"width\" :height=\"height\">\n            <defs>\n                <linearGradient id=\"pathGradient\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\n                    <stop\n                        v-for=\"gradientStep in gradientSteps\"\n                        :key=\"gradientStep\"\n                        :offset=\"`${gradientStep}`\"\n                        :style=\"`stop-color:${color(1 - gradientStep)};stop-opacity:1`\"\n                    />\n                </linearGradient>\n            </defs>\n            <ClickableBackground :width=\"width\" :height=\"height\"></ClickableBackground>\n            <GraphSection\n                v-for=\"(section, index) in segmentedTimbreGraph\"\n                :key=\"index + 'segmented'\"\n                :section=\"section\"\n                :height=\"sectionHeight\"\n                :scale=\"scale\"\n                :showLoudness=\"showLoudness\"\n                :coloring=\"'linear'\"\n                :positioning=\"'linear'\"\n                :verticalOffset=\"paddingTop\"\n                :containerHeight=\"height\"\n            />\n        </svg>\n        <hr class=\"divider\" />\n        <Events :width=\"width\" />\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport GraphSection from \"./GraphSection\";\nimport Events from \"./Events\";\n\nimport ClickableBackground from \"./ClickableBackground\";\nimport Tooltip from \"./Tooltip.vue\";\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n        GraphSection,\n        ClickableBackground,\n        Events,\n        Tooltip,\n    },\n    data() {\n        return {\n            paddingTop: 10,\n            sectionHeight: 25,\n            showLoudness: true,\n            gradientStepAmount: 8,\n            showHelp: false,\n        };\n    },\n    computed: {\n        height() {\n            return 150;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        hasStructure() {\n            return this.track && this.track.segmentedTimbreGraph && this.track.segmentedTimbreGraph.length > 0;\n        },\n        segmentedTimbreGraph() {\n            return this.track.segmentedTimbreGraph;\n        },\n        gradientSteps() {\n            let steps = [];\n            for (let i = 0; i < this.gradientStepAmount; i++) {\n                steps.push(i / this.gradientStepAmount);\n            }\n            return steps;\n        },\n    },\n    watch: {},\n    mounted() {},\n    methods: {\n        color(mdsFeature) {\n            return vis.sinebowColorNormalizedRadius(mdsFeature, 1, 1);\n        },\n    },\n};\n</script>\n\n<style scoped>\n.seeker {\n    pointer-events: none;\n}\n.divider {\n    border: 1px solid #333333;\n    border-radius: 2px;\n    background: #333333;\n    margin: 20px 0px;\n}\n.timbreStructureSVG {\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreSegmentedGraph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreSegmentedGraph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TimbreSegmentedGraph.vue?vue&type=template&id=2f52d4ed&scoped=true&\"\nimport script from \"./TimbreSegmentedGraph.vue?vue&type=script&lang=js&\"\nexport * from \"./TimbreSegmentedGraph.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TimbreSegmentedGraph.vue?vue&type=style&index=0&id=2f52d4ed&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2f52d4ed\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCol,VIcon,VRow,VSpacer})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-row',[_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.collapsed = !_vm.collapsed}}},[_c('v-icon',[_vm._v(\" \"+_vm._s(_vm.collapsed ? \"mdi-unfold-more-horizontal\" : \"mdi-unfold-less-horizontal\")+\" \")])],1),_c('p',[_vm._v(\" Tonality \")]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.showHelp = !_vm.showHelp}}},[_c('v-icon',{attrs:{\"color\":\"#ccc\",\"dark\":\"\"}},[_vm._v(\"mdi-help-box\")])],1),_c('Tooltip',{attrs:{\"show\":_vm.showHelp}},[_vm._v(\" This visualization shows the song's tonality change over time. Similarly to the chords, the colours correspond to the circle of fifths. Click the \"),_c('v-icon',{attrs:{\"small\":\"\",\"color\":\"#ccc\"}},[_vm._v(\"mdi-unfold-more-horizontal\")]),_vm._v(\" button to see the circle of fifths with their corresponding key names. A real-time, fast and slow pointer shows the detected key for that moment. \")],1)],1),(_vm.hasTonality)?_c('Seeker',{ref:'holisticSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"color\":'rgb(255,255,255,0.3)'}}):_vm._e(),_c('canvas',{staticClass:\"tonalityCanvas\",attrs:{\"id\":\"tonalityCanvas\",\"width\":_vm.width,\"height\":_vm.height},on:{\"click\":function($event){return _vm.clickCanvas($event)}}}),_c('div',{staticClass:\"circleOfFifthsTonality\",style:((\"height: \" + (!_vm.collapsed * _vm.co5Size) + \"px\"))},[(_vm.hasTonality)?_c('svg',{staticClass:\"tonalitySVG\",attrs:{\"width\":_vm.co5Size,\"height\":!_vm.collapsed * _vm.co5Size}},[_c('circle',{attrs:{\"cx\":_vm.co5Size / 2,\"cy\":_vm.co5Size / 2,\"r\":_vm.co5Size / 2,\"fill\":\"black\"}}),_c('g',{attrs:{\"transform\":(\"translate(\" + (_vm.co5Size / 2) + \",\" + (_vm.co5Size / 2) + \")\"),\"stroke\":\"#000\",\"stroke-width\":\"2\"}},[_vm._l((_vm.circleOfFifths),function(keyNumber,index){return _c('path',{key:'co5' + index,attrs:{\"d\":(\"M 0 0 0 -\" + (_vm.co5Size / 2) + \" A \" + (_vm.co5Size / 2) + \" \" + (_vm.co5Size / 2) + \" 0 0 1 \" + ((Math.sin(\n                            (1 / 12) * Math.PI * 2\n                        ) *\n                            _vm.co5Size) /\n                            2) + \" \" + (-(Math.cos((1 / 12) * Math.PI * 2) * _vm.co5Size) / 2) + \" Z\"),\"transform\":(\"rotate(\" + (((-index - 0.5) / 12) * 360) + \" 0 0)\"),\"fill\":_vm.color(1 - index / 12, 1, 0.7)}})}),_c('circle',{attrs:{\"r\":(_vm.co5Size / 2) * 0.58,\"fill\":\"#121212\"}}),_c('circle',{attrs:{\"r\":(_vm.co5Size / 2) * 0.8,\"fill\":\"none\",\"stroke\":\"#121212\",\"stroke-width\":\"2\"}}),_vm._l((_vm.circleOfFifths),function(keyNumber,index){return _c('text',{key:'co5text' + index,staticClass:\"co5text\",attrs:{\"x\":(Math.sin((index / 12) * Math.PI * 2) * _vm.co5Size * 0.9) / 2,\"y\":-(Math.cos((index / 12) * Math.PI * 2) * _vm.co5Size * 0.9) / 2,\"text-anchor\":\"middle\",\"alignment-baseline\":\"middle\"}},[_vm._v(\" \"+_vm._s(_vm.keyName(keyNumber))+\" \")])}),_vm._l((_vm.circleOfFifths),function(keyNumber,index){return _c('text',{key:'co5textm' + index,staticClass:\"co5textm\",attrs:{\"x\":(Math.sin(((index - 3) / 12) * Math.PI * 2) * _vm.co5Size * 0.7) / 2,\"y\":-(Math.cos(((index - 3) / 12) * Math.PI * 2) * _vm.co5Size * 0.7) / 2,\"text-anchor\":\"middle\",\"alignment-baseline\":\"middle\"}},[_vm._v(\" \"+_vm._s(_vm.keyName(keyNumber + 12))+\" \")])})],2),_c('path',{staticClass:\"tonalityPointerSlow\",attrs:{\"transform\":(\"rotate(\" + (_vm.currentAngleSlow * 360) + \" \" + (_vm.co5Size / 2) + \" \" + (_vm.co5Size / 2) + \")\"),\"d\":_vm.tonalityPointerPath(_vm.tonalitySlow),\"stroke-width\":\"4\",\"stroke\":_vm.color(_vm.currentAngleSlow, 0.6, 0.6)}}),_c('path',{staticClass:\"tonalityPointer\",attrs:{\"transform\":(\"rotate(\" + (_vm.currentAngle * 360) + \" \" + (_vm.co5Size / 2) + \" \" + (_vm.co5Size / 2) + \")\"),\"d\":_vm.tonalityPointerPath(_vm.tonality),\"stroke-width\":\"4\",\"stroke\":_vm.color(_vm.currentAngle)}})]):_vm._e()])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <v-row>\n            <v-btn icon small @click=\"collapsed = !collapsed\">\n                <v-icon>\n                    {{ collapsed ? \"mdi-unfold-more-horizontal\" : \"mdi-unfold-less-horizontal\" }}\n                </v-icon>\n            </v-btn>\n            <p>\n                Tonality\n            </p>\n            <v-spacer></v-spacer>\n            <v-btn icon small @click=\"showHelp = !showHelp\"> <v-icon color=\"#ccc\" dark>mdi-help-box</v-icon> </v-btn>\n            <Tooltip :show=\"showHelp\">\n                This visualization shows the song's tonality change over time. Similarly to the chords, the colours\n                correspond to the circle of fifths. Click the\n                <v-icon small color=\"#ccc\">mdi-unfold-more-horizontal</v-icon> button to see the circle of fifths with their\n                corresponding key names. A real-time, fast and slow pointer shows the detected key for that moment.\n            </Tooltip>\n        </v-row>\n        <Seeker\n            v-if=\"hasTonality\"\n            class=\"seeker\"\n            :ref=\"'holisticSeeker'\"\n            :width=\"width\"\n            :height=\"height\"\n            :color=\"'rgb(255,255,255,0.3)'\"\n        />\n\n        <canvas\n            id=\"tonalityCanvas\"\n            class=\"tonalityCanvas\"\n            :width=\"width\"\n            :height=\"height\"\n            @click=\"clickCanvas($event)\"\n        ></canvas>\n\n        <div :style=\"`height: ${!collapsed * co5Size}px`\" class=\"circleOfFifthsTonality\">\n            <svg v-if=\"hasTonality\" class=\"tonalitySVG\" :width=\"co5Size\" :height=\"!collapsed * co5Size\">\n                <circle :cx=\"co5Size / 2\" :cy=\"co5Size / 2\" :r=\"co5Size / 2\" fill=\"black\"></circle>\n                <g :transform=\"`translate(${co5Size / 2},${co5Size / 2})`\" stroke=\"#000\" stroke-width=\"2\">\n                    <!--<path  />-->\n                    <path\n                        v-for=\"(keyNumber, index) in circleOfFifths\"\n                        :key=\"'co5' + index\"\n                        :d=\"\n                            `M 0 0 0 -${co5Size / 2} A ${co5Size / 2} ${co5Size / 2} 0 0 1 ${(Math.sin(\n                                (1 / 12) * Math.PI * 2\n                            ) *\n                                co5Size) /\n                                2} ${-(Math.cos((1 / 12) * Math.PI * 2) * co5Size) / 2} Z`\n                        \"\n                        :transform=\"`rotate(${((-index - 0.5) / 12) * 360} 0 0)`\"\n                        :fill=\"color(1 - index / 12, 1, 0.7)\"\n                    />\n                    <circle :r=\"(co5Size / 2) * 0.58\" fill=\"#121212\"></circle>\n                    <circle :r=\"(co5Size / 2) * 0.8\" fill=\"none\" stroke=\"#121212\" stroke-width=\"2\"></circle>\n\n                    <text\n                        v-for=\"(keyNumber, index) in circleOfFifths\"\n                        :key=\"'co5text' + index\"\n                        :x=\"(Math.sin((index / 12) * Math.PI * 2) * co5Size * 0.9) / 2\"\n                        :y=\"-(Math.cos((index / 12) * Math.PI * 2) * co5Size * 0.9) / 2\"\n                        class=\"co5text\"\n                        text-anchor=\"middle\"\n                        alignment-baseline=\"middle\"\n                    >\n                        {{ keyName(keyNumber) }}\n                    </text>\n                    <text\n                        v-for=\"(keyNumber, index) in circleOfFifths\"\n                        :key=\"'co5textm' + index\"\n                        :x=\"(Math.sin(((index - 3) / 12) * Math.PI * 2) * co5Size * 0.7) / 2\"\n                        :y=\"-(Math.cos(((index - 3) / 12) * Math.PI * 2) * co5Size * 0.7) / 2\"\n                        class=\"co5textm\"\n                        text-anchor=\"middle\"\n                        alignment-baseline=\"middle\"\n                    >\n                        {{ keyName(keyNumber + 12) }}\n                    </text>\n                </g>\n\n                <path\n                    class=\"tonalityPointerSlow\"\n                    :transform=\"`rotate(${currentAngleSlow * 360} ${co5Size / 2} ${co5Size / 2})`\"\n                    :d=\"tonalityPointerPath(tonalitySlow)\"\n                    stroke-width=\"4\"\n                    :stroke=\"color(currentAngleSlow, 0.6, 0.6)\"\n                />\n                <path\n                    class=\"tonalityPointer\"\n                    :transform=\"`rotate(${currentAngle * 360} ${co5Size / 2} ${co5Size / 2})`\"\n                    :d=\"tonalityPointerPath(tonality)\"\n                    stroke-width=\"4\"\n                    :stroke=\"color(currentAngle)\"\n                />\n            </svg>\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport * as audioUtil from \"../../app/audioUtil\";\n\nimport * as keyDetection from \"../../app/keyDetection\";\nimport Seeker from \"./Seeker\";\nimport Section from \"./Section\";\n\nimport ClickableBackground from \"./ClickableBackground\";\nimport SeparatorBackground from \"./SeparatorBackground\";\nimport Tooltip from \"./Tooltip.vue\";\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n        Tooltip,\n    },\n    data() {\n        return {\n            paddingTop: 10,\n            sectionHeight: 20,\n            showLoudness: true,\n            accumulativeAngle: [],\n            collapsed: true,\n            co5Size: 300,\n            showHelp: false,\n        };\n    },\n    computed: {\n        height() {\n            let height = 0;\n            height += this.sectionHeight * 2;\n            height += 2 * 2;\n            return height;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        hasTonality() {\n            return this.track && this.track.tonalityFeatureLarge && this.track.tonalityFeatureLarge.length > 0;\n        },\n        tonality() {\n            return this.hasTonality && this.track.tonalityFeatureSmall;\n        },\n        tonalitySlow() {\n            return this.hasTonality && this.track.tonalityFeatureLarge;\n        },\n        keyFeature() {\n            return this.hasTonality && this.track.keyFeature;\n        },\n        sampleDuration() {\n            return this.track.features.sampleDuration;\n        },\n        fastSampleDuration() {\n            return this.track.features.fastSampleDuration;\n        },\n        currentFastSample() {\n            return Math.floor(this.$store.getters.seeker / 1000 / this.fastSampleDuration);\n        },\n        currentSample() {\n            return Math.floor(this.$store.getters.seeker / 1000 / this.sampleDuration);\n        },\n        currentAngle() {\n            return this.accumulativeAngle[this.currentFastSample];\n        },\n        currentAngleSlow() {\n            return this.accumulativeAngleSlow[this.currentFastSample];\n        },\n        circleOfFifths() {\n            return audioUtil.circleOfFifths;\n        },\n        currentKey() {\n            return this.keyFeature[this.currentFastSample];\n        },\n    },\n    watch: {\n        track() {\n            if (this.hasTonality) {\n                this.setupCanvas();\n                this.accumulativeAngle = this.computeAccumulativeAngle(this.tonality);\n                this.accumulativeAngleSlow = this.computeAccumulativeAngle(this.tonalitySlow);\n\n                this.drawTonality();\n            }\n        },\n        hasTonality() {\n            if (this.hasTonality) {\n                this.setupCanvas();\n                this.accumulativeAngle = this.computeAccumulativeAngle(this.tonality);\n                this.accumulativeAngleSlow = this.computeAccumulativeAngle(this.tonalitySlow);\n                this.drawTonality();\n            }\n        },\n    },\n    mounted() {\n        this.setupCanvas();\n    },\n    methods: {\n        setupCanvas() {\n            if (this.ctx) return;\n            this.canvas = document.getElementById(\"tonalityCanvas\");\n            if (!this.canvas) {\n                return;\n            }\n\n            this.canvas.width = this.width;\n            this.ctx = this.canvas.getContext(\"2d\");\n            this.drawTonality();\n        },\n        tonalityPointerPath(tonality) {\n            const scale = this.co5Size / 2;\n            const radius = Math.tanh(tonality[this.currentFastSample][1] * 3) * 0.5;\n            const x = 0; // Math.cos(this.tonality[this.currentSample][0] * Math.PI * 2);\n            const y = -1; //Math.sin(this.tonality[this.currentSample][0] * Math.PI * 2);\n\n            let path = \"\";\n            path = path.concat(\" M \", scale, \" \", scale);\n            path = path.concat(\" L \", scale + x * scale * radius, \" \", scale + y * scale * radius);\n            path = path.concat(\" Z\");\n            return path;\n        },\n        drawTonality() {\n            if (!this.ctx || !this.hasTonality) {\n                return;\n            }\n            this.ctx.clearRect(0, 0, this.width, this.height);\n\n            for (let i = 0; i < this.tonality.length; i++) {\n                const x = i * this.fastSampleDuration * this.scale;\n\n                this.ctx.fillStyle = this.color(this.tonalitySlow[i][0], Math.sqrt(this.tonalitySlow[i][1] * 2), 1);\n                this.ctx.fillRect(\n                    x,\n                    this.sectionHeight + 2,\n                    this.fastSampleDuration * this.scale + 2,\n                    this.sectionHeight\n                );\n                this.ctx.fillStyle = this.color(this.tonality[i][0], this.tonality[i][1] * 1.5, 1);\n                this.ctx.fillRect(x, 0, this.fastSampleDuration * this.scale + 2, this.sectionHeight);\n                /*\n                this.ctx.fillStyle = this.color(keyDetection.circleOfFifthsAngle(this.keyFeature[i]), 1, 1);\n                this.ctx.fillRect(\n                    x,\n                    (this.sectionHeight + 2) * 2,\n                    this.fastSampleDuration * this.scale + 2,\n                    this.sectionHeight\n                );*/\n                /*if (i === 0 || i === 200) {\n                    this.ctx.fillStyle = \"white\";\n                    this.ctx.fillRect(\n                        x,\n                        (this.sectionHeight + 2) * 2 - 4,\n                        this.fastSampleDuration * this.scale + 6,\n                        this.sectionHeight * 2\n                    );\n                }*/\n            }\n        },\n        computeAccumulativeAngle(tonality) {\n            const accumulativeAngle = [];\n            let prevAngle = tonality[0][0];\n            let windCounter = 0;\n            for (let i = 0; i < tonality.length; i++) {\n                const current = tonality[i][0];\n                const passThrough0Pos = current < prevAngle && prevAngle - current > 1 + current - prevAngle;\n                const passThrough0Neg = current > prevAngle && current - prevAngle > 1 + prevAngle - current;\n                if (passThrough0Pos) windCounter++;\n                if (passThrough0Neg) windCounter--;\n                accumulativeAngle.push(windCounter + current);\n                prevAngle = current;\n            }\n            return accumulativeAngle;\n        },\n        color(angle, saturation = 1.3, opacity = 1) {\n            if (angle < 0) angle += Math.abs(Math.floor(angle));\n            return vis.circleOfFifthsColor(angle % 1, saturation, opacity);\n        },\n        keyName(keyNumber) {\n            return audioUtil.keyNames[keyNumber];\n        },\n        clickCanvas(event) {\n            let xNormalized = 0;\n            let yNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n                yNormalized = event.layerY / this.height;\n            } else {\n                xNormalized = event.offsetX / this.width;\n                yNormalized = event.layerY / this.height;\n            }\n\n            player.seekS(xNormalized * this.track.getAnalysisDuration());\n        },\n    },\n};\n</script>\n\n<style scoped>\n.seeker {\n    pointer-events: none;\n}\n.circleOfFifthsTonality {\n    position: relative;\n    transition: 0.5s;\n}\n.tonalitySVG {\n    position: absolute;\n    transition: 0.5s;\n    top: 0;\n    left: 0;\n    z-index: 20;\n}\n.tonalityPointer {\n    transition: 0.15s;\n    z-index: 20;\n}\n.tonalityPointerSlow {\n    transition: 0.15s;\n    z-index: 20;\n}\n.CO5 {\n    transition: 0.5s;\n    overflow: hidden;\n    z-index: 1;\n    object-position: 0 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    opacity: 0.5;\n}\n.co5text {\n    font: 14px Roboto;\n    fill: white;\n    stroke: transparent;\n}\n.co5textm {\n    font: 12px Roboto;\n    fill: white;\n    stroke: transparent;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tonality.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tonality.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tonality.vue?vue&type=template&id=2a1362ce&scoped=true&\"\nimport script from \"./Tonality.vue?vue&type=script&lang=js&\"\nexport * from \"./Tonality.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Tonality.vue?vue&type=style&index=0&id=2a1362ce&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2a1362ce\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VIcon,VRow,VSpacer})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"py-1\"},[_c('v-row',[_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.collapsed = !_vm.collapsed}}},[_c('v-icon',[_vm._v(\" \"+_vm._s(_vm.collapsed ? \"mdi-unfold-more-horizontal\" : \"mdi-unfold-less-horizontal\")+\" \")])],1),_c('p',[_vm._v(\" Chords \")]),_c('v-spacer'),_c('v-btn',{attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.showHelp = !_vm.showHelp}}},[_c('v-icon',{attrs:{\"color\":\"#ccc\",\"dark\":\"\"}},[_vm._v(\"mdi-help-box\")])],1),_c('Tooltip',{attrs:{\"show\":_vm.showHelp}},[_vm._v(\" This visualization shows major and minor triad chords over time. The colors and positions correspond to the circle of fifhts, such that relative minor and major chords have the same colour, with minor chords being distinguished by diagonal stripes. The \"),_c('v-icon',{attrs:{\"small\":\"\",\"color\":\"#ccc\"}},[_vm._v(\"mdi-unfold-less-horizontal\")]),_vm._v(\" button collapses the chord positions into a single row. \")],1)],1),(_vm.hasChords)?_c('Seeker',{ref:'chordsSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"color\":'rgb(255,255,255,0.3)'}}):_vm._e(),(_vm.hasChords)?_c('svg',{staticClass:\"chordsSVG\",attrs:{\"width\":_vm.width,\"height\":_vm.height}},[_c('ClickableBackground',{attrs:{\"width\":_vm.width,\"height\":_vm.height}}),_c('defs',[_c('pattern',{attrs:{\"id\":\"textureDiagonal\",\"width\":\"4\",\"height\":\"4\",\"patternUnits\":\"userSpaceOnUse\",\"patternContentUnits\":\"userSpaceOnUse\"}},[_c('path',{staticStyle:{\"stroke\":\"#999999\",\"stroke-width\":\"1\"},attrs:{\"d\":\"M-1,1 l2,-2\\n                        M0,4 l4,-4\\n                        M3,5 l2,-2\"}})]),_c('pattern',{attrs:{\"id\":\"texture\",\"width\":\"4\",\"height\":\"1\",\"patternUnits\":\"userSpaceOnUse\",\"patternContentUnits\":\"userSpaceOnUse\"}},[_c('path',{staticStyle:{\"stroke\":\"#414141\",\"stroke-width\":\"1\"},attrs:{\"d\":\"M 0 0 l 10 0\"}})]),_c('mask',{attrs:{\"id\":\"diagonalMask\",\"x\":\"0\",\"y\":\"0\",\"width\":\"1\",\"height\":\"1\"}},[_c('rect',{attrs:{\"x\":\"0\",\"y\":\"0\",\"width\":\"1000\",\"height\":\"1000\",\"fill\":\"url(#textureDiagonal)\"}})])]),_vm._l((_vm.chords),function(chord,index){return _c('rect',{key:index + 'chord',staticClass:\"chord\",attrs:{\"rx\":\"3\",\"x\":chord.start * _vm.scale + 0.5,\"y\":_vm.collapsed ? '0' : ((2 - chord.angle + _vm.chordGapOffset) % 1) * (_vm.height - _vm.blockHeight) + 0.5,\"width\":(chord.end - chord.start) * _vm.scale - 0.5,\"height\":_vm.blockHeight - 0.5,\"fill\":_vm.color(chord)},on:{\"click\":function($event){return _vm.clickedChord(chord)}}})}),_vm._l((_vm.chords),function(chord,index){return _c('rect',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isMajor(chord)),expression:\"!isMajor(chord)\"}],key:index + 'chordoverlay',staticClass:\"chordoverlay\",attrs:{\"rx\":\"3\",\"x\":chord.start * _vm.scale + 0.5,\"y\":_vm.collapsed ? '0' : ((2 - chord.angle + _vm.chordGapOffset) % 1) * (_vm.height - _vm.blockHeight) + 0.5,\"width\":(chord.end - chord.start) * _vm.scale - 0.5,\"height\":_vm.blockHeight - 0.5,\"fill\":_vm.colorBrightness(chord, 0.02),\"mask\":\"url(#diagonalMask)\"},on:{\"click\":function($event){return _vm.clickedChord(chord)}}})})],2):_vm._e(),_c('canvas',{staticClass:\"chordNameCanvas\",attrs:{\"id\":\"chordNameCanvas\",\"width\":_vm.width,\"height\":_vm.chordNameHeight}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"py-1\">\n        <v-row>\n            <v-btn icon small @click=\"collapsed = !collapsed\">\n                <v-icon>\n                    {{ collapsed ? \"mdi-unfold-more-horizontal\" : \"mdi-unfold-less-horizontal\" }}\n                </v-icon>\n            </v-btn>\n            <p>\n                Chords\n            </p>\n            <v-spacer></v-spacer>\n            <v-btn icon small @click=\"showHelp = !showHelp\"> <v-icon color=\"#ccc\" dark>mdi-help-box</v-icon> </v-btn>\n            <Tooltip :show=\"showHelp\">\n                This visualization shows major and minor triad chords over time. The colors and positions correspond to\n                the circle of fifhts, such that relative minor and major chords have the same colour, with minor chords\n                being distinguished by diagonal stripes. The\n                <v-icon small color=\"#ccc\">mdi-unfold-less-horizontal</v-icon> button collapses the chord positions into\n                a single row.\n            </Tooltip>\n        </v-row>\n\n        <Seeker\n            v-if=\"hasChords\"\n            class=\"seeker\"\n            :ref=\"'chordsSeeker'\"\n            :width=\"width\"\n            :height=\"height\"\n            :color=\"'rgb(255,255,255,0.3)'\"\n        />\n        <svg v-if=\"hasChords\" class=\"chordsSVG\" :width=\"width\" :height=\"height\">\n            <ClickableBackground :width=\"width\" :height=\"height\"></ClickableBackground>\n            <defs>\n                <pattern\n                    id=\"textureDiagonal\"\n                    width=\"4\"\n                    height=\"4\"\n                    patternUnits=\"userSpaceOnUse\"\n                    patternContentUnits=\"userSpaceOnUse\"\n                >\n                    <path\n                        d=\"M-1,1 l2,-2\n                            M0,4 l4,-4\n                            M3,5 l2,-2\"\n                        style=\"stroke:#999999; stroke-width:1\"\n                    />\n                </pattern>\n                <pattern\n                    id=\"texture\"\n                    width=\"4\"\n                    height=\"1\"\n                    patternUnits=\"userSpaceOnUse\"\n                    patternContentUnits=\"userSpaceOnUse\"\n                >\n                    <path d=\"M 0 0 l 10 0\" style=\"stroke:#414141; stroke-width:1\" />\n                </pattern>\n                <mask id=\"diagonalMask\" x=\"0\" y=\"0\" width=\"1\" height=\"1\">\n                    <rect x=\"0\" y=\"0\" width=\"1000\" height=\"1000\" fill=\"url(#textureDiagonal)\" />\n                </mask>\n            </defs>\n            <!--<rect\n                v-for=\"(chord, index) in chords\"\n                :key=\"index + 'chord'\"\n                class=\"chord\"\n                rx=\"3\"\n                :x=\"chord.start * scale + 0.5\"\n                :y=\"height - chord.index * blockHeight - blockHeight\"\n                :width=\"(chord.end - chord.start) * scale - 0.5\"\n                :height=\"blockHeight - 0.5\"\n                :fill=\"'black'\"\n                @click=\"clickedChord(chord)\"\n            ></rect>-->\n            <rect\n                v-for=\"(chord, index) in chords\"\n                :key=\"index + 'chord'\"\n                class=\"chord\"\n                rx=\"3\"\n                :x=\"chord.start * scale + 0.5\"\n                :y=\"collapsed ? '0' : ((2 - chord.angle + chordGapOffset) % 1) * (height - blockHeight) + 0.5\"\n                :width=\"(chord.end - chord.start) * scale - 0.5\"\n                :height=\"blockHeight - 0.5\"\n                :fill=\"color(chord)\"\n                @click=\"clickedChord(chord)\"\n            ></rect>\n            <rect\n                v-for=\"(chord, index) in chords\"\n                :key=\"index + 'chordoverlay'\"\n                v-show=\"!isMajor(chord)\"\n                class=\"chordoverlay\"\n                rx=\"3\"\n                :x=\"chord.start * scale + 0.5\"\n                :y=\"collapsed ? '0' : ((2 - chord.angle + chordGapOffset) % 1) * (height - blockHeight) + 0.5\"\n                :width=\"(chord.end - chord.start) * scale - 0.5\"\n                :height=\"blockHeight - 0.5\"\n                :fill=\"colorBrightness(chord, 0.02)\"\n                mask=\"url(#diagonalMask)\"\n                @click=\"clickedChord(chord)\"\n            />\n        </svg>\n        <canvas id=\"chordNameCanvas\" class=\"chordNameCanvas\" :width=\"width\" :height=\"chordNameHeight\"></canvas>\n    </div>\n</template>\n\n<script>\n// chord.index/ 12 %1\n// (chord.index < 12 ? chord.index / 12 : (chord.index + (3 % 12)) / 12)\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport Section from \"./Section\";\nimport ClickableBackground from \"./ClickableBackground\";\nimport StructureBackground from \"./StructureBackground\";\nimport Tooltip from \"./Tooltip\";\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n        ClickableBackground,\n        Tooltip,\n    },\n    data() {\n        return {\n            blockHeight: 10,\n            chordNameHeight: 20,\n            maxChordViewDistance: 10,\n            canvas: null,\n            ctx: null,\n            collapsed: false,\n            showHelp: false,\n        };\n    },\n    computed: {\n        height() {\n            return this.blockHeight * (this.collapsed ? 1 : 12);\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        seekerTime() {\n            return this.$store.getters.seeker / 1000;\n        },\n        hasChords() {\n            return this.track && this.track.chords && this.track.chords.length > 0;\n        },\n        chords() {\n            return this.track.chords;\n        },\n        currentChord() {\n            return this.chords.find((chord) => this.isPlayingChord(chord, this.seekerTime)) || { name: \"\" };\n        },\n        chordScrollMiddle() {\n            return 50;\n            //return this.seekerTime * this.scale;\n        },\n        chordGapOffset() {\n            const chordTotalDuration = new Float32Array(12);\n\n            this.chords.forEach((chord) => {\n                chordTotalDuration[Math.round(chord.angle * 12)] += chord.end - chord.start;\n            });\n\n            let min = Number.POSITIVE_INFINITY;\n            let minIndex = -1;\n            for (let i = 0; i < 12; i++) {\n                if (chordTotalDuration[i] < min) {\n                    min = chordTotalDuration[i];\n                    minIndex = i;\n                }\n            }\n\n            log.debug(\"Chord total duration\", chordTotalDuration);\n            return minIndex / 12;\n        },\n    },\n    watch: {\n        seekerTime() {\n            this.drawChordNames();\n        },\n        hasChords() {\n            this.setupCanvas();\n        },\n    },\n    mounted() {\n        this.setupCanvas();\n    },\n    methods: {\n        setupCanvas() {\n            if (this.ctx) return;\n            this.canvas = document.getElementById(\"chordNameCanvas\");\n            if (!this.canvas) {\n                return;\n            }\n            this.canvas.width = this.width;\n            this.ctx = this.canvas.getContext(\"2d\");\n            this.drawChordNames();\n        },\n        drawChordNames() {\n            if (!this.ctx || !this.hasChords) {\n                log.debug(\"No drawing\");\n                return;\n            }\n            this.ctx.fillStyle = \"white\";\n            this.ctx.clearRect(0, 0, this.width, this.chordNameHeight);\n            //this.ctx.fillRect(0, 0, this.width, this.chordNameHeight);\n\n            const lineStep = this.chordNameHeight;\n\n            this.ctx.fillStyle = \"white\";\n            this.chords.forEach((chord) => {\n                const chordSeekerStartOffset = chord.start - this.seekerTime;\n                let startX = this.chordScrollMiddle + chordSeekerStartOffset * this.scale * 22;\n                const chordSeekerEndOffset = chord.end - this.seekerTime;\n                const endX = this.chordScrollMiddle + chordSeekerEndOffset * this.scale * 22;\n\n                if (chordSeekerEndOffset > 0 && chordSeekerStartOffset < this.maxChordViewDistance) {\n                    if (chord.start <= this.seekerTime) {\n                        this.ctx.fillStyle = this.color(chord, 1);\n                        if (endX - this.chordScrollMiddle - 3 > 6) {\n                            this.roundedRect(\n                                this.chordScrollMiddle,\n                                0,\n                                endX - this.chordScrollMiddle - 3,\n                                this.chordNameHeight,\n                                3\n                            );\n                            this.ctx.strokeStyle = \"rgba(0,0,0,0.3)\";\n                            this.ctx.lineWidth = 3;\n                            const textSpaceOffset = chord.name.length * 12;\n                            if (!this.isMajor(chord)) {\n                                for (let i = startX + textSpaceOffset; i < endX; i += lineStep / 2) {\n                                    if (i < this.chordScrollMiddle - lineStep) continue;\n                                    this.ctx.beginPath();\n                                    this.ctx.moveTo(i, this.chordNameHeight);\n                                    if (i + lineStep > endX - 3) {\n                                        this.ctx.lineTo(\n                                            endX - 3,\n                                            this.chordNameHeight + 3 - (lineStep - (lineStep + i - endX))\n                                        );\n                                    } else {\n                                        this.ctx.lineTo(i + lineStep, 0);\n                                    }\n                                    this.ctx.stroke();\n                                }\n                                this.ctx.fillStyle = \"#121212\";\n                                this.ctx.fillRect(this.chordScrollMiddle - lineStep, 0, lineStep, this.chordNameHeight);\n                            }\n                        }\n\n                        this.ctx.fillStyle = \"white\";\n                        this.ctx.font = \"18px Roboto\";\n\n                        this.ctx.fillText(chord.name, this.chordScrollMiddle - 50 + 2, this.chordNameHeight - 4);\n                    } else {\n                        const opacity = 1 - chordSeekerStartOffset / this.maxChordViewDistance;\n                        this.ctx.fillStyle = this.color(chord, opacity * 1.5);\n                        this.roundedRect(startX, 0, endX - startX - 3, this.chordNameHeight, 3);\n                        this.ctx.strokeStyle = \"rgba(0,0,0,0.3)\";\n                        this.ctx.font = \"14px Roboto\";\n                        this.ctx.lineWidth = 3;\n                        if (!this.isMajor(chord)) {\n                            const textSpaceOffset = chord.name.length * 12;\n                            for (let i = startX + textSpaceOffset; i < endX; i += lineStep / 2) {\n                                this.ctx.beginPath();\n                                this.ctx.moveTo(i, this.chordNameHeight);\n                                if (i + lineStep > endX - 3) {\n                                    this.ctx.lineTo(\n                                        endX - 3,\n                                        this.chordNameHeight + 3 - (lineStep - (lineStep + i - endX))\n                                    );\n                                } else {\n                                    this.ctx.lineTo(i + lineStep, 0);\n                                }\n                                this.ctx.stroke();\n                            }\n                        }\n\n                        this.ctx.fillStyle = `rgba(0,0,0,${opacity * 2})`;\n\n                        this.ctx.fillText(chord.name, startX + 2, this.chordNameHeight - 4);\n                    }\n                }\n            });\n            this.ctx.fillRect(this.chordScrollMiddle - 1, 0, 2, this.chordNameHeight);\n        },\n        roundedRect(x, y, width, height, radius) {\n            this.ctx.beginPath();\n            this.ctx.moveTo(x + width, y + height);\n            this.ctx.arcTo(x, y + height, x, y, radius);\n            this.ctx.arcTo(x, y, x + width, y, radius);\n            this.ctx.arcTo(x + width, y, x + width, y + height, radius);\n            this.ctx.arcTo(x + width, y + height, x, y + height, radius);\n            this.ctx.fill();\n        },\n        color(chord, confidence = 1) {\n            return vis.circleOfFifthsColor(chord.angle % 1, 1, confidence);\n            //return vis.circleOfFifthsColor(chord.angle % 1, chord.index > 11 ? 1 : 0.8, chord.index > 11 ? 1 : 0.8);\n        },\n        colorBrightness(chord, brightness) {\n            return vis.circleOfFifthsColorBrightness(chord.angle % 1, 0.5, brightness);\n        },\n        isMajor(chord) {\n            return chord.index <= 11;\n        },\n        isPlayingChord(chord) {\n            return this.seekerTime >= chord.start && this.seekerTime < chord.end;\n        },\n        clickedChord(chord) {\n            player.seekS(chord.start);\n        },\n    },\n};\n</script>\n\n<style scoped>\n.seeker {\n    pointer-events: none;\n}\n.chord {\n    transition: 0.3s;\n}\n.chordoverlay {\n    transition: 0.3s;\n}\n.chordoverlay:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n.chordsSVG {\n    transition: 0.3s;\n}\n.chordsBackground {\n    transition: 0.3s;\n}\n.chord:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chords.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chords.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chords.vue?vue&type=template&id=cacf534a&scoped=true&\"\nimport script from \"./Chords.vue?vue&type=script&lang=js&\"\nexport * from \"./Chords.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chords.vue?vue&type=style&index=0&id=cacf534a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cacf534a\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VIcon,VRow,VSpacer})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.track && _vm.hasFeatures)?_c('div',[_c('v-row',[_c('v-btn',{staticClass:\"pa-0 ma-0\",attrs:{\"icon\":\"\",\"small\":\"\"},on:{\"click\":function($event){_vm.expanded = !_vm.expanded}}},[_c('v-icon',[_vm._v(_vm._s(_vm.expanded ? \"mdi-chevron-up\" : \"mdi-chevron-down\"))])],1),_c('p',{staticClass:\"pa-0 ma-0\",on:{\"click\":function($event){_vm.expanded = !_vm.expanded}}},[_vm._v(_vm._s(_vm.feature.name))])],1),_c('v-expand-transition',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.expanded),expression:\"expanded\"}]},[_c('Seeker',{attrs:{\"width\":_vm.width,\"height\":_vm.height}}),_c('svg',{attrs:{\"width\":_vm.width + 25,\"height\":_vm.height}},[_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height -\n                            (_vm.height * this.offsetHeight) / 2 -\n                            _vm.height * (this.avgPos - (3.5 * this.offsetHeight) / 2),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".1\",\"fill\":\"grey\"}}),_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height -\n                            (_vm.height * this.offsetHeight) / 2 -\n                            _vm.height * (this.avgPos - (2.5 * this.offsetHeight) / 2),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".1\",\"fill\":\"white\"}}),_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height -\n                            (_vm.height * this.offsetHeight) / 2 -\n                            _vm.height * (this.avgPos - (1.5 * this.offsetHeight) / 2),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".1\",\"fill\":\"grey\"}}),_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height - (_vm.height * this.offsetHeight) / 2 - _vm.height * (this.avgPos - this.offsetHeight / 4),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".2\",\"fill\":\"white\"}}),_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height - (_vm.height * this.offsetHeight) / 2 - _vm.height * (this.avgPos + this.offsetHeight / 4),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".1\",\"fill\":\"grey\"}}),_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height -\n                            (_vm.height * this.offsetHeight) / 2 -\n                            _vm.height * (this.avgPos + (1.5 * this.offsetHeight) / 2),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".1\",\"fill\":\"white\"}}),_c('rect',{attrs:{\"x\":\"0\",\"width\":_vm.width,\"y\":_vm.height -\n                            (_vm.height * this.offsetHeight) / 2 -\n                            _vm.height * (this.avgPos + (2.5 * this.offsetHeight) / 2),\"height\":(_vm.height * this.offsetHeight) / 2,\"opacity\":\".1\",\"fill\":\"grey\"}}),_c('path',{staticClass:\"graphPath\",attrs:{\"fill\":\"none\",\"stroke\":\"white\",\"stroke-width\":\"2\",\"d\":_vm.d}}),_c('text',{attrs:{\"x\":_vm.width + 2,\"y\":\"7\",\"font-size\":\"10\",\"fill\":\"white\"}},[_vm._v(_vm._s(parseFloat(_vm.max).toFixed(2)))]),_c('text',{attrs:{\"x\":_vm.width + 2,\"y\":_vm.height,\"font-size\":\"10\",\"fill\":\"white\"}},[_vm._v(\" \"+_vm._s(parseFloat(_vm.min).toFixed(2))+\" \")]),_c('text',{attrs:{\"x\":_vm.width + 2,\"y\":_vm.height - _vm.height * ((this.feature.avg - this.min) / (this.max - this.min)),\"font-size\":\"10\",\"fill\":\"white\"}},[_vm._v(\" \"+_vm._s(parseFloat(this.feature.avg).toFixed(2))+\" \")])])],1)])],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div v-if=\"track && hasFeatures\">\n        <v-row>\n            <v-btn icon small class=\"pa-0 ma-0\" @click=\"expanded = !expanded\"\n                ><v-icon>{{ expanded ? \"mdi-chevron-up\" : \"mdi-chevron-down\" }}</v-icon>\n            </v-btn>\n            <p @click=\"expanded = !expanded\" class=\"pa-0 ma-0\">{{ feature.name }}</p>\n        </v-row>\n        <v-expand-transition>\n            <div v-show=\"expanded\">\n                <Seeker :width=\"width\" :height=\"height\" />\n                <svg :width=\"width + 25\" :height=\"height\">\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"\n                            height -\n                                (height * this.offsetHeight) / 2 -\n                                height * (this.avgPos - (3.5 * this.offsetHeight) / 2)\n                        \"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".1\"\n                        fill=\"grey\"\n                    ></rect>\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"\n                            height -\n                                (height * this.offsetHeight) / 2 -\n                                height * (this.avgPos - (2.5 * this.offsetHeight) / 2)\n                        \"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".1\"\n                        fill=\"white\"\n                    ></rect>\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"\n                            height -\n                                (height * this.offsetHeight) / 2 -\n                                height * (this.avgPos - (1.5 * this.offsetHeight) / 2)\n                        \"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".1\"\n                        fill=\"grey\"\n                    ></rect>\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"height - (height * this.offsetHeight) / 2 - height * (this.avgPos - this.offsetHeight / 4)\"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".2\"\n                        fill=\"white\"\n                    ></rect>\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"height - (height * this.offsetHeight) / 2 - height * (this.avgPos + this.offsetHeight / 4)\"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".1\"\n                        fill=\"grey\"\n                    ></rect>\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"\n                            height -\n                                (height * this.offsetHeight) / 2 -\n                                height * (this.avgPos + (1.5 * this.offsetHeight) / 2)\n                        \"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".1\"\n                        fill=\"white\"\n                    ></rect>\n                    <rect\n                        x=\"0\"\n                        :width=\"width\"\n                        :y=\"\n                            height -\n                                (height * this.offsetHeight) / 2 -\n                                height * (this.avgPos + (2.5 * this.offsetHeight) / 2)\n                        \"\n                        :height=\"(height * this.offsetHeight) / 2\"\n                        opacity=\".1\"\n                        fill=\"grey\"\n                    ></rect>\n                    <path fill=\"none\" stroke=\"white\" stroke-width=\"2\" :d=\"d\" class=\"graphPath\" />\n\n                    <text :x=\"width + 2\" y=\"7\" font-size=\"10\" fill=\"white\">{{ parseFloat(max).toFixed(2) }}</text>\n                    <text :x=\"width + 2\" :y=\"height\" font-size=\"10\" fill=\"white\">\n                        {{ parseFloat(min).toFixed(2) }}\n                    </text>\n                    <text\n                        :x=\"width + 2\"\n                        :y=\"height - height * ((this.feature.avg - this.min) / (this.max - this.min))\"\n                        font-size=\"10\"\n                        fill=\"white\"\n                    >\n                        {{ parseFloat(this.feature.avg).toFixed(2) }}\n                    </text>\n                </svg>\n            </div>\n        </v-expand-transition>\n    </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport * as log from \"../../dev/log\";\nimport Seeker from \"./Seeker\";\n\nexport default {\n    props: [\"width\", \"height\", \"featureIndex\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            range: [-5, -4, -3, -2, -1, 1, 2, 3, 4, 5],\n            bgOffset: 0.1,\n            expanded: true,\n            max: 0,\n            min: 0,\n            d: null,\n        };\n    },\n    watch: {\n        track() {\n            this.generateLine();\n        },\n        width() {\n            this.generateLine();\n        },\n        feature() {\n            this.generateLine();\n        },\n        expanded() {\n            this.generateLine();\n        },\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        hasFeatures() {\n            return this.track.tempoFeature.data.length > 0;\n        },\n        feature() {\n            return this.track.tempoFeature;\n        },\n        step() {\n            return this.width / (this.feature.data.length - 1);\n        },\n        lineGenerator() {\n            return d3\n                .line()\n                .x((v, i) => {\n                    return (this.width / (this.feature.data.length - 1)) * i;\n                })\n                .y((v) => {\n                    return this.height - this.lmap(v, this.min, this.max) * this.height;\n                });\n        },\n        avgPos() {\n            return this.lmap(this.feature.avg, this.min, this.max);\n        },\n        offsetHeight() {\n            return (this.feature.avg * this.bgOffset) / (this.max - this.min);\n        },\n    },\n    mounted() {\n        this.generateLine();\n        window.eventBus.$on(\"featuresProcessed\", () => {\n            log.debug(\"FEATURESPROCESSEDFROMTempo\");\n            this.generateLine();\n        });\n    },\n    methods: {\n        lmap(val, min, max) {\n            return (val - min) / (max - min);\n        },\n        generateLine() {\n            this.min = this.feature.avg * (1 - this.bgOffset);\n            this.max = this.feature.avg * (1 + this.bgOffset);\n            if (this.feature.min < this.min) {\n                this.min = this.feature.min;\n            }\n            if (this.feature.max > this.max) {\n                this.max = this.feature.max;\n            }\n            this.d = this.lineGenerator(this.feature.data);\n        },\n    },\n};\n</script>\n\n<style>\n.graphTitle {\n    color: white;\n}\n.icon__flip {\n    -moz-transform: scaleX(-1);\n    -o-transform: scaleX(-1);\n    -webkit-transform: scaleX(-1);\n    transform: scaleX(-1);\n    filter: FlipH;\n    -ms-filter: \"FlipH\";\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tempo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tempo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tempo.vue?vue&type=template&id=fd114e90&\"\nimport script from \"./Tempo.vue?vue&type=script&lang=js&\"\nexport * from \"./Tempo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Tempo.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VExpandTransition } from 'vuetify/lib/components/transitions';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VExpandTransition,VIcon,VRow})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"py-5\"},[_c('Seeker',{ref:'holisticSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"color\":'rgb(255,255,255,0.5)'}}),_c('svg',{staticClass:\"timbreGraphSVG\",attrs:{\"width\":_vm.width,\"height\":_vm.height}},[_c('defs',[_c('linearGradient',{attrs:{\"id\":\"pathGradient\",\"x1\":\"0\",\"x2\":\"0\",\"y1\":\"0\",\"y2\":\"1\"}},_vm._l((_vm.gradientSteps),function(gradientStep){return _c('stop',{key:gradientStep,style:((\"stop-color:\" + (_vm.color(1 - gradientStep)) + \";stop-opacity:1\")),attrs:{\"offset\":(\"\" + gradientStep)}})}),1)],1),_c('rect',{staticClass:\"timbreGraphBackground\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"opacity\":\"0\"},on:{\"click\":function($event){return _vm.clickBackground($event)}}}),(_vm.timbreFeatureGraph && _vm.showPath)?_c('path',{staticClass:\"timbreGraph\",attrs:{\"fill\":\"none\",\"stroke\":_vm.showPathGradient ? 'url(#pathGradient)' : 'white',\"opacity\":_vm.showPathGradient ? '1' : '0.2',\"stroke-width\":\"2\",\"stroke-linejoin\":\"round\",\"d\":_vm.timbreFeatureGraphPath}}):_vm._e(),(_vm.showPoints)?_c('g',[_vm._l((_vm.timbreFeatureGraph),function(sample,index){return _c('rect',{key:index,staticClass:\"sample\",attrs:{\"stroke\":\"black\",\"stroke-width\":\".5\",\"rx\":\"5\",\"x\":index * _vm.sampleWidth - _vm.sampleWidth / 2,\"y\":_vm.height - _vm.sampleWidth * 2 - sample.mdsFeature * (_vm.height - _vm.sampleWidth * 2),\"width\":_vm.sampleWidth,\"height\":_vm.sampleWidth * 2,\"fill\":_vm.color(sample.mdsFeature)}})}),_vm._l((_vm.timbreFeatureGraph),function(sample,index){return _c('rect',{key:index,staticClass:\"sample\",attrs:{\"stroke\":\"black\",\"stroke-width\":\".5\",\"rx\":\"5\",\"x\":index * _vm.sampleWidth - _vm.sampleWidth / 2,\"width\":_vm.sampleWidth,\"height\":_vm.sampleWidth * 2,\"fill\":_vm.color(sample.mdsFeature)}})})],2):_vm._e()]),_c('v-row',[_vm._l((_vm.timbreSlider),function(sliderValue,index){return _c('v-col',{key:index,attrs:{\"align\":\"center\"}},[_c('v-img',{staticClass:\"timbreImage pa-0 ma-0\",attrs:{\"max-width\":\"40\",\"src\":require((\"../../assets/timbres/\" + index + \".png\"))}}),_c('v-slider',{attrs:{\"dense\":\"\",\"disabled\":_vm.disabled[index],\"vertical\":\"\",\"thumb-label\":\"\",\"min\":\"-1\",\"max\":\"1\",\"step\":\"0.05\",\"color\":\"dark\",\"track-color\":\"dark\",\"thumb-color\":_vm.disabled[index] ? '#414141' : 'primary'},on:{\"click\":function($event){return _vm.click($event, index)},\"mousedown\":function($event){_vm.mousedown = true},\"mouseup\":function($event){_vm.mousedown = false}},model:{value:(_vm.timbreSlider[index]),callback:function ($$v) {_vm.$set(_vm.timbreSlider, index, $$v)},expression:\"timbreSlider[index]\"}}),_c('v-btn',{attrs:{\"small\":\"\",\"icon\":\"\",\"color\":_vm.solod[index] ? 'primary' : '#414141'},on:{\"click\":function($event){return _vm.solo(index)}}},[_c('v-icon',[_vm._v(\"mdi-headphones\")])],1),_c('v-btn',{attrs:{\"small\":\"\",\"icon\":\"\",\"color\":_vm.muted[index] ? 'primary' : '#414141'},on:{\"click\":function($event){return _vm.mute(index)}}},[_c('v-icon',[_vm._v(\"mdi-volume-off\")])],1)],1)}),_c('v-col',[_c('v-btn',{attrs:{\"icon\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.resetSliders()}}},[_c('v-icon',[_vm._v(\"mdi-cached\")])],1),_c('v-btn',{attrs:{\"icon\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.setPreset(_vm.presets.test)}}},[_c('v-icon',[_vm._v(\"mdi-eye\")])],1),_c('v-btn',{attrs:{\"icon\":\"\",\"color\":\"primary\"},on:{\"click\":function($event){return _vm.setPreset(_vm.presets.all)}}},[_c('v-icon',[_vm._v(\"mdi-arrow-up-bold\")])],1)],1)],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"py-5\">\n        <Seeker\n            class=\"seeker\"\n            :ref=\"'holisticSeeker'\"\n            :width=\"width\"\n            :height=\"height\"\n            :color=\"'rgb(255,255,255,0.5)'\"\n        />\n        <svg class=\"timbreGraphSVG\" :width=\"width\" :height=\"height\">\n            <defs>\n                <linearGradient id=\"pathGradient\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"1\">\n                    <stop\n                        v-for=\"gradientStep in gradientSteps\"\n                        :key=\"gradientStep\"\n                        :offset=\"`${gradientStep}`\"\n                        :style=\"`stop-color:${color(1 - gradientStep)};stop-opacity:1`\"\n                    />\n                </linearGradient>\n            </defs>\n            <rect\n                class=\"timbreGraphBackground\"\n                :width=\"width\"\n                :height=\"height\"\n                opacity=\"0\"\n                @click=\"clickBackground($event)\"\n            ></rect>\n            <path\n                v-if=\"timbreFeatureGraph && showPath\"\n                fill=\"none\"\n                :stroke=\"showPathGradient ? 'url(#pathGradient)' : 'white'\"\n                :opacity=\"showPathGradient ? '1' : '0.2'\"\n                stroke-width=\"2\"\n                stroke-linejoin=\"round\"\n                :d=\"timbreFeatureGraphPath\"\n                class=\"timbreGraph\"\n            />\n            <g v-if=\"showPoints\">\n                <rect\n                    v-for=\"(sample, index) in timbreFeatureGraph\"\n                    :key=\"index\"\n                    class=\"sample\"\n                    stroke=\"black\"\n                    stroke-width=\".5\"\n                    rx=\"5\"\n                    :x=\"index * sampleWidth - sampleWidth / 2\"\n                    :y=\"height - sampleWidth * 2 - sample.mdsFeature * (height - sampleWidth * 2)\"\n                    :width=\"sampleWidth\"\n                    :height=\"sampleWidth * 2\"\n                    :fill=\"color(sample.mdsFeature)\"\n                ></rect>\n                <rect\n                    v-for=\"(sample, index) in timbreFeatureGraph\"\n                    :key=\"index\"\n                    class=\"sample\"\n                    stroke=\"black\"\n                    stroke-width=\".5\"\n                    rx=\"5\"\n                    :x=\"index * sampleWidth - sampleWidth / 2\"\n                    :width=\"sampleWidth\"\n                    :height=\"sampleWidth * 2\"\n                    :fill=\"color(sample.mdsFeature)\"\n                ></rect>\n            </g>\n        </svg>\n        <v-row>\n            <v-col align=\"center\" v-for=\"(sliderValue, index) in timbreSlider\" :key=\"index\">\n                <v-img\n                    class=\"timbreImage pa-0 ma-0\"\n                    max-width=\"40\"\n                    :src=\"require(`../../assets/timbres/${index}.png`)\"\n                ></v-img>\n                <v-slider\n                    dense\n                    :disabled=\"disabled[index]\"\n                    v-model=\"timbreSlider[index]\"\n                    vertical\n                    thumb-label\n                    min=\"-1\"\n                    max=\"1\"\n                    step=\"0.05\"\n                    color=\"dark\"\n                    track-color=\"dark\"\n                    :thumb-color=\"disabled[index] ? '#414141' : 'primary'\"\n                    @click=\"click($event, index)\"\n                    @mousedown=\"mousedown = true\"\n                    @mouseup=\"mousedown = false\"\n                ></v-slider>\n\n                <v-btn small icon :color=\"solod[index] ? 'primary' : '#414141'\" @click=\"solo(index)\">\n                    <v-icon>mdi-headphones</v-icon>\n                </v-btn>\n                <v-btn small icon :color=\"muted[index] ? 'primary' : '#414141'\" @click=\"mute(index)\">\n                    <v-icon>mdi-volume-off</v-icon>\n                </v-btn>\n            </v-col>\n            <v-col>\n                <v-btn icon color=\"primary\" @click=\"resetSliders()\">\n                    <v-icon>mdi-cached</v-icon>\n                </v-btn>\n                <v-btn icon color=\"primary\" @click=\"setPreset(presets.test)\">\n                    <v-icon>mdi-eye</v-icon>\n                </v-btn>\n                <v-btn icon color=\"primary\" @click=\"setPreset(presets.all)\">\n                    <v-icon>mdi-arrow-up-bold</v-icon>\n                </v-btn>\n            </v-col>\n        </v-row>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../../dev/log\";\nimport * as vis from \"../../app/vis\";\nimport Seeker from \"./Seeker\";\nimport Section from \"./Section\";\nimport * as d3 from \"d3\";\n\nimport * as testing from \"../../app/testing\";\nimport ZoomCanvas from \"../../app/visualization/ZoomCanvas\";\nimport * as player from \"../../app/player\";\nimport Vue from \"vue\";\nimport { updateTimbreGraphVis } from \"../../app/workers/workers\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            timbreSlider: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            presets: {\n                all: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],\n                bass: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                test: [0.5, 1, -0.3, 0.4, 0.1, -0.8, 0.7, 0.2, 0.1, -0.1, 0.75, -0.75],\n            },\n            disabled: [false, false, false, false, false, false, false, false, false, false, false, false],\n            solod: [false, false, false, false, false, false, false, false, false, false, false, false],\n            muted: [false, false, false, false, false, false, false, false, false, false, false, false],\n            clicks: 0,\n            timer: null,\n            mousedown: false,\n            showPoints: false,\n            gradientStepAmount: 8,\n            showPathGradient: true,\n            showPath: true,\n        };\n    },\n    computed: {\n        height() {\n            return 100;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        scale() {\n            return this.width / this.track.getAnalysisDuration();\n        },\n        timbreFeatureGraph() {\n            return this.track ? this.track.timbreFeatureGraph : null;\n        },\n        sampleAmount() {\n            return this.timbreFeatureGraph.length;\n        },\n        sampleWidth() {\n            return this.width / this.sampleAmount;\n        },\n        timbreFeatureGraphPath() {\n            let path = `M 0 ${this.timbreFeatureGraph[0].mdsFeature * this.height}`;\n            for (let i = 1; i < this.sampleAmount; i++) {\n                path = path.concat(\n                    ` L ${i * this.sampleWidth} ${this.height - this.timbreFeatureGraph[i].mdsFeature * this.height}`\n                );\n            }\n\n            return path;\n        },\n        gradientSteps() {\n            let steps = [];\n            for (let i = 0; i < this.gradientStepAmount; i++) {\n                steps.push(i / this.gradientStepAmount);\n            }\n            return steps;\n        },\n    },\n    watch: {\n        timbreSlider: {\n            deep: true,\n\n            handler() {\n                if (!this.mousedown) {\n                    this.sendUpdate();\n                }\n            },\n        },\n        track() {\n            this.sendUpdate();\n        },\n    },\n    mounted() {\n        const self = this;\n        window.eventBus.$on(\"featuresProcessed\", () => {\n            self.sendUpdate();\n        });\n    },\n    methods: {\n        setPreset(preset) {\n            this.timbreSlider = preset;\n        },\n        resetSliders() {\n            this.timbreSlider = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        },\n        click(event, index) {\n            this.clicks++;\n            if (this.clicks === 1) {\n                var self = this;\n                this.timer = setTimeout(() => {\n                    self.clicks = 0;\n                }, 300);\n            } else {\n                clearTimeout(this.timer);\n                Vue.set(this.timbreSlider, index, 0);\n                this.clicks = 0;\n            }\n        },\n        clickBackground(event) {\n            this.$refs[\"holisticSeeker\"].clickedSVG(event);\n        },\n        solo(index) {\n            Vue.set(this.solod, index, !this.solod[index]);\n            if (this.solod[index]) {\n                Vue.set(this.muted, index, false);\n            }\n            this.updateDisabled();\n        },\n        mute(index) {\n            Vue.set(this.muted, index, !this.muted[index]);\n            if (this.muted[index]) {\n                Vue.set(this.solod, index, false);\n            }\n            this.updateDisabled();\n        },\n        updateDisabled() {\n            const thereIsASolodSlider = this.solod.some((val) => val);\n            this.disabled.forEach((slider, index) => {\n                if (thereIsASolodSlider) {\n                    Vue.set(this.disabled, index, !this.solod[index]);\n                } else {\n                    Vue.set(this.disabled, index, this.muted[index]);\n                }\n            });\n            this.sendUpdate();\n        },\n        getSliderValues() {\n            const slidersWithDisabled = [];\n            this.timbreSlider.forEach((value, index) => {\n                slidersWithDisabled.push(this.disabled[index] ? 0 : value);\n            });\n            return slidersWithDisabled;\n        },\n        sendUpdate() {\n            if (!this.track.updatingTimbreVis) {\n                this.track.updateTimbreVis(this.getSliderValues());\n            }\n        },\n        color(mdsFeature) {\n            return vis.sinebowColorNormalizedRadius(mdsFeature, 1, 1);\n        },\n        color2D(coord) {},\n    },\n};\n</script>\n\n<style scoped>\n.timbreSVG {\n}\n.seeker {\n    pointer-events: none;\n}\n.timbreGraph {\n    transition: all 0.3s;\n}\n.sample {\n    transition: all 0.3s;\n}\n.sample:hover {\n    fill: white !important;\n    cursor: pointer;\n}\n.timbreImage {\n    /*filter: sepia(100%) saturate(250%) hue-rotate(80deg) contrast(80%);*/\n    filter: brightness(1.1) contrast(80%);\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreGraph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreGraph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./TimbreGraph.vue?vue&type=template&id=18dc8330&scoped=true&\"\nimport script from \"./TimbreGraph.vue?vue&type=script&lang=js&\"\nexport * from \"./TimbreGraph.vue?vue&type=script&lang=js&\"\nimport style0 from \"./TimbreGraph.vue?vue&type=style&index=0&id=18dc8330&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"18dc8330\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VImg } from 'vuetify/lib/components/VImg';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSlider } from 'vuetify/lib/components/VSlider';\ninstallComponents(component, {VBtn,VCol,VIcon,VImg,VRow,VSlider})\n","<template>\n    <div class=\"visualization\">\n        <div>\n            <v-row class=\"d-flex justify-center py-2\"> </v-row>\n            <div v-if=\"showPrototype\">\n                <!--<Matrixes :width=\"width\" />-->\n                <!--<Structure :width=\"width\" />-->\n                <GroundTruth :width=\"width\" />\n                <Graphs :width=\"width\" />\n\n                <!--<Beats :width=\"width\" />-->\n                <PitchTimbre :width=\"width\" />\n                <!--<ScapePlot :width=\"width\" />-->\n            </div>\n\n            <div v-if=\"!showPrototype\">\n                <div style=\"height: 5px\"></div>\n\n                <svg\n                    v-if=\"!loadingTrack && tsneReady\"\n                    class=\"tsneContainer\"\n                    :style=\"`height: ${tsneSize + 5 * 20}px; width: ${width}px; left: ${10}`\"\n                >\n                    <line\n                        v-for=\"index in tsneCoords.length - 2\"\n                        :key=\"index + 'clusterline'\"\n                        :x1=\"tsneCoordX(tsneCoords[index][0])\"\n                        :y1=\"tsneCoordY(tsneCoords[index][1])\"\n                        :x2=\"tsneCoordX(tsneCoords[index + 1][0])\"\n                        :y2=\"tsneCoordY(tsneCoords[index + 1][1])\"\n                        :stroke=\"clusterColor(clusters[index])\"\n                        style=\"stroke-opacity: .1;\"\n                        stroke-width=\"2\"\n                    />\n                    <circle\n                        v-for=\"(coord, index) in tsneCoords\"\n                        :key=\"index + 'clustercircle'\"\n                        :r=\"isPlayingSample(index) ? 5 + tsneDynamics(index) * 10 : 3 + tsneDynamics(index) * 5\"\n                        :cx=\"\n                            tsneCoordX(coord[0]) -\n                                (isPlayingSample(index) ? 5 + tsneDynamics(index) * 10 : 3 + tsneDynamics(index) * 5) /\n                                    2\n                        \"\n                        :cy=\"\n                            tsneCoordY(coord[1]) -\n                                (isPlayingSample(index) ? 5 + tsneDynamics(index) * 10 : 3 + tsneDynamics(index) * 5) /\n                                    2\n                        \"\n                        :class=\"isPlayingSample(index) ? 'segmentCirclePlaying' : 'segmentCircle'\"\n                        :fill=\"isPlayingSample(index) ? 'white' : clusterColor(clusters[index])\"\n                    />\n\n                    <circle\n                        :r=\"5 + tsneDynamics(playingSample) * 10\"\n                        :cx=\"tsneCoordX(tsneCoords[playingSample][0]) - (5 + tsneDynamics(playingSample) * 10) / 2\"\n                        :cy=\"tsneCoordY(tsneCoords[playingSample][1]) - (5 + tsneDynamics(playingSample) * 10) / 2\"\n                        :class=\"'playingSegmentCircle'\"\n                        :style=\"\n                            `transition:  cx ${track.features.sampleDuration}s linear, cy ${track.features.sampleDuration}s linear;`\n                        \"\n                        :fill=\"'white'\"\n                    />\n                    <rect\n                        v-for=\"(clusterSection, index) in clusterSections\"\n                        :key=\"index + 'clustersection'\"\n                        class=\"clusterRect\"\n                        :fill=\"clusterColor(clusterSection.cluster)\"\n                        :x=\"samplePosNormalized(clusterSection.start) * width\"\n                        :y=\"tsneSize + 20 * clusterSection.cluster\"\n                        :width=\"samplePosNormalized(clusterSection.end - clusterSection.start) * width\"\n                        :height=\"20\"\n                    ></rect>\n                    <rect\n                        class=\"seekerRect\"\n                        :x=\"seekerNormalized * width - 1.25\"\n                        :y=\"tsneSize\"\n                        :width=\"2.5\"\n                        :height=\"20 * 6\"\n                        fill=\"rgb(255,255,255,0.3)\"\n                    ></rect>\n                </svg>\n                <HolisticStructure :width=\"width\" />\n\n                <TimbreSegmentedGraph :width=\"width\" />\n\n                <!--<Tempo :width=\"width\" :height=\"70\" />-->\n\n                <Chords :width=\"width\" />\n                <div style=\"height: 50px\"></div>\n\n                <Tonality :width=\"width\" />\n\n                <div style=\"height: 400px\"></div>\n                <!--<TimbreStructure :width=\"width\" />\n                <TimbreGraph :width=\"width\" />-->\n            </div>\n        </div>\n\n        <!--<div class=\"floatingTime\">\n            {{ parseFloat(seekerTime).toFixed(2) }}\n        </div>-->\n    </div>\n</template>\n\n<script>\nimport Matrixes from \"./visualizations/Matrixes\";\nimport GroundTruth from \"./visualizations/GroundTruth\";\nimport Graphs from \"./visualizations/Graphs\";\nimport ScapePlot from \"./visualizations/ScapePlot\";\nimport Beats from \"./visualizations/Beats\";\nimport PitchTimbre from \"./visualizations/PitchTimbre\";\nimport Structure from \"./visualizations/Structure\";\nimport HolisticStructure from \"./visualizations/HolisticStructure\";\nimport TimbreStructure from \"./visualizations/TimbreStructure\";\nimport TimbreSegmentedGraph from \"./visualizations/TimbreSegmentedGraph\";\nimport Tonality from \"./visualizations/Tonality\";\nimport Chords from \"./visualizations/Chords\";\nimport Tempo from \"./visualizations/Tempo\";\n\nimport TimbreGraph from \"./visualizations/TimbreGraph\";\n\nimport * as log from \"../dev/log\";\nimport * as player from \"../app/player\";\nimport * as vis from \"../app/vis\";\nimport * as d3 from \"d3\";\n\nexport default {\n    props: [\"width\", \"showPrototype\"],\n    components: {\n        //Matrixes,\n        GroundTruth,\n        //Beats,\n        Graphs,\n        //ScapePlot,\n        PitchTimbre,\n        //Tempo,\n        //Structure,\n        HolisticStructure,\n        //TimbreGraph,\n        //TimbreStructure,\n        Chords,\n        TimbreSegmentedGraph,\n        Tonality,\n    },\n    data() {\n        return {\n            readyForPrototypeVis: false,\n            tsneReady: false,\n            tsneSize: this.width * 0.75,\n        };\n    },\n    watch: {\n        showPrototype() {\n            if (this.showPrototype && this.readyForPrototypeVis) {\n                setTimeout(() => window.eventBus.$emit(\"readyForPrototypeVis\"), 0);\n            }\n        },\n        track() {\n            this.readyForPrototypeVis = false;\n        },\n    },\n    computed: {\n        loadingTrack() {\n            return this.$store.state.loadingTrack;\n        },\n        seekerNormalized() {\n            return this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000);\n        },\n        seekerTime() {\n            return this.$store.getters.seeker / 1000;\n        },\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        height() {\n            return this.width;\n        },\n        zoomed() {\n            return this.$store.state.isZoomed;\n        },\n        playing() {\n            return this.$store.getters.playing;\n        },\n        tsneCoords() {\n            return this.track.tsneCoords;\n        },\n        clusters() {\n            return this.track.clusters;\n        },\n        clusterSections() {\n            return this.track.clusterSections;\n        },\n        playingSample() {\n            return Math.ceil(this.seekerTime / this.track.features.sampleDuration);\n        },\n    },\n    mounted() {\n        window.eventBus.$on(\"readyForPrototypeVis\", () => {\n            this.readyForPrototypeVis = true;\n        });\n        window.eventBus.$on(\"tsneReady\", () => {\n            this.tsneReady = true;\n        });\n    },\n\n    methods: {\n        visChanged(newVis, oldVis) {},\n        clusterColor(index) {\n            return vis.goldenRatioCategoricalColor(index, 0, 1);\n        },\n        isPlayingSample(index) {\n            return (\n                index <= this.seekerTime / this.track.features.sampleDuration &&\n                index + 1 > this.seekerTime / this.track.features.sampleDuration\n            );\n        },\n        samplePosNormalized(sample) {\n            return (sample * this.track.features.sampleDuration) / this.track.getAnalysisDuration();\n        },\n        tsneCoord(x, y) {\n            return [this.tsneCoordX(x), this.tsneCoordY(y)];\n        },\n        tsneCoordX(x) {\n            return this.width / 2 + (x * this.tsneSize) / 2;\n        },\n        tsneCoordY(y) {\n            return 80 + ((y + 1) * this.tsneSize) / 2;\n        },\n        tsneDynamics(index) {\n            const fraction = index / this.tsneCoords.length;\n            return this.track.features.directLoudness[Math.floor(this.track.features.directLoudness.length * fraction)];\n        },\n    },\n};\n</script>\n\n<style>\n.seekerSVGWrapper {\n    position: relative;\n}\n.seekerSVG {\n    position: absolute;\n    z-index: 10;\n}\n.floatingTime {\n    position: fixed;\n    z-index: 1000;\n    right: 5px;\n    bottom: 0%;\n}\n.segmentCircle {\n    transition: r 1.5s ease-out, fill 1.5s ease-out, cx 0.5s, cy 0.5s; /*, cx 1s ease, cy 1s ease;*/\n}\n.playingSegmentCircle {\n}\n.segmentCirclePlaying {\n    transition: r 0.1s ease-in, fill 0.1s ease-in;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Visualization.vue?vue&type=template&id=619248c8&\"\nimport script from \"./Visualization.vue?vue&type=script&lang=js&\"\nexport * from \"./Visualization.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Visualization.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VRow})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"player\"},[_c('div',{staticClass:\"d-flex justify-center pa-4\"},[(_vm.playerReady)?_c('div',[_c('v-hover',{scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar hover = ref.hover;\nreturn [_c('v-btn',{attrs:{\"elevation\":hover ? 5 : 0,\"outlined\":\"\",\"fab\":\"\"},on:{\"click\":_vm.playPause}},[_c('v-icon',{attrs:{\"large\":\"\"}},[_vm._v(\"mdi-\"+_vm._s(_vm.playing ? \"pause\" : \"play\"))])],1)]}}],null,false,2208235142)})],1):_vm._e(),(!_vm.playerReady)?_c('div',[_c('v-progress-circular',{attrs:{\"indeterminate\":\"\",\"size\":\"56\"}})],1):_vm._e()]),(_vm.doDrawWaveform)?_c('div',[_c('Seeker',{ref:'holisticSeeker',staticClass:\"seeker\",attrs:{\"width\":_vm.width,\"height\":_vm.height + _vm.markerLabelHeight,\"color\":'rgb(255,255,255,1)',\"markerOpacity\":1,\"showMarkerLabel\":\"\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.loadingTrack),expression:\"!loadingTrack\"}],staticClass:\"waveformWrapper\",on:{\"click\":_vm.clickedWaveform}},[_c('canvas',{staticClass:\"waveform pa-0 ma-0\",attrs:{\"id\":\"waveform\",\"height\":_vm.height + _vm.markerLabelHeight}}),(false && !_vm.loadingTrack)?_c('svg',{staticClass:\"seekerSVG\",style:((\"transform: translate(\" + (-_vm.width) + \"px, 0px);\")),attrs:{\"height\":_vm.height,\"width\":_vm.width}},[_c('rect',{staticClass:\"darkenWaveform\",attrs:{\"x\":0,\"y\":0,\"width\":_vm.seekerNormalized * _vm.width,\"height\":_vm.height,\"fill\":'#121212'}}),_c('rect',{attrs:{\"x\":_vm.seekerNormalized * _vm.width - 1.25,\"y\":0,\"width\":2.5,\"height\":_vm.height,\"fill\":\"#1DB954\"}})]):_vm._e()]),(_vm.loadingTrack)?_c('div',[_c('v-progress-linear',{attrs:{\"indeterminate\":\"\",\"color\":\"success\"}})],1):_vm._e()],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"player\">\n        <!-- Play Button -->\n        <div class=\"d-flex justify-center pa-4\">\n            <div v-if=\"playerReady\">\n                <v-hover v-slot:default=\"{ hover }\">\n                    <v-btn :elevation=\"hover ? 5 : 0\" outlined fab @click=\"playPause\">\n                        <v-icon large>mdi-{{ playing ? \"pause\" : \"play\" }}</v-icon>\n                    </v-btn>\n                </v-hover>\n            </div>\n            <div v-if=\"!playerReady\">\n                <v-progress-circular indeterminate size=\"56\"></v-progress-circular>\n            </div>\n        </div>\n\n        <!-- Waveform -->\n        <div v-if=\"doDrawWaveform\">\n            <Seeker\n                class=\"seeker\"\n                :ref=\"'holisticSeeker'\"\n                :width=\"width\"\n                :height=\"height + markerLabelHeight\"\n                :color=\"'rgb(255,255,255,1)'\"\n                :markerOpacity=\"1\"\n                showMarkerLabel\n            />\n            <div v-show=\"!loadingTrack\" class=\"waveformWrapper\" @click=\"clickedWaveform\">\n                <canvas id=\"waveform\" :height=\"height + markerLabelHeight\" class=\"waveform pa-0 ma-0\"></canvas>\n                <svg\n                    v-if=\"false && !loadingTrack\"\n                    :height=\"height\"\n                    :width=\"width\"\n                    class=\"seekerSVG\"\n                    :style=\"`transform: translate(${-width}px, 0px);`\"\n                >\n                    <rect\n                        :x=\"0\"\n                        :y=\"0\"\n                        :width=\"seekerNormalized * width\"\n                        :height=\"height\"\n                        :fill=\"'#121212'\"\n                        class=\"darkenWaveform\"\n                    ></rect>\n                    <rect\n                        :x=\"seekerNormalized * width - 1.25\"\n                        :y=\"0\"\n                        :width=\"2.5\"\n                        :height=\"height\"\n                        fill=\"#1DB954\"\n                    ></rect>\n                </svg>\n            </div>\n            <div v-if=\"loadingTrack\">\n                <v-progress-linear indeterminate color=\"success\"></v-progress-linear>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport * as log from \"../dev/log\";\nimport * as player from \"../app/player\";\nimport * as auth from \"../app/authentication\";\nimport * as vis from \"../app/vis\";\nimport Seeker from \"./visualizations/Seeker\";\n\nexport default {\n    props: [\"width\"],\n    components: {\n        Seeker,\n    },\n    data() {\n        return {\n            markerLabelHeight: 15,\n            height: 50,\n            canvas: null,\n            ctx: null,\n            doDrawWaveform: false,\n        };\n    },\n    computed: {\n        track() {\n            return this.$store.getters.selectedTrack;\n        },\n        loadingTrack() {\n            return this.$store.state.loadingTrack;\n        },\n        playing() {\n            return this.$store.getters.playing;\n        },\n        seekerNormalized() {\n            return this.$store.getters.seeker / (this.track.getAnalysisDuration() * 1000);\n        },\n        playerReady() {\n            return this.$store.getters.playerReady;\n        },\n    },\n    watch: {\n        width() {\n            this.setupCanvas();\n            this.drawWaveform();\n        },\n        loadingTrack(loading) {\n            if (!loading) {\n                this.drawWaveform();\n                if (this.playerReady) {\n                    this.loadTrackToPlayer();\n                }\n            }\n        },\n        playerReady(ready) {\n            if (ready && !this.loadingTrack) {\n                this.loadTrackToPlayer();\n            }\n        },\n    },\n    beforeCreate() {\n        player.initialize(auth.token);\n    },\n    mounted() {\n        this.setupCanvas();\n    },\n    methods: {\n        setupCanvas() {\n            this.canvas = document.getElementById(\"waveform\");\n            if (!this.canvas) {\n                log.warn(\"canvas not ready: \");\n                return;\n            }\n            this.canvas.width = this.width;\n            this.ctx = this.canvas.getContext(\"2d\");\n        },\n        loadTrackToPlayer() {\n            player.loadTrack(this.track);\n        },\n        drawWaveform() {\n            if (!this.canvas) {\n                log.error(\"Can't draw waveform; canvas is not created\");\n                return;\n            }\n            if (!this.ctx) {\n                log.error(\"Can't draw waveform; canvas context is not created\");\n                return;\n            }\n            this.ctx.clearRect(0, 0, this.width, this.height + this.markerLabelHeight);\n            vis.renderWaveform(this.ctx, 0, this.markerLabelHeight, this.width, this.height, this.track);\n        },\n        playPause() {\n            this.playing ? player.pause() : player.resume();\n        },\n        clickedWaveform(event) {\n            let xNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n            } else {\n                xNormalized = event.offsetX / this.width;\n            }\n            player.seekS(xNormalized * this.track.getAnalysisDuration());\n        },\n        rightClick(event) {\n            let xNormalized = 0;\n            if (this.$store.state.browser === \"Firefox\") {\n                xNormalized = event.layerX / this.width;\n            } else {\n                xNormalized = event.offsetX / this.width;\n            }\n            this.track.placeMarker(xNormalized * this.track.getAnalysisDuration());\n        },\n    },\n};\n</script>\n\n<style scoped>\n.player {\n    height: 100%;\n}\n.waveFormWrapper {\n    position: relative;\n    color: white;\n}\n\n.waveform {\n    z-index: 1;\n}\n.darkenWaveform {\n    background: #121212;\n    z-index: 5;\n    opacity: 0.5;\n}\n.seekerSVG {\n    position: absolute;\n    z-index: 10;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Player.vue?vue&type=template&id=6f3d8e16&scoped=true&\"\nimport script from \"./Player.vue?vue&type=script&lang=js&\"\nexport * from \"./Player.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Player.vue?vue&type=style&index=0&id=6f3d8e16&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6f3d8e16\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VHover } from 'vuetify/lib/components/VHover';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VProgressLinear } from 'vuetify/lib/components/VProgressLinear';\ninstallComponents(component, {VBtn,VHover,VIcon,VProgressCircular,VProgressLinear})\n","<template>\n    <div class=\"track\">\n        <v-app-bar dark>\n            <v-toolbar-title>Music Structure Visualizer</v-toolbar-title>\n            <v-spacer></v-spacer>\n\n            <form v-if=\"!testing && !synthesizing\" v-on:submit.prevent=\"search\">\n                <v-text-field\n                    v-model=\"searchQuery\"\n                    label=\"Search for songs\"\n                    hide-details\n                    append-icon=\"mdi-magnify\"\n                    single-line\n                    rounded\n                    dense\n                    filled\n                    @focus=\"$store.commit('setInputFocus', true)\"\n                    @blur=\"$store.commit('setInputFocus', false)\"\n                ></v-text-field>\n            </form>\n            <!--<form v-if=\"testing && !synthesizing\">\n                <v-select\n                    v-model=\"selectedTestSet\"\n                    :items=\"allTestSets\"\n                    return-object\n                    hide-details\n                    single-line\n                    rounded\n                    dense\n                    filled\n                ></v-select>\n            </form>\n            <form v-if=\"synthesizing\" v-on:submit.prevent=\"synthesize\">\n                <v-text-field v-model=\"synthesizerString\" hide-details single-line rounded dense filled></v-text-field>\n            </form>\n            <v-btn v-if=\"!synthesizing\" icon @click=\"testing = !testing\">\n                <v-icon>mdi-ab-testing</v-icon>\n            </v-btn>\n            <v-btn icon @click=\"synthesizing = !synthesizing\">\n                <v-icon>mdi-pencil</v-icon>\n            </v-btn>\n            -->\n            <v-spacer></v-spacer>\n            <!--\n            <v-btn icon @click=\"$store.commit('toggleZoomed')\">\n                <v-icon>mdi-magnify-plus-outline</v-icon>\n            </v-btn>\n            <v-btn icon @click=\"showPrototype = !showPrototype\">\n                <v-icon>{{ showPrototype ? \"mdi-monitor-eye\" : \"mdi-test-tube\" }}</v-icon>\n            </v-btn>\n            <v-btn icon @click=\"clickActivePlayer()\">\n                <v-icon>{{ activePlayer ? \"mdi-speaker\" : \"mdi-speaker-off\" }}</v-icon>\n            </v-btn>\n            -->\n            <div class=\"volumeSlider\">\n                <v-container>\n                    <v-slider\n                        @click:prepend=\"clickVolume\"\n                        :prepend-icon=\"getVolumeIcon()\"\n                        v-model=\"volume\"\n                        :min=\"0\"\n                        :max=\"1\"\n                        :step=\"0.02\"\n                    ></v-slider>\n                </v-container>\n            </div>\n            <v-btn icon @click=\"share()\">\n                <v-icon>mdi-share-variant</v-icon>\n            </v-btn>\n            <!--<v-btn icon>\n                <v-icon>mdi-heart</v-icon>\n            </v-btn>-->\n        </v-app-bar>\n        <TrackSelector v-if=\"!synthesizing\" :tracks=\"trackList\" :album-size=\"120\" />\n        <div ref=\"mainContent\" class=\"mainContent\" :style=\"mainContentStyle\">\n            <!--<v-btn v-for=\"(n, i) in 10\" :key=\"'colordiv' + i\" width=\"20\" height=\"20\" :color=\"color(i)\"></v-btn>-->\n            <Player v-if=\"!synthesizing\" :width=\"mainContentWidth\" />\n            <Visualization :width=\"mainContentWidth\" :showPrototype=\"showPrototype\" />\n            <v-btn class=\"readMore\" @click=\"readMore()\" style=\"color: #aaa\">\n                <v-icon style=\"margin-right: .5em\">mdi-book-information-variant</v-icon>\n                Read about this project\n            </v-btn>\n        </div>\n    </div>\n</template>\n\n<script>\nimport TrackSelector from \"../components/TrackSelector\";\nimport Visualization from \"../components/Visualization\";\nimport Player from \"../components/Player\";\nimport * as app from \"../app/app\";\nimport * as auth from \"../app/authentication\";\nimport * as player from \"../app/player\";\nimport * as testing from \"../app/testing\";\nimport * as vis from \"../app/vis\";\n\nimport * as log from \"../dev/log\";\nexport default {\n    name: \"Track\",\n    data() {\n        return {\n            searchQuery: \"\",\n            synthesizerString: \"\",\n            volume: 0.75,\n            prevVolume: 0.75,\n            windowWidth: window.innerWidth,\n            windowHeight: window.innerHeight,\n            testing: false,\n            synthesizing: false,\n            selectedTestSet: null,\n            showPrototype: false,\n            contentRatio: 0.97, //0.5 // 1.5\n        };\n    },\n    computed: {\n        user() {\n            return this.$store.getters.user;\n        },\n        trackList() {\n            return this.$store.getters.trackList;\n        },\n        selectedIndex() {\n            return this.$store.getters.selectedIndex;\n        },\n        selectedTrack() {\n            return this.$store.getters.selectedTrack;\n        },\n        seeker() {\n            return this.$store.getters.seeker;\n        },\n        playing() {\n            return this.$store.getters.playing;\n        },\n        mainContentStyle() {\n            return {\n                \"padding-left\": `${this.padding}px`,\n                \"padding-right\": `${this.padding}px`,\n            };\n        },\n        padding() {\n            return Math.round((this.windowWidth - this.mainContentWidth) / 2 / 4) * 4;\n        },\n        mainContentWidth() {\n            const size = Math.min(this.windowWidth, this.windowHeight) * this.contentRatio;\n            return size;\n        },\n        allTestSets() {\n            return testing.getAllTestSets();\n        },\n        activePlayer() {\n            return this.$store.getters.playerActive;\n        },\n    },\n    watch: {\n        selectedIndex(newIndex, oldIndex) {\n            //console.log(`We have ${newVal} selected!`)\n        },\n        selectedTrack(newTrack, oldTrack) {\n            log.info(`We have ${newTrack.getName()} selected!`);\n        },\n        selectedTestSet(newTestSet, oldTestSet) {\n            this.loadTestSet(newTestSet);\n        },\n        volume(newVol, oldVol) {\n            player.setVolume(Math.pow(this.volume, 2));\n        },\n        activePlayer() {\n            log.debug(\"Activeplayer Changed\", this.activePlayer);\n        },\n    },\n    components: {\n        TrackSelector,\n        Visualization,\n        Player,\n    },\n    beforeCreate() {\n        app.initialize();\n        window.addEventListener(\"resize\", () => {\n            this.windowWidth = window.innerWidth;\n        });\n    },\n    mounted() {\n        this._keyListener = function(e) {\n            if (e.key === \"z\" && (e.ctrlKey || e.metaKey)) {\n                e.preventDefault(); // present \"Save Page\" from getting triggered.\n\n                this.$store.commit(\"toggleZoomed\");\n            }\n            if (e.keyCode == 32 && !this.$store.getters.isInputFocused) {\n                e.preventDefault();\n                this.playing ? player.pause() : player.resume();\n            }\n        };\n        document.addEventListener(\"keydown\", this._keyListener.bind(this));\n    },\n    beforeDestroy() {\n        document.removeEventListener(\"keydown\", this._keyListener);\n    },\n    methods: {\n        color(i) {\n            return vis.goldenRatioCategoricalColor(i, 0, 1);\n        },\n        search() {\n            app.search(this.searchQuery);\n        },\n        loadTestSet() {\n            app.loadTestSet(this.selectedTestSet);\n        },\n        getVolumeIcon() {\n            if (this.volume > 0.6) return \"mdi-volume-high\";\n            if (this.volume > 0.2) return \"mdi-volume-medium\";\n            if (this.volume > 0) return \"mdi-volume-low\";\n            return \"mdi-volume-off\";\n        },\n        clickVolume() {\n            if (this.volume > 0) {\n                this.prevVolume = this.volume;\n                this.volume = 0;\n            } else {\n                this.volume = this.prevVolume;\n            }\n        },\n        synthesize() {\n            log.debug(\"Synthesizing\", this.synthesizerString);\n\n            app.synthesize(this.synthesizerString);\n        },\n        clickActivePlayer() {\n            if (this.activePlayer) {\n                player.releasePlayback();\n            } else {\n                player.transferPlayback();\n            }\n        },\n        readMore() {\n            Object.assign(document.createElement(\"a\"), {\n                target: \"_blank\",\n                href: \"http://jobsavelsberg.com/musicstructure/\",\n            }).click();\n        },\n    },\n};\n</script>\n\n<style>\n.track {\n    overflow: hidden; /* Hide scrollbars */\n}\n.mainContent {\n    display: inline-block;\n    overflow: hidden;\n}\n.volumeSlider {\n    height: 100%;\n    width: 150px;\n}\n.trackScroll {\n    /*overflow-x: auto;*/\n}\n.trackScroll::-webkit-scrollbar {\n    display: none;\n}\n.readMore {\n    position: fixed;\n    z-index: 1000;\n    right: 0px;\n    bottom: 0%;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Track.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Track.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Track.vue?vue&type=template&id=74e420fc&\"\nimport script from \"./Track.vue?vue&type=script&lang=js&\"\nexport * from \"./Track.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Track.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAppBar } from 'vuetify/lib/components/VAppBar';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VSlider } from 'vuetify/lib/components/VSlider';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VToolbarTitle } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VAppBar,VBtn,VContainer,VIcon,VSlider,VSpacer,VTextField,VToolbarTitle})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"callback\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"callback\"></div>\n</template>\n\n<script>\nimport { requestFirstToken } from \"../app/authentication\";\n\nexport default {\n    name: \"Callback\",\n    components: {},\n    beforeCreate() {\n        let params = new URLSearchParams(window.location.search);\n        let code = params.get(\"code\");\n        requestFirstToken(code).then(() => {\n            const trackId = window.localStorage.getItem(\"trackId\");\n            console.log(\"loading\", trackId);\n            this.$router.push(`/track/${trackId}`);\n        });\n    },\n};\n</script>\n\n<style>\n.callback {\n    height: 100%;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callback.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Callback.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Callback.vue?vue&type=template&id=7142bb18&\"\nimport script from \"./Callback.vue?vue&type=script&lang=js&\"\nexport * from \"./Callback.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Callback.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_c('v-container',{attrs:{\"fill-height\":\"\"}},[_c('v-layout',{attrs:{\"align-center\":\"\"}},[_c('v-card',{staticClass:\"mx-auto elevation-15\"},[_c('v-card-title',{staticClass:\"justify-center\"},[_vm._v(\"Music Structure Visualizer\")]),_c('v-card-subtitle',{staticClass:\"text-center\"},[_vm._v(\" Visualize the structure of music in your own library! \")]),_c('v-card-text',{staticClass:\"text-center\"},[_vm._v(\" Logging in with spotify enables the app to play music using your spotify account. \")]),_c('v-card-actions',[_c('v-btn',{staticClass:\"mx-auto\",attrs:{\"color\":\"success\"},on:{\"click\":_vm.spotifyAuthorize}},[_vm._v(\"Log in with Spotify\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"login\">\n        <v-container fill-height>\n            <v-layout align-center>\n                <v-card class=\"mx-auto elevation-15\">\n                    <v-card-title class=\"justify-center\">Music Structure Visualizer</v-card-title>\n                    <v-card-subtitle class=\"text-center\">\n                        Visualize the structure of music in your own library!\n                    </v-card-subtitle>\n                    <v-card-text class=\"text-center\">\n                        Logging in with spotify enables the app to play music using your spotify account.\n                    </v-card-text>\n                    <v-card-actions>\n                        <v-btn class=\"mx-auto\" color=\"success\" @click=\"spotifyAuthorize\">Log in with Spotify</v-btn>\n                    </v-card-actions>\n                </v-card>\n            </v-layout>\n        </v-container>\n    </div>\n</template>\n\n<script>\n\nexport default {\n  name: 'Login',\n  components: {\n  },\n  methods: {\n      spotifyAuthorize () {\n          window.location.href= process.env.VUE_APP_HOST_URL + \"/api/spotify/login\"\n      }\n  }\n}\n</script>\n\n<style>\n.login{\n    height: 100%\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=2baefff0&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardSubtitle } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VLayout } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardSubtitle,VCardText,VCardTitle,VContainer,VLayout})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"landing\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"landing\"></div>\n</template>\n\n<script>\nexport default {\n    name: \"Landing\",\n    components: {},\n    methods: {},\n};\n</script>\n\n<style>\n.landing {\n    height: 100%;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Landing.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Landing.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Landing.vue?vue&type=template&id=627dde30&\"\nimport script from \"./Landing.vue?vue&type=script&lang=js&\"\nexport * from \"./Landing.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Landing.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport Track from \"../views/Track.vue\";\nimport Callback from \"../views/Callback.vue\";\nimport Login from \"../views/Login.vue\";\nimport Landing from \"../views/Landing.vue\";\nimport * as app from \"../app/app\";\nimport * as auth from \"../app/authentication\";\n\nVue.use(VueRouter);\n\nconst routes = [\n    {\n        path: \"/\",\n        name: \"Landing\",\n        component: Login,\n        beforeEnter(to, from, next) {\n            if (auth.isAuthorized()) {\n                next(\"/track/-1\");\n            } else {\n                next(\"/login\");\n            }\n        },\n    },\n    {\n        path: \"/login\",\n        name: \"Login\",\n        component: Login,\n    },\n    {\n        path: \"/track/:trackId\",\n        name: \"Track\",\n        component: Track,\n        beforeEnter(to, from, next) {\n            console.log(\"Prev stored trackid: \", window.localStorage.getItem(\"trackId\"));\n            if (to.params.trackId !== -1) {\n                window.localStorage.setItem(\"trackId\", to.params.trackId);\n            }\n            console.log(\"New stored trackid: \", window.localStorage.getItem(\"trackId\"));\n\n            if (auth.isAuthorized()) {\n                next();\n            } else {\n                next(\"/login\");\n            }\n        },\n    },\n    {\n        path: \"/callback\",\n        name: \"Callback\",\n        component: Callback,\n        beforeEnter(to, from, next) {\n            console.log(\"After callback trackid: \", window.localStorage.getItem(\"trackId\"));\n            next();\n        },\n    },\n];\n\nconst router = new VueRouter({\n    mode: \"history\",\n    base: process.env.BASE_URL,\n    routes,\n});\n\nexport default router;\n","import Vue from 'vue';\nimport Vuetify from 'vuetify/lib';\n\nVue.use(Vuetify);\n\nexport default new Vuetify({\n    theme: {\n        dark: true,\n        themes:{\n            // Spotify green = 1DB954\n            // Spotify black = 191414\n            light: {\n                primary: '#1DB954',//'#1976D2',\n                secondary: '#424242',\n                accent: '#82B1FF',\n                error: '#FF5252',\n                info: '#2196F3',\n                success: '#1DB954',//'#4CAF50',\n                warning: '#FFC107',\n            },\n            dark: {\n                primary: '#1DB954',//'#1976D2',\n                success: '#1DB954',//'#4CAF50',\n            }\n        }\n    }\n});\n","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport router from \"./router\";\nimport vuetify from \"./plugins/vuetify\";\nimport store from \"./store\";\n\nVue.config.productionTip = false;\n\nwindow.eventBus = new Vue();\n\nnew Vue({\n    router,\n    vuetify,\n    store,\n    render: (h) => h(App),\n}).$mount(\"#app\");\n\nstore.state.browser = () => {\n    // Opera 8.0+\n    // eslint-disable-next-line no-undef\n    var isOpera = (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(\" OPR/\") >= 0;\n\n    // Firefox 1.0+\n    var isFirefox = typeof InstallTrigger !== \"undefined\";\n\n    // Safari 3.0+ \"[object HTMLElementConstructor]\"\n    var isSafari =\n        /constructor/i.test(window.HTMLElement) ||\n        (function(p) {\n            return p.toString() === \"[object SafariRemoteNotification]\";\n            // eslint-disable-next-line no-undef\n        })(!window[\"safari\"] || (typeof safari !== \"undefined\" && safari.pushNotification));\n\n    // Internet Explorer 6-11\n    var isIE = /*@cc_on!@*/ false || !!document.documentMode;\n\n    // Edge 20+\n    var isEdge = !isIE && !!window.StyleMedia;\n\n    // Chrome 1 - 79\n    var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);\n\n    if (isChrome) return \"Chrome\";\n    if (isFirefox) return \"Firefox\";\n    if (isSafari) return \"Safari\";\n    if (isIE) return \"IE\";\n    if (isEdge) return \"Edge\";\n    if (isOpera) return \"Opera\";\n};\n","import assert from \"assert\";\nimport { NumberType, getNumberTypeByName } from \"./NumberType\";\nimport * as log from \"../../dev/log\";\nimport * as HalfMatrix from \"./HalfMatrix\";\nexport default class Matrix {\n    static get NumberType() {\n        return NumberType;\n    }\n\n    data;\n    width;\n    height;\n    featureAmount;\n    sampleDuration;\n    numberType;\n    length;\n\n    constructor(options) {\n        this.width = options.width || options.size;\n        this.height = options.height || options.size;\n\n        this.featureAmount = options.featureAmount || 1;\n        this.numberType = getNumberTypeByName(options.numberType) || NumberType.FLOAT32;\n        this.sampleDuration = options.sampleDuration || 1;\n        this.length = this.width * this.height * this.featureAmount;\n        if (options.buffer) {\n            this.data = new this.numberType.array(options.buffer);\n            assert(this.length === this.data.length);\n        } else {\n            this.data = new this.numberType.array(this.length);\n        }\n    }\n\n    static from(matrix, options) {\n        if (typeof matrix === HalfMatrix) return this.fromHalfMatrix(matrix);\n        if (!options) options = {};\n        const featureAmount = options.featureAmount || matrix.featureAmount;\n        const numberType = options.numberType || matrix.numberType;\n        const sampleDuration = options.sampleDuration || matrix.sampleDuration;\n        const width = matrix.width || matrix.size;\n        const height = matrix.height || matrix.size;\n        return new Matrix({ width: width, height: height, featureAmount, numberType, sampleDuration });\n    }\n\n    static fromHalfMatrix(halfMatrix) {\n        const matrix = new Matrix({\n            width: halfMatrix.size,\n            height: halfMatrix.size,\n            numberType: halfMatrix.numberType,\n            sampleDuration: halfMatrix.sampleDuration,\n        });\n        matrix.fill((x, y) => halfMatrix.getValueMirrored(x, y));\n        return matrix;\n    }\n\n    static createTimeLagMatrix(matrix) {\n        const size = matrix.size || matrix.width;\n        const timeLagMatrix = new Matrix(matrix);\n        timeLagMatrix.fill((n, lag) => {\n            const x = (n + lag) % size;\n            return matrix.getValueMirrored(x, n);\n        });\n        return timeLagMatrix;\n    }\n\n    static combine(halfMatrixLeft, halfMatrixRight) {\n        assert(halfMatrixLeft.size === halfMatrixRight.size);\n        assert(halfMatrixLeft.numberType === halfMatrixRight.numberType);\n        assert(halfMatrixLeft.sampleDuration === halfMatrixRight.sampleDuration);\n        const size = halfMatrixLeft.size;\n        const numberType = halfMatrixLeft.numberType;\n        const sampleDuration = halfMatrixLeft.sampleDuration;\n        const matrix = new Matrix({\n            width: size,\n            height: size,\n            numberType: numberType,\n            sampleDuration: sampleDuration,\n        });\n        matrix.fill((x, y) => {\n            if (x > y) {\n                return halfMatrixRight.getValueMirrored(x, y);\n            } else {\n                return halfMatrixLeft.getValue(x, y);\n            }\n        });\n        return matrix;\n    }\n\n    clone() {\n        const matrix = new Matrix({\n            height: this.height,\n            width: this.width,\n            numberType: this.numberType,\n            sampleDuration: this.sampleDuration,\n        });\n        matrix.fillByIndex((i) => this.data[i]);\n        return matrix;\n    }\n\n    hasCell(x, y) {\n        return x < this.width && y < this.height && x >= 0 && y >= 0;\n    }\n    setValue(x, y, value) {\n        this.data[(y * this.width + x) * this.featureAmount] = value;\n    }\n    getValueMirrored(x, y, f = 0) {\n        return this.getValue(x, y, f);\n    }\n    getValue(x, y, f = 0) {\n        return this.data[(y * this.width + x) * this.featureAmount + f];\n    }\n    getValues(x, y) {\n        const values = new this.numberType.array(this.featureAmount);\n        for (let f = 0; f < this.featureAmount; f++) {\n            values[f] = this.data[(y * this.width + x) * this.featureAmount + f];\n        }\n        return values;\n    }\n\n    getValuesNormalized(x, y) {\n        const values = new this.numberType.array(this.featureAmount);\n        for (let f = 0; f < this.featureAmount; f++) {\n            values[f] = this.data[(y * this.width + x) * this.featureAmount + f] / this.numberType.scale;\n        }\n        return values;\n    }\n    getValueNormalizedMirrored(x, y) {\n        return this.getValueNormalized(x, y);\n    }\n    getValueNormalized(x, y, f = 0) {\n        return this.data[(y * this.width + x) * this.featureAmount + f] / this.numberType.scale;\n    }\n\n    getColumnNormalized(x) {\n        const values = new Float32Array(this.height);\n        for (let y = 0; y < this.height; y++) {\n            values[y] = this.data[(y * this.width + x) * this.featureAmount] / this.numberType.scale;\n        }\n        return values;\n    }\n\n    fillByIndex(callback) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] = callback(i);\n        }\n    }\n\n    /**\n     *\n     * @param {*} callback dunction that returns number (compatible with DataType)\n     */\n    fill(callback) {\n        for (let y = 0; y < this.height; y++) {\n            for (let x = 0; x < this.width; x++) {\n                this.data[(y * this.width + x) * this.featureAmount] = callback(x, y);\n            }\n        }\n    }\n\n    fillFeatures(callback) {\n        for (let y = 0; y < this.height; y++) {\n            for (let x = 0; x < this.width; x++) {\n                for (let f = 0; f < this.featureAmount; f++) {\n                    this.data[(y * this.width + x) * this.featureAmount + f] = callback(x, y, f);\n                }\n            }\n        }\n    }\n\n    fillFeaturesNormalized(callback) {\n        for (let y = 0; y < this.height; y++) {\n            for (let x = 0; x < this.width; x++) {\n                for (let f = 0; f < this.featureAmount; f++) {\n                    this.data[(y * this.width + x) * this.featureAmount + f] =\n                        callback(x, y, f) * this.numberType.scale;\n                }\n            }\n        }\n    }\n\n    forEach(callback) {\n        let i = this.length;\n        while (i--) {\n            callback(this.data[i], i);\n        }\n    }\n\n    forEachCell(callback) {\n        for (let y = 0; y < this.height; y++) {\n            for (let x = 0; x < this.width; x++) {\n                callback(x, y, this.data[(y * this.width + x) * this.featureAmount]);\n            }\n        }\n    }\n    /**\n     * Expect normalized number [0,1] and stores this as number of specified type, with 1 being scaled to the number's max\n     * @param {*} callback function that returns number in range 0,1\n     */\n    fillNormalized(callback) {\n        for (let y = 0; y < this.heigth; y++) {\n            for (let x = 0; x < this.width; x++) {\n                this.data[(y * this.width + x) * this.featureAmount] = callback(x, y) * this.numberType.max;\n            }\n        }\n    }\n\n    map(callback) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] = callback(this.data[i]);\n        }\n    }\n\n    divide(number) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] /= number;\n        }\n    }\n    multiply(number) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] *= number;\n        }\n    }\n    add(number) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] += number;\n        }\n    }\n\n    getBuffer() {\n        return {\n            type: \"Matrix\",\n            buffer: this.data.buffer,\n            width: this.width,\n            height: this.height,\n            numberType: this.numberType.name,\n            featureAmount: this.featureAmount,\n            sampleDuration: this.sampleDuration,\n        };\n    }\n\n    getNewEmptyMatrix() {\n        return new Matrix(this);\n    }\n\n    getSize() {\n        assert(this.width === this.height);\n        return this.width;\n    }\n\n    getSampleAmount() {\n        return this.height;\n    }\n\n    getSampleDuration() {\n        return this.sampleDuration;\n    }\n\n    normalize() {\n        let min = this.numberType.max;\n        let max = this.numberType.min;\n        this.forEach((value) => {\n            if (value > max) {\n                max = value;\n            }\n            if (value < min) {\n                min = value;\n            }\n        });\n\n        let i = this.length;\n        while (i--) {\n            this.data[i] = (this.data[i] - min) / (max - min);\n        }\n    }\n\n    subtract(matrix) {}\n}\n","module.exports = __webpack_public_path__ + \"img/11.ed7b26ed.png\";","var map = {\n\t\"./0.png\": \"853a\",\n\t\"./1.png\": \"7e02\",\n\t\"./10.png\": \"6c0f\",\n\t\"./11.png\": \"5bfe\",\n\t\"./2.png\": \"4697\",\n\t\"./3.png\": \"4d8d\",\n\t\"./4.png\": \"f8fd\",\n\t\"./5.png\": \"beb4\",\n\t\"./6.png\": \"951a\",\n\t\"./7.png\": \"3dfa\",\n\t\"./8.png\": \"70ba\",\n\t\"./9.png\": \"e2a7\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"642b\";","module.exports = __webpack_public_path__ + \"img/10.98dc5d9d.png\";","module.exports = __webpack_public_path__ + \"img/8.6c4d10ae.png\";","module.exports = __webpack_public_path__ + \"js/7.53ce2983.worker.js\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PitchTimbre.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PitchTimbre.vue?vue&type=style&index=0&lang=css&\"","module.exports = __webpack_public_path__ + \"img/1.6abca8eb.png\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HolisticStructure.vue?vue&type=style&index=0&id=3a5bf7e5&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HolisticStructure.vue?vue&type=style&index=0&id=3a5bf7e5&scoped=true&lang=css&\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOkAAAClBAMAAABLg8fHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAhUExURWtra29vb3BwcHFxcXV1dW5ubnJycnh4eG1tbXZ2dmpqajXhPR4AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMzSURBVHja7dyxjhoxEAZgKOgZS+7xrEIdxYhXSIuR/AQnRcpjXN5kC6Q8Zjz2AssBF5r8f+FMeXB8eNc79o7NLpYaVFWcIiKIFG23WRzfVGOM+x+vRHwQj/96G+dPf4vfivb96+KXwuPnZrFSnwUabihqgKo+yXG7hqtZjsOBpJ6CF2y4YU1TcyaoDtvWkgp5qiXHTtSlCrg3SVXBedhZW981odUt/AiXA+tKRsSrWlUPV/FXjk/W1l5UV1VBRz2vaNRGulHLBKofFWp6cdHUL4INtzc1oNWtZcTgRDLw3LYxB66W+xy8Goo6lls7nFjGHO92LHWJVhNVhV6wZS6xpaiRoDoteXilAr1ei9rmEh2ovqngISfV8ZWjjvjZ2n7DGNV3eNVnF/FqSsJQRTiztYHSm+qYw1NBGbGM6WVy2I+q1ptO6Plw4KltjtiHekL2phqW/QnqnqcKNpwy6k0U1alVCNB1RHGM6iXpvIoqS11iVZ/q9YpWM0nVPXguYZEpqncMNVyzP3LMkUtvgqr1jgOtprqHwKohyEh1zIGrg1W5HDoT09RTYKgjWM3TlQNWc6pzf+wdR2srvGZKVMF1RN8qP4QZjLVV4KrV1iiqjerAnWumxm7Uup6Dr8C3Sm0Xak6MukQ+RorKqIVTVQFH3X0Dng3naScvQ/0doKyf2spRhaGuwH1Yp/schjqSVPAObRcIGbGp6DVJnfaF41XG+qtGxlozTwUfYZ8ZbZ3UE0cVp+Adn3H9X/3Hqp1X6GTCi059mKCuKOqI3XvpJbR7dbhax1esmqbfcQRcNcR2D/tEUKWqI1i1qjR+3pSm+jBQtbamqSrdhXpdbUC6Pal2XldYtSTi+tt8tJoY6nn9Fa26nlQ9kNQTeC6Rpe1bQ6u1okdQW0b00LUr2XanOvDPbqkqknQstV05Yvshn6XF2VOBgtx3u+kJTK+j5VPa3dU5zJhnDLuibx5GdPOYHBcuapDPngB139Yb1f57vmGvGk9UWzPW86vh02dOfTwi+rCtyb+k1irK+ds+b2mYfUY9viX9Hxbvg0KjyFYNCdfvGS4n/ENnmb9895L8NebvLAdJD38A8lDoBSbsCfgAAAAASUVORK5CYII=\"","module.exports = __webpack_public_path__ + \"js/6.ded26252.worker.js\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Album.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Album.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Visualization.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GraphSection.vue?vue&type=style&index=0&id=02a35072&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GraphSection.vue?vue&type=style&index=0&id=02a35072&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"img/6.332870e2.png\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markers.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markers.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreStructure.vue?vue&type=style&index=0&id=0141a4f1&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreStructure.vue?vue&type=style&index=0&id=0141a4f1&scoped=true&lang=css&\"","import assert from \"assert\";\nimport { NumberType, getNumberTypeByName } from \"./NumberType\";\nimport * as log from \"../../dev/log\";\nimport * as Matrix from \"./Matrix\";\nimport { drop } from \"lodash\";\nexport default class HalfMatrix {\n    static get NumberType() {\n        return NumberType;\n    }\n\n    data;\n    size;\n    featureAmount;\n    sampleDuration;\n    numberType;\n    length;\n\n    /**\n     *\n     * @param {*} size\n     * @param {*} shape array of nested array sizes eg, ssm with 2 values per cell [2]\n     * @param {*} type\n     */\n    constructor(options) {\n        this.size = options.size;\n        this.featureAmount = options.featureAmount || 1;\n        this.numberType = getNumberTypeByName(options.numberType) || NumberType.FLOAT32;\n        this.sampleDuration = options.sampleDuration || 1;\n        this.length = ((this.size * this.size + this.size) / 2) * this.featureAmount;\n        if (options.buffer) {\n            this.data = new this.numberType.array(options.buffer);\n            assert(this.length === this.data.length);\n        } else {\n            this.data = new this.numberType.array(this.length);\n        }\n    }\n\n    static from(matrix, options) {\n        if (typeof matrix === Matrix) {\n            return this.fromMatrix(matrix);\n        }\n        if (!options) options = {};\n        const featureAmount = options.featureAmount || matrix.featureAmount;\n        const numberType = options.numberType || matrix.numberType;\n        const sampleDuration = options.sampleDuration || matrix.sampleDuration;\n        return new HalfMatrix({ size: matrix.size, featureAmount, numberType, sampleDuration });\n    }\n\n    static fromMatrix(matrix) {\n        const halfMatrix = new HalfMatrix({\n            size: matrix.width,\n            numberType: matrix.numberType,\n            sampleDuration: matrix.sampleDuration,\n        });\n        halfMatrix.fill((x, y) => {\n            return matrix.getValue(x, y);\n        });\n        return halfMatrix;\n    }\n\n    clone() {\n        const halfMatrix = new HalfMatrix({\n            size: this.size,\n            numberType: this.numberType,\n            sampleDuration: this.sampleDuration,\n        });\n        halfMatrix.fillByIndex((i) => this.data[i]);\n        return halfMatrix;\n    }\n\n    getCellFromIndex(index) {}\n\n    hasCell(x, y) {\n        return x <= y && y < this.size && x >= 0 && y >= 0;\n    }\n    setValue(x, y, value) {\n        this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount] = value;\n    }\n    setValueNormalized(x, y, value) {\n        this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount] = value * this.numberType.scale;\n    }\n    setValueNormalizedMirrored(x, y, value) {\n        if (x > y) {\n            this.data[((x * x + x) / 2) * this.featureAmount + y * this.featureAmount] = value * this.numberType.scale;\n        } else {\n            this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount] = value * this.numberType.scale;\n        }\n    }\n    getValue(x, y, f = 0) {\n        return this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount + f];\n    }\n    getValues(x, y) {\n        const values = new this.numberType.array(this.featureAmount);\n        for (let o = 0; o < this.featureAmount; o++) {\n            values[o] = this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount + o];\n        }\n        return values;\n    }\n    getValueMirrored(x, y) {\n        if (x > y) {\n            return this.data[((x * x + x) / 2) * this.featureAmount + y * this.featureAmount];\n        } else {\n            return this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount];\n        }\n    }\n    getValuesNormalized(x, y) {\n        const values = new this.numberType.array(this.featureAmount);\n        for (let o = 0; o < this.featureAmount; o++) {\n            values[o] =\n                this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount + o] / this.numberType.scale;\n        }\n        return values;\n    }\n    getValueNormalizedMirrored(x, y) {\n        if (x > y) {\n            return this.data[((x * x + x) / 2) * this.featureAmount + y * this.featureAmount] / this.numberType.scale;\n        } else {\n            return this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount] / this.numberType.scale;\n        }\n    }\n    getValueNormalized(x, y, f = 0) {\n        return this.data[((y * y + y) / 2) * this.featureAmount + x * this.featureAmount + f] / this.numberType.scale;\n    }\n\n    getColumnNormalized(x) {\n        const values = new Float32Array(this.size);\n        for (let y = 0; y < this.size; y++) {\n            values[y] = this.getValueNormalizedMirrored(x, y);\n        }\n        return values;\n    }\n\n    fillByIndex(callback) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] = callback(i);\n        }\n    }\n\n    /**\n     *\n     * @param {*} callback dunction that returns number (compatible with DataType)\n     */\n    fill(callback) {\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = ((y * y + y) / 2) * this.featureAmount;\n            for (let x = 0; x < y + 1; x++) {\n                this.data[cellsBefore + x * this.featureAmount] = callback(x, y);\n            }\n        }\n    }\n\n    fillFeatures(callback) {\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = ((y * y + y) / 2) * this.featureAmount;\n            for (let x = 0; x < y + 1; x++) {\n                for (let f = 0; f < this.featureAmount; f++) {\n                    this.data[cellsBefore + x * this.featureAmount + f] = callback(x, y, f);\n                }\n            }\n        }\n    }\n    fillFeaturesNormalized(callback) {\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = ((y * y + y) / 2) * this.featureAmount;\n            for (let x = 0; x < y + 1; x++) {\n                for (let f = 0; f < this.featureAmount; f++) {\n                    this.data[cellsBefore + x * this.featureAmount + f] = callback(x, y, f) * this.numberType.scale;\n                }\n            }\n        }\n    }\n    forEach(callback) {\n        let i = this.length;\n        while (i--) {\n            callback(this.data[i], i);\n        }\n    }\n\n    forEachCell(callback) {\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = ((y * y + y) / 2) * this.featureAmount;\n\n            for (let x = 0; x < y + 1; x++) {\n                callback(x, y, this.data[cellsBefore + x]);\n            }\n        }\n    }\n\n    /**\n     * Expect normalized number [0,1] and stfores this as number of specified type, with 1 being scaled to the number's max\n     * @param {*} callback function that returns number in range 0,1\n     */\n    fillNormalized(callback) {\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = (y * y + y) / 2;\n            for (let x = 0; x < y + 1; x++) {\n                this.data[cellsBefore + x] = callback(x, y) * this.numberType.scale;\n            }\n        }\n    }\n\n    map(callback) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] = callback(this.data[i]);\n        }\n    }\n\n    divide(number) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] /= number;\n        }\n    }\n    multiply(number) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] *= number;\n        }\n    }\n    add(number) {\n        let i = this.length;\n        while (i--) {\n            this.data[i] += number;\n        }\n    }\n\n    getFirstFeatureMatrix() {\n        const matrix = new HalfMatrix(this);\n        matrix.fill((x, y) => {\n            return this.getValue(x, y);\n        });\n        return matrix;\n    }\n\n    getFeatureMatrix(featureIndex) {\n        const matrix = new HalfMatrix(this);\n        matrix.fill((x, y) => {\n            return this.getValue(x, y, featureIndex);\n        });\n        return matrix;\n    }\n\n    getBuffer() {\n        return {\n            type: \"HalfMatrix\",\n            buffer: this.data.buffer,\n            size: this.size,\n            numberType: this.numberType.name,\n            featureAmount: this.featureAmount,\n            sampleDuration: this.sampleDuration,\n        };\n    }\n\n    getSampleAmount() {\n        return this.size;\n    }\n\n    getSampleDuration() {\n        return this.sampleDuration;\n    }\n\n    getNestedArray() {\n        const nestedArray = new Array(this.size);\n        for (let y = 0; y < this.size; y++) {\n            nestedArray[y] = new Array(this.size);\n            for (let x = 0; x < this.size; x++) {\n                nestedArray[y][x] = this.getValueMirrored(x, y);\n            }\n        }\n\n        return nestedArray;\n    }\n\n    getNewEmptyMatrix() {\n        return new HalfMatrix(this);\n    }\n    getSize() {\n        return this.size;\n    }\n\n    normalize() {\n        let min = this.numberType.max;\n        let max = this.numberType.min;\n        this.forEach((value) => {\n            if (value > max) {\n                max = value;\n            }\n            if (value < min) {\n                min = value;\n            }\n        });\n\n        let i = this.length;\n        while (i--) {\n            this.data[i] = (this.data[i] - min) / (max - min);\n        }\n    }\n\n    getMeanAndStandardDeviation() {\n        if (this.featureAmount > 1) return 0;\n        let sum = 0;\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = ((y * y + y) / 2) * this.featureAmount;\n            for (let x = 0; x < y + 1; x++) {\n                sum += this.data[cellsBefore + x] / this.numberType.scale;\n            }\n        }\n        const mean = sum / this.data.length;\n        let meanSquared = 0;\n        for (let y = 0; y < this.size; y++) {\n            const cellsBefore = ((y * y + y) / 2) * this.featureAmount;\n            for (let x = 0; x < y + 1; x++) {\n                meanSquared += Math.pow(this.data[cellsBefore + x] / this.numberType.scale - mean, 2);\n            }\n        }\n        const sd = Math.sqrt(meanSquared / this.data.length);\n        return [mean, sd];\n    }\n\n    changeDistribution(deltaMean, deltaDeviation) {\n        const [mean, sd] = this.getMeanAndStandardDeviation();\n        let i = this.length;\n        while (i--) {\n            let val = this.data[i] / this.numberType.scale;\n            val -= mean;\n            val *= deltaDeviation;\n            val += mean + deltaMean;\n            val = Math.min(1, Math.max(0, val));\n            this.data[i] = val * this.numberType.scale;\n        }\n    }\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tempo.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tempo.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=style&index=0&id=e00e0bc0&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=style&index=0&id=e00e0bc0&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"js/9.6532a5b8.worker.js\"","import * as log from \"../../dev/log\";\n\nexport const NumberType = Object.freeze({\n    UINT8: { name: \"UINT8\", max: Math.pow(2, 8) - 1, min: 0, scale: Math.pow(2, 8) - 1, array: Uint8Array },\n    UINT16: { name: \"UINT16\", max: Math.pow(2, 16) - 1, min: 0, scale: Math.pow(2, 16) - 1, array: Uint16Array },\n    UINT32: { name: \"UINT32\", max: Math.pow(2, 32) - 1, min: 0, scale: Math.pow(2, 32) - 1, array: Uint32Array },\n    INT8: { name: \"INT8\", max: Math.pow(2, 7) - 1, min: -Math.pow(2, 7), scale: Math.pow(2, 7) - 1, array: Int8Array },\n    INT16: {\n        name: \"INT16\",\n        max: Math.pow(2, 15) - 1,\n        min: -Math.pow(2, 15),\n        scale: Math.pow(2, 15) - 1,\n        array: Int16Array,\n    },\n    INT32: {\n        name: \"INT32\",\n        max: Math.pow(2, 31) - 1,\n        min: -Math.pow(2, 31),\n        scale: Math.pow(2, 31) - 1,\n        array: Int32Array,\n    },\n    FLOAT32: {\n        name: \"FLOAT32\",\n        max: Number.POSITIVE_INFINITY,\n        min: Number.NEGATIVE_INFINITY,\n        scale: 1,\n        array: Float32Array,\n    },\n    FLOAT64: {\n        name: \"FLOAT64\",\n        max: Number.POSITIVE_INFINITY,\n        min: Number.NEGATIVE_INFINITY,\n        scale: 1,\n        array: Float64Array,\n    },\n});\n\nexport function getNumberTypeByName(objectOrString) {\n    if (typeof objectOrString === \"string\") {\n        for (const type of Object.values(NumberType)) {\n            if (type.name === objectOrString) {\n                return type;\n            }\n        }\n    } else {\n        return objectOrString;\n    }\n}\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Track.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Track.vue?vue&type=style&index=0&lang=css&\"","module.exports = __webpack_public_path__ + \"img/5.8f775571.png\";","module.exports = __webpack_public_path__ + \"js/4.0d97b266.worker.js\"","module.exports = __webpack_public_path__ + \"js/2.d2bcdde0.worker.js\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Landing.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Landing.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreSegmentedGraph.vue?vue&type=style&index=0&id=2f52d4ed&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimbreSegmentedGraph.vue?vue&type=style&index=0&id=2f52d4ed&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"js/8.3d954328.worker.js\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graphs.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graphs.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=style&index=0&lang=css&\"","module.exports = __webpack_public_path__ + \"js/10.49c08f12.worker.js\"","module.exports = __webpack_public_path__ + \"img/9.4839c5e9.png\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Seeker.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Seeker.vue?vue&type=style&index=0&lang=css&\"","module.exports = __webpack_public_path__ + \"js/1.7598de05.worker.js\"","module.exports = __webpack_public_path__ + \"js/5.14bb81d6.worker.js\"","module.exports = __webpack_public_path__ + \"js/0.921b0196.worker.js\"","module.exports = __webpack_public_path__ + \"js/3.d0f868c2.worker.js\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=style&index=0&id=6f3d8e16&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Player.vue?vue&type=style&index=0&id=6f3d8e16&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"img/4.1282f7d7.png\";","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Structure.vue?vue&type=style&index=0&id=74fb22c3&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Structure.vue?vue&type=style&index=0&id=74fb22c3&scoped=true&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tonality.vue?vue&type=style&index=0&id=2a1362ce&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tonality.vue?vue&type=style&index=0&id=2a1362ce&scoped=true&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GroundTruth.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GroundTruth.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}